(globalThis.webpackChunksuperset=globalThis.webpackChunksuperset||[]).push([[1459],{31746:(e,t,n)=>{var a={"./langAR":[95380,5380],"./langAR.js":[95380,5380],"./langCS":[64053,4053],"./langCS.js":[64053,4053],"./langDE":[87020,7020],"./langDE.js":[87020,7020],"./langEN":[45764],"./langEN.js":[45764],"./langES":[61591,1591],"./langES.js":[61591,1591],"./langFA":[78510,8510],"./langFA.js":[78510,8510],"./langFI":[9702,9702],"./langFI.js":[9702,9702],"./langFR":[51515,1515],"./langFR.js":[51515,1515],"./langHU":[45888,5888],"./langHU.js":[45888,5888],"./langIT":[48378,8378],"./langIT.js":[48378,8378],"./langJA":[1626,1626],"./langJA.js":[1626,1626],"./langKO":[95401,5401],"./langKO.js":[95401,5401],"./langNL":[13985,3985],"./langNL.js":[13985,3985],"./langPL":[39271,9271],"./langPL.js":[39271,9271],"./langPT-br":[43620,3620],"./langPT-br.js":[43620,3620],"./langRO":[28079,460],"./langRO.js":[28079,460],"./langRU":[69118,6737],"./langRU.js":[69118,6737],"./langSI":[72603,2603],"./langSI.js":[72603,2603],"./langSV":[46746,6746],"./langSV.js":[46746,6746],"./langTH":[90703,703],"./langTH.js":[90703,703],"./langTR":[26841,6841],"./langTR.js":[26841,6841],"./langUK":[82335,2335],"./langUK.js":[82335,2335],"./langVI":[10102,102],"./langVI.js":[10102,102],"./langZH":[23073],"./langZH.js":[23073]};function l(e){if(!n.o(a,e))return Promise.resolve().then((()=>{var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}));var t=a[e],l=t[0];return Promise.all(t.slice(1).map(n.e)).then((()=>n(l)))}l.keys=()=>Object.keys(a),l.id=31746,e.exports=l},61459:(e,t,n)=>{"use strict";n.r(t),n.d(t,{default:()=>b});var a=n(96540),l=n(62952),r=n(58863),s=n(96627),o=n(7349),u=n(32142),c=n(86444),i=n(85867),g=n(71194),d=n(96453),h=n(9203),f=n(51536),p=n(2445);const{RadioButtonControl:m}=h.A,v=d.I4.div`
  text-align: center;
`;function C({formData:e,setControlValue:t}){const{extraControlsOptions:n,extraControlsHandler:l,extraValue:r}=function({formData:e,setControlValue:t}){const{stack:n,area:l}=e,[r,s]=(0,a.useState)(null!=n?n:void 0);return(0,a.useEffect)((()=>{s(n)}),[n]),{extraControlsOptions:(0,a.useMemo)((()=>l?f.RC:[]),[l]),extraControlsHandler:(0,a.useCallback)((e=>{l&&t&&(t("stack",e),s(e))}),[l,t]),extraValue:r}}({formData:e,setControlValue:t});return e.showExtraControls?(0,p.Y)(v,{children:(0,p.Y)(m,{options:n,onChange:l,value:r})}):null}const j=300;function b({formData:e,height:t,width:n,echartOptions:d,groupby:h,labelMap:f,selectedValues:m,setDataMask:v,setControlValue:b,legendData:E=[],onContextMenu:y,onLegendStateChanged:w,onFocusedSeries:R,xValueFormatter:V,xAxis:k,refs:x,emitCrossFilters:F,coltypeMapping:T}){const{stack:I}=e,O=(0,a.useRef)(null);x.echartRef=O;const S=(0,a.useRef)(),A=(0,a.useRef)(null),[D,H]=(0,a.useState)(0);(0,a.useEffect)((()=>{var e;const t=(null==(e=A.current)?void 0:e.offsetHeight)||0;H(t)}),[e.showExtraControls]);const N=(0,l.A)(h).length>0,L=(0,a.useCallback)((e=>{const t=Object.values(m);let n;n=t.includes(e)?t.filter((t=>t!==e)):[e];const a=n.map((e=>f[e]));return{dataMask:{extraFormData:{filters:0===n.length?[]:h.map(((e,t)=>{const n=a.map((e=>e[t]));return null==n?{col:e,op:"IS NULL"}:{col:e,op:"IN",val:n}}))},filterState:{label:a.length?a:void 0,value:a.length?a:null,selectedValues:n.length?n:null}},isCurrentValueSelected:t.includes(e)}}),[h,f,m]),M=(0,a.useCallback)((e=>{F&&v(L(e).dataMask)}),[F,v,L]),U={click:e=>{N&&(S.current&&clearTimeout(S.current),S.current=setTimeout((()=>{const{seriesName:t}=e;M(t)}),j))},mouseout:()=>{R(null)},mouseover:e=>{R(e.seriesName)},legendselectchanged:e=>{null==w||w(e.selected)},legendselectall:e=>{null==w||w(e.selected)},legendinverseselect:e=>{null==w||w(e.selected)},contextmenu:async t=>{if(y){var n;t.event.stop();const{data:a,seriesName:i}=t,d=[],h=[],p=t.event.event,m=[...t.name?[t.name]:[],...null!=(n=f[i])?n:[]],v=(0,l.A)(e.groupby);a&&k.type===r.Gw.Time&&d.push({col:k.label===s.Tf?e.granularitySqla:k.label,grain:e.timeGrainSqla,op:"==",val:a[0],formattedVal:V(a[0])}),[...k.type===r.Gw.Category&&a?[k.label]:[],...v].forEach(((e,t)=>d.push({col:e,op:"==",val:m[t],formattedVal:String(m[t])}))),v.forEach(((t,n)=>{const a=f[i][n];h.push({col:t,op:"==",val:a,formattedVal:(0,g.Wy)(m[n],{timeFormatter:(0,o.mo)(e.dateFormat),numberFormatter:(0,u.gV)(e.numberFormat),coltype:null==T?void 0:T[(0,c.A)(t)]})})})),y(p.clientX,p.clientY,{drillToDetail:d,drillBy:{filters:h,groupbyFieldName:"groupby"},crossFilter:N?L(i):void 0})}}},Y={dblclick:e=>{var t;S.current&&clearTimeout(S.current);const n=[e.offsetX,e.offsetY],a=null==(t=O.current)?void 0:t.getEchartInstance();if(null!=a&&a.containPixel("grid",n)){var l;if(!I&&"ec-polygon"===(null==(l=e.target)?void 0:l.type))return;const t=a.getModel(),n=((e,t)=>{let n=e,a=null;for(;n;){const e=n.__ecComponentInfo;if(null!=e){a=t.getComponent(e.mainType,e.index);break}n=n.parent}return a})(e.target,t);if(n){const{name:e}=n,t=E.reduce(((t,n)=>({...t,[n]:n===e})),{});null==w||w(t)}}}};return(0,p.FD)(p.FK,{children:[(0,p.Y)("div",{ref:A,children:(0,p.Y)(C,{formData:e,setControlValue:b})}),(0,p.Y)(i.A,{ref:O,refs:x,height:t-D,width:n,echartOptions:d,eventHandlers:U,zrEventHandlers:Y,selectedValues:m})]})}},85867:(e,t,n)=>{"use strict";n.d(t,{A:()=>U});var a=n(96540),l=n(61225),r=n(96453),s=n(3087),o=n(53080),u=n(92351),c=n(42900),i=n(51719),g=n(74508),d=n(61030),h=n(45567),f=n(49714),p=n(11734),m=n(80491),v=n(25652),C=n(73900),j=n(32003),b=n(22329),E=n(31441),y=n(12458),w=n(39539),R=n(5553),V=n(45967),k=n(40830),x=n(45620),F=n(39838),T=n(42998),I=n(69380),O=n(25384),S=n(6641),A=n(28540),D=n(35278),H=n(51536),N=n(2445);const L=r.I4.div`
  height: ${({height:e})=>e};
  width: ${({width:e})=>e};
`;function M({width:e,height:t,echartOptions:r,eventHandlers:s,zrEventHandlers:c,selectedValues:i={},refs:g},d){const h=(0,a.useRef)(null);g&&(g.divRef=h);const f=(0,a.useRef)(),p=(0,a.useMemo)((()=>Object.keys(i)||[]),[i]),m=(0,a.useRef)([]);(0,a.useImperativeHandle)(d,(()=>({getEchartInstance:()=>f.current})));const v=(0,l.d4)((e=>{var t,n;return null!=(t=null==e||null==(n=e.common)?void 0:n.locale)?t:H.Xn})).toUpperCase(),C=(0,a.useCallback)((({width:e,height:t})=>{f.current&&f.current.resize({width:e,height:t})}),[]);return(0,a.useEffect)((()=>{(async()=>{if(!h.current)return;const a=await n(31746)(`./lang${v}`).catch((e=>{console.error(`Locale ${v} not supported in ECharts`,e)}));null!=a&&a.default&&(0,o.E)(v,a.default),f.current||(f.current=(0,u.Ts)(h.current,null,{locale:v})),Object.entries(s||{}).forEach((([e,t])=>{var n,a;null==(n=f.current)||n.off(e),null==(a=f.current)||a.on(e,t)})),Object.entries(c||{}).forEach((([e,t])=>{var n,a;null==(n=f.current)||n.getZr().off(e),null==(a=f.current)||a.getZr().on(e,t)})),f.current.setOption(r,!0),C({width:e,height:t})})()}),[r,s,c,v]),(0,a.useEffect)((()=>{f.current&&(f.current.dispatchAction({type:"downplay",dataIndex:m.current.filter((e=>!p.includes(e)))}),p.length&&f.current.dispatchAction({type:"highlight",dataIndex:p}),m.current=p)}),[p,f.current]),(0,a.useLayoutEffect)((()=>{C({width:e,height:t})}),[e,t,C]),(0,N.Y)(L,{ref:h,height:t,width:e})}(0,s.Y)([w.a,c.a,i.a,g.a,d.a,h.a,f.a,p.a,m.a,v.a,C.a,j.a,b.a,E.a,y.a,R.a,V.a,k.a,x.a,F.a,T.a,I.a,O.a,S.a,A.a,D._]);const U=(0,a.forwardRef)(M)}}]);