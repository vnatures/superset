(globalThis.webpackChunksuperset=globalThis.webpackChunksuperset||[]).push([[6191],{355:(e,t,r)=>{"use strict";r.d(t,{fv:()=>g});var a=r(35742),n=r(51436),o=r(62952),s=r(5362),i=r(93505),l=r(27366),c=r(38708);const d="polling",u="last_async_event_id";let m,p,h,_,f,y,E;const g=async e=>new Promise(((t,r)=>{const i=e.job_id;var l;l=async e=>{switch(e.status){case"done":{let{data:s,status:i}=await(async e=>{let t,r="success";try{const{json:r}=await a.A.get({endpoint:String(e.result_url)});t="result"in r?r.result:r}catch(e){r="error",t=await(0,n.h4)(e)}return{status:r,data:t}})(e);s=(0,o.A)(s),"success"===i?t(s):r(s);break}case"error":{const t=(0,n.io)(e);r(t);break}default:s.A.warn("received event with status",e.status)}var l;f[l=i]&&delete f[l]},f[i]=l})),T=(0,i.A)({method:"GET",endpoint:"/api/v1/async_event/"}),A=async e=>{e.forEach((e=>{const t=e.job_id,r=f[t];r?(r(e),delete y[t]):(y[t]||(y[t]=0),y[t]+=1,y[t]<=6?setTimeout((()=>{A([e])}),100*y[t]):(delete y[t],s.A.warn("listener not found for job_id",e.job_id))),(e=>{E=e.id;try{localStorage.setItem(u,E)}catch(e){s.A.warn("Error saving event Id to localStorage",e)}})(e)}))},b=async()=>{const e=E?{last_id:E}:{};if(Object.keys(f).length)try{const{result:t}=await T(e);null!=t&&t.length&&await A(t)}catch(e){s.A.warn(e)}p===d&&(_=window.setTimeout(b,h))};let S,v,R=0;const I=()=>{let e=m.GLOBAL_ASYNC_QUERIES_WEBSOCKET_URL;E&&(e+=`?last_id=${E}`),v=new WebSocket(e),v.addEventListener("open",(()=>{s.A.log("WebSocket connected"),clearTimeout(S),R=0})),v.addEventListener("close",(()=>{S=setTimeout((()=>{R+=1,R<=6?I():(s.A.warn("WebSocket not available, falling back to async polling"),b())}),2500)})),v.addEventListener("error",(()=>{v.readyState<2&&v.close()})),v.addEventListener("message",(async e=>{let t=[];try{t=[JSON.parse(e.data)],await A(t)}catch(e){s.A.warn(e)}}))};(()=>{if((0,l.G7)(l.TO.GlobalAsyncQueries)){_&&clearTimeout(_),f={},y={},E=null,m=(0,c.A)().common.conf,p=m.GLOBAL_ASYNC_QUERIES_TRANSPORT||d,h=m.GLOBAL_ASYNC_QUERIES_POLLING_DELAY||500;try{E=localStorage.getItem(u)}catch(e){s.A.warn("Failed to fetch last event Id from localStorage")}p===d&&b(),"ws"===p&&I()}})()},578:(e,t,r)=>{"use strict";r.d(t,{A:()=>n});const a={};function n(e){let t=null;if(e){const{childId:n,layout:o={}}=e,s=a[n];if(s){var r;const e=(null==o?void 0:o[s])||{};if(null!=e&&e.children&&null!=e&&null!=(r=e.children)&&null!=r.includes&&r.includes(n))return e.id}t=function(e){let t=null;if(e){const{childId:a,layout:n={}}=e;if(n){const e=Object.keys(n);for(let o=0;o<=e.length-1;o+=1){var r;const s=e[o],i=n[s]||{};if(s!==a&&null!=i&&null!=(r=i.children)&&null!=r.includes&&r.includes(a)){t=s;break}}}}return t}({childId:n,layout:o}),a[n]=t}return t}},808:(e,t,r)=>{"use strict";r.d(t,{M6:()=>l,TI:()=>s,bo:()=>i,md:()=>n,wF:()=>o});var a=r(57246);function n(e){return"SIMPLE"===e.expressionType}function o(e){return"SQL"===e.expressionType}function s(e){return(0,a.Gq)(e.operator)}function i(e){return(0,a.UH)(e.operator)}function l(e){return(0,a.jy)(e.operator)}},1889:(e,t,r)=>{"use strict";r.d(t,{A:()=>l});var a=r(26632),n=r(83942),o=r(96590),s=r(38677);const i=e=>[e];function l(e,t){const{queryFields:r,buildQuery:l=i}="function"==typeof t?{buildQuery:t,queryFields:{}}:t||{};let c=l((0,a.A)(e,r));return c.forEach((e=>{Array.isArray(e.post_processing)&&(e.post_processing=e.post_processing.filter(Boolean))})),(0,s.aj)(e)&&(c=c.map((t=>(0,o.j)(e,t)))),{datasource:new n.A(e.datasource).toObject(),force:e.force||!1,queries:c,form_data:e,result_format:e.result_format||"json",result_type:e.result_type||"full"}}},2514:(e,t,r)=>{"use strict";r.r(t),r.d(t,{ADD_CHART:()=>J,ANNOTATION_QUERY_FAILED:()=>P,ANNOTATION_QUERY_STARTED:()=>x,ANNOTATION_QUERY_SUCCESS:()=>N,CHART_RENDERING_FAILED:()=>I,CHART_RENDERING_SUCCEEDED:()=>C,CHART_UPDATE_FAILED:()=>v,CHART_UPDATE_STARTED:()=>E,CHART_UPDATE_STOPPED:()=>b,CHART_UPDATE_SUCCEEDED:()=>T,DYNAMIC_PLUGIN_CONTROLS_READY:()=>F,POST_CHART_FORM_DATA:()=>re,REMOVE_CHART:()=>w,RENDER_TRIGGERED:()=>G,TRIGGER_QUERY:()=>j,UPDATE_CHART_ID:()=>K,UPDATE_QUERY_FORM_DATA:()=>z,addChart:()=>Z,annotationQueryFailed:()=>M,annotationQueryStarted:()=>U,annotationQuerySuccess:()=>q,chartRenderingFailed:()=>O,chartRenderingSucceeded:()=>D,chartUpdateFailed:()=>R,chartUpdateStarted:()=>g,chartUpdateStopped:()=>S,chartUpdateSucceeded:()=>A,dynamicPluginControlsReady:()=>k,exploreJSON:()=>te,getChartDataRequest:()=>B,getDatasourceSamples:()=>se,handleChartDataResponse:()=>ee,postChartFormData:()=>ae,redirectSQLLab:()=>ne,refreshChart:()=>oe,removeChart:()=>L,renderTriggered:()=>V,runAnnotationQuery:()=>H,triggerQuery:()=>$,updateChartId:()=>X,updateQueryFormData:()=>W});var a=r(35742),n=r(51436),o=r(27366),s=r(95579),i=r(13270),l=r(91715),c=r(85183),d=r(95272),u=r(7735),m=r(35700),p=r(93376),h=r(95004),_=r(355),f=r(12066),y=r(7089);const E="CHART_UPDATE_STARTED";function g(e,t,r){return{type:E,queryController:e,latestQueryFormData:t,key:r}}const T="CHART_UPDATE_SUCCEEDED";function A(e,t){return{type:T,queriesResponse:e,key:t}}const b="CHART_UPDATE_STOPPED";function S(e){return{type:b,key:e}}const v="CHART_UPDATE_FAILED";function R(e,t){return{type:v,queriesResponse:e,key:t}}const I="CHART_RENDERING_FAILED";function O(e,t,r){return{type:I,error:e,key:t,stackTrace:r}}const C="CHART_RENDERING_SUCCEEDED";function D(e){return{type:C,key:e}}const w="REMOVE_CHART";function L(e){return{type:w,key:e}}const N="ANNOTATION_QUERY_SUCCESS";function q(e,t,r){return{type:N,annotation:e,queryResponse:t,key:r}}const x="ANNOTATION_QUERY_STARTED";function U(e,t,r){return{type:x,annotation:e,queryController:t,key:r}}const P="ANNOTATION_QUERY_FAILED";function M(e,t,r){return{type:P,annotation:e,queryResponse:t,key:r}}const F="DYNAMIC_PLUGIN_CONTROLS_READY",k=()=>(e,t)=>{const r=t(),a=(0,l.Eu)(r.explore,r.explore.form_data);e({type:F,key:a.slice_id.value,controlsState:a})},Y=async(e,t,r,n,o="POST",s={},i)=>{const l=(0,c.TL)({resultFormat:t,resultType:r}),d=p.m&&(null==s?void 0:s.dashboard_id),u=(0,c.Xe)({formData:e,endpointType:l,force:n,allowDomainSharding:d,method:o,requestParams:s.dashboard_id?{dashboard_id:s.dashboard_id}:{}}),m={...s,url:u,postPayload:{form_data:e},parseMethod:i};return a.A.post(m).then((({json:e,response:t})=>({response:t,json:{result:[e]}})))},Q=async(e,t,r,n,o,s,i,l)=>{const d=(0,c.sx)({formData:e,resultType:r,resultFormat:t,force:n,setDataMask:s,ownState:i}),{slice_id:u}=e,{dashboard_id:m}=o,h={};void 0!==u&&(h.form_data=`{"slice_id":${u}}`),void 0!==m&&(h.dashboard_id=m),n&&(h.force=n);const _=p.m&&(null==o?void 0:o.dashboard_id),f=(0,c.Hh)({path:"/api/v1/chart/data",qs:h,allowDomainSharding:_}).toString(),y={...o,url:f,headers:{"Content-Type":"application/json"},body:JSON.stringify(d),parseMethod:l};return a.A.post(y)};async function B({formData:e,setDataMask:t=()=>{},resultFormat:r="json",resultType:a="full",force:n=!1,method:o="POST",requestParams:s={},ownState:i={}}){let l={...s};p.m&&(l={...l,mode:"cors",credentials:"include"});const[d,u]=(0,c.Mp)(e);return d?Y(e,r,a,n,o,l,u):Q(e,r,a,n,l,t,i,u)}function H({annotation:e,timeout:t,formData:r,key:o,isDashboardRequest:s=!1,force:i=!1}){return function(l,d){var u;const{charts:m,common:p}=d(),h=o||Object.keys(m)[0],_=t||p.conf.SUPERSET_WEBSERVER_TIMEOUT,f={...r||m[h].latestQueryFormData};if(!e.sourceType)return Promise.resolve();f.time_grain_sqla=f.time_grain_sqla||f.granularity,f.granularity=f.granularity_sqla;const y=Object.keys(e.overrides);(y.includes("since")||y.includes("until"))&&(e.overrides={...e.overrides,time_range:null});const E=Object.keys(e.overrides).reduce(((t,r)=>({...t,[r]:e.overrides[r]||f[r]})),{});if(!s&&f){const e=f.extra_filters&&f.extra_filters.length>0;E.extra_filters=e?f.extra_filters:void 0}const g=(0,c.Ze)(e.value,i),T=new AbortController,{signal:A}=T;l(U(e,T,h));const b=null==f||null==(u=f.annotation_layers)?void 0:u.findIndex((t=>t.name===e.name));return b>=0&&(f.annotation_layers[b].overrides=E),a.A.post({url:g,signal:A,timeout:1e3*_,headers:{"Content-Type":"application/json"},jsonPayload:(0,c.sx)({formData:f,force:i,resultFormat:"json",resultType:"full"})}).then((({json:t})=>{var r,a,n;const o=null==t||null==(r=t.result)||null==(a=r[0])||null==(n=a.annotation_data)?void 0:n[e.name];return l(q(e,{data:o},h))})).catch((t=>(0,n.h4)(t).then((t=>{"timeout"===t.statusText?l(M(e,{error:"Query timeout"},h)):(t.error||"").toLowerCase().includes("no data")?l(q(e,t,h)):"abort"!==t.statusText&&l(M(e,t,h))}))))}}const j="TRIGGER_QUERY";function $(e=!0,t){return{type:j,value:e,key:t}}const G="RENDER_TRIGGERED";function V(e,t){return{type:G,value:e,key:t}}const z="UPDATE_QUERY_FORM_DATA";function W(e,t){return{type:z,value:e,key:t}}const K="UPDATE_CHART_ID";function X(e,t=0){return{type:K,newId:e,key:t}}const J="ADD_CHART";function Z(e,t){return{type:J,chart:e,key:t}}function ee(e,t,r){if((0,o.G7)(o.TO.GlobalAsyncQueries)){const a="result"in t?t.result:t;switch(e.status){case 200:return Promise.resolve(a);case 202:return r?(0,_.fv)(a[0]):(0,_.fv)(a);default:throw new Error(`Received unexpected response status (${e.status}) while fetching chart data`)}}return t.result}function te(e,t=!1,r,a,s,i){return async(l,d)=>{const p=m.Vy.getTimestamp(),_=new AbortController,f=r||d().common.conf.SUPERSET_WEBSERVER_TIMEOUT,E={signal:_.signal,timeout:1e3*f};s&&(E.dashboard_id=s);const T=B({setDataMask:t=>{l((0,h.Mv)(e.slice_id,t))},formData:e,resultFormat:"json",resultType:"full",force:t,method:"POST",requestParams:E,ownState:i});l(g(_,e,a));const[b]=(0,c.Mp)(e),v=T.then((({response:e,json:t})=>ee(e,t,b))).then((r=>(r.forEach((r=>l((0,u.logEvent)(m.tO,{slice_id:a,applied_filters:r.applied_filters,is_cached:r.is_cached,force_refresh:t,row_count:r.rowcount,datasource:e.datasource,start_offset:p,ts:(new Date).getTime(),duration:m.Vy.getTimestamp()-p,has_extra_filters:e.extra_filters&&e.extra_filters.length>0,viz_type:e.viz_type,data_age:r.is_cached?(0,y.XV)(new Date).diff(y.XV.utc(r.cached_dttm)):null})))),l(A(r,a))))).catch((t=>{if((0,o.G7)(o.TO.GlobalAsyncQueries))return l(R([t],a));const r=(t,r)=>{l((0,u.logEvent)(m.tO,{slice_id:a,has_err:!0,is_cached:r,error_details:t,datasource:e.datasource,start_offset:p,ts:(new Date).getTime(),duration:m.Vy.getTimestamp()-p}))};return"AbortError"===t.name?(r("abort"),l(S(a))):(0,n.h4)(t).then((e=>("timeout"===t.statusText?r("timeout"):r(e.error,e.is_cached),l(R([e],a)))))})),I=b&&e.annotation_layers||[],O=s>0;return Promise.all([v,l($(!1,a)),l(W(e,a)),...I.map((n=>l(H({annotation:n,timeout:r,formData:e,key:a,isDashboardRequest:O,force:t}))))])}}const re="POST_CHART_FORM_DATA";function ae(e,t=!1,r,a,n,o){return te(e,t,r,a,n,o)}function ne(e,t){return r=>{B({formData:e,resultFormat:"json",resultType:"query"}).then((({json:r})=>{const n="/sqllab/",o={datasourceKey:e.datasource,sql:r.result[0].query};t?t.push({pathname:n,state:{requestedQuery:o}}):a.A.postForm(n,{form_data:(0,f.J)(o)})})).catch((()=>r((0,d.iB)((0,s.t)("An error occurred while loading the SQL")))))}}function oe(e,t,r){return(a,n)=>{var o;const s=(n().charts||{})[e],i=n().dashboardInfo.common.conf.SUPERSET_WEBSERVER_TIMEOUT;s.latestQueryFormData&&0!==Object.keys(s.latestQueryFormData).length&&a(ae(s.latestQueryFormData,t,i,s.id,r,null==(o=n().dataMask[s.id])?void 0:o.ownState))}}const se=async(e,t,r,o,l,c)=>{try{const n={force:r,datasource_type:e,datasource_id:t};return(0,i.A)(l)&&(0,i.A)(c)&&(n.per_page=l,n.page=c),(await a.A.post({endpoint:"/datasource/samples",jsonPayload:o,searchParams:n,parseMethod:"json-bigint"})).json.result}catch(e){const t=await(0,n.h4)(e);throw new Error(t.message||t.error||(0,s.t)("Sorry, an error occurred"),{cause:e})}}},3247:(e,t,r)=>{"use strict";r.d(t,{IX:()=>l,Ip:()=>u});var a=r(96540),n=r(86963);const o=r(43031).F.injectEndpoints({endpoints:e=>({schemas:e.query({providesTags:[{type:"Schemas",id:"LIST"}],query:({dbId:e,catalog:t,forceRefresh:r})=>({endpoint:`/api/v1/database/${e}/schemas/`,urlParams:{force:r,...void 0!==t&&{catalog:t}},transformResponse:({json:e})=>e.result.sort().map((e=>({value:e,label:e,title:e})))}),serializeQueryArgs:({queryArgs:{dbId:e,catalog:t}})=>({dbId:e,catalog:t})})})}),{useLazySchemasQuery:s,useSchemasQuery:i,endpoints:l,util:c}=o,d=[];function u(e){const{dbId:t,catalog:r,onSuccess:o,onError:l}=e||{},[c]=s(),u=i({dbId:t,catalog:r||void 0,forceRefresh:!1},{skip:!t});(0,a.useEffect)((()=>{u.isError&&(null==l||l(u.error))}),[u.isError,u.error,l]);const m=(0,n.A)(((e,t,r=!1)=>{!e||u.currentData&&!r||c({dbId:e,catalog:t,forceRefresh:r}).then((({isSuccess:e,isError:t,data:a})=>{e&&(null==o||o(a||d,r)),t&&(null==l||l(u.error))}))}));(0,a.useEffect)((()=>{m(t,r,!1)}),[t,r,m]);const p=(0,a.useCallback)((()=>{m(t,r,!0)}),[t,r,m]);return{...u,refetch:p}}},5261:(e,t,r)=>{"use strict";r.d(t,{Ay:()=>l,Yf:()=>c});var a=r(96540),n=r(82960),o=r(61225),s=r(95272);const i={addInfoToast:s.Zt,addSuccessToast:s.WR,addWarningToast:s.Zd,addDangerToast:s.iB};function l(e){return(0,o.Ng)(null,(e=>(0,n.zH)(i,e)))(e)}function c(){const e=(0,o.wA)();return(0,a.useMemo)((()=>(0,n.zH)(i,e)),[e])}},5795:(e,t,r)=>{"use strict";var a;r.d(t,{Ay:()=>o,Cq:()=>n,cT:()=>a}),function(e){e.Table="table",e.Query="query",e.Dataset="dataset",e.SlTable="sl_table",e.SavedQuery="saved_query"}(a||(a={}));const n=[{metric_name:"COUNT(*)",expression:"COUNT(*)"}],o={}},7089:(e,t,r)=>{"use strict";r.d(t,{RW:()=>b,XV:()=>A,_q:()=>v,tB:()=>S});var a=r(74353),n=r.n(a),o=r(83826),s=r.n(o),i=r(88569),l=r.n(i),c=r(98720),d=r.n(c),u=r(6279),m=r.n(u),p=r(90445),h=r.n(p),_=r(43522),f=r.n(_),y=r(53581),E=r.n(y),g=r(8906),T=r.n(g);n().extend(s()),n().extend(l()),n().extend(d()),n().extend(m()),n().extend(h()),n().extend(f()),n().extend(E()),n().extend(T()),n().updateLocale("en",{invalidDate:"Invalid date"});const A=n(),b=function(e,t,r="HH:mm:ss.SSS"){const a=t-e;return n()(new Date(a)).utc().format(r)},S=function(){return n()().utc().valueOf()},v=function(e,t){const r=n().tz("2021-01-01",t).utcOffset();return e.tz(t).utcOffset()!==r}},7148:(e,t,r)=>{"use strict";r.d(t,{Ay:()=>s,fH:()=>o,iw:()=>a});var a,n=r(70360);!function(e){e[e.Dashboard=0]="Dashboard",e[e.Explore=1]="Explore"}(a||(a={}));class o{constructor(){this.chartsLabelsMap=void 0,this.colorMap=void 0,this.source=void 0,this.chartsLabelsMap=new Map,this.colorMap=new Map,this.source=a.Dashboard}updateColorMap(e,t,r=!1){const a=this.colorMap;r||a.clear(),this.chartsLabelsMap.forEach(((n,o)=>{const{labels:s,ownScheme:i}=n,l=t||i,c=e.getScale(l);s.forEach((e=>{if(!r||!this.colorMap.has(e)){const t=c.getColor(e,o,l);a.set(e,t)}}))})),this.colorMap=a}getColorMap(){return this.colorMap}addSlice(e,t,r,n){const o=this.chartsLabelsMap.get(r)||{labels:[],scheme:void 0,ownScheme:void 0},{labels:s}=o;s.includes(e)||(s.push(e),this.chartsLabelsMap.set(r,{labels:s,scheme:n,ownScheme:o.ownScheme})),this.source===a.Dashboard&&this.colorMap.set(e,t)}setOwnColorScheme(e,t){const r=this.chartsLabelsMap.get(e);r&&this.chartsLabelsMap.set(e,{...r,ownScheme:t})}removeSlice(e){if(this.source!==a.Dashboard)return;this.chartsLabelsMap.delete(e);const t=new Map;this.chartsLabelsMap.forEach((e=>{const{labels:r}=e;r.forEach((e=>{t.set(e,this.colorMap.get(e))}))})),this.colorMap=t}clear(){this.colorMap.clear()}reset(){this.clear(),this.chartsLabelsMap.clear()}}const s=(0,n.A)(o)},7735:(e,t,r)=>{"use strict";r.r(t),r.d(t,{LOG_EVENT:()=>a,logEvent:()=>n});const a="LOG_EVENT";function n(e,t){return r=>r({type:a,payload:{eventName:e,eventData:t}})}},7858:(e,t,r)=>{"use strict";r.d(t,{$:()=>s,s:()=>i});var a=r(96540),n=r(9203),o=r(54797);function s(e){return"string"==typeof e&&e in n.A?n.A[e]:e}function i(e,t={}){if("string"==typeof e&&e in o.A){const r=e;return{name:r,config:{...o.A[r],...t[r]}}}if(!e||"string"==typeof e||(0,a.isValidElement)(e))return e;if("name"in e&&"config"in e)return{...e,config:{...e.config,type:s(e.config.type)}};if("override"in e&&e.name in o.A){const{name:t,override:r}=e;return{name:t,config:{...o.A[t],...r}}}return null}},9203:(e,t,r)=>{"use strict";r.d(t,{A:()=>i});var a=r(17437),n=r(96453),o=r(47472),s=r(2445);const i={RadioButtonControl:function({value:e,options:t,onChange:r,...i}){const l=e||t[0][0],c=(0,n.DP)();return(0,s.FD)("div",{css:(0,a.AH)({".btn svg":{position:"relative",top:"0.2em"},".btn:focus":{outline:"none"},".control-label":{color:c.colors.grayscale.base,marginBottom:c.gridUnit},".control-label + .btn-group":{marginTop:"1px"},".btn-group .btn-default":{color:c.colors.grayscale.dark1},".btn-group .btn.active":{background:c.colors.grayscale.light4,fontWeight:c.typography.weights.bold,boxShadow:"none"}},"",""),children:[(0,s.Y)(o.V,{...i}),(0,s.Y)("div",{className:"btn-group btn-group-sm",children:t.map((([e,t])=>(0,s.Y)("button",{type:"button",className:"btn btn-default "+(e===l?"active":""),onClick:()=>{r(e)},children:t},JSON.stringify(e))))})]})}}},10504:(e,t,r)=>{"use strict";var a;r.d(t,{IG:()=>s,QI:()=>a,TY:()=>n,YD:()=>o}),function(e){e.Vertical="VERTICAL",e.Horizontal="HORIZONTAL"}(a||(a={}));const n="global",o=e=>e===n;var s;!function(e){e.DownloadAsImage="download_as_image",e.ExploreChart="explore_chart",e.ExportCsv="export_csv",e.ExportPivotCsv="export_pivot_csv",e.ExportFullCsv="export_full_csv",e.ExportXlsx="export_xlsx",e.ExportFullXlsx="export_full_xlsx",e.ForceRefresh="force_refresh",e.Fullscreen="fullscreen",e.ToggleChartDescription="toggle_chart_description",e.ViewQuery="view_query",e.ViewResults="view_results",e.DrillToDetail="drill_to_detail",e.CrossFilterScoping="cross_filter_scoping",e.Share="share",e.ShareByEmail="share_by_email",e.CopyLink="copy_link",e.Download="download",e.SaveModal="save_modal",e.RefreshDashboard="refresh_dashboard",e.AutorefreshModal="autorefresh_modal",e.SetFilterMapping="set_filter_mapping",e.EditProperties="edit_properties",e.EditCss="edit_css",e.ToggleFullscreen="toggle_fullscreen",e.ManageEmbedded="manage_embedded",e.ManageEmailReports="manage_email_reports"}(s||(s={}))},10526:(e,t,r)=>{"use strict";r.d(t,{A:()=>d});var a=r(60740),n=r(4923),o=r(72239),s=r(7148),i=r(39472),l=r(27366);class c extends n.A{constructor(e,t={},r){super(((e,t)=>this.getColor(e,t,r))),this.originColors=void 0,this.colors=void 0,this.scale=void 0,this.forcedColors=void 0,this.labelsColorMapInstance=void 0,this.chartLabelsColorMap=void 0,this.multiple=void 0,this.originColors=e,this.colors=e,this.chartLabelsColorMap=new Map,this.labelsColorMapInstance=(0,s.Ay)(),this.multiple=0,this.scale=(0,a.A)(),this.scale.range(e),Object.entries(t).forEach((([r,a])=>{"number"==typeof a&&(t[r]=e[a%e.length])})),this.forcedColors=t}incrementColorRange(){const e=Math.floor(this.domain().length/this.originColors.length);if(e>this.multiple){this.multiple=e;const t=(0,i.yG)(this.originColors,e),r=this.originColors.concat(t);this.range(r),this.colors=r}}getColor(e,t,r){var a;const n=(0,o.A)(e),i=null==(a=this.forcedColors)?void 0:a[n],{source:c}=this.labelsColorMapInstance,d=c===s.iw.Dashboard?this.labelsColorMapInstance.getColorMap():this.chartLabelsColorMap,u=d.has(n);let m=i||(u?d.get(n):this.scale(n));return i||u||((0,l.G7)(l.TO.UseAnalogousColors)&&this.incrementColorRange(),(0,l.G7)(l.TO.AvoidColorsCollision)&&this.isColorUsed(m)&&(m=this.getNextAvailableColor(n,m))),this.chartLabelsColorMap.set(n,m),t&&this.labelsColorMapInstance.addSlice(n,m,t,r),m}isColorUsed(e){return this.getColorUsageCount(e)>0}getColorUsageCount(e){return Array.from(this.chartLabelsColorMap.values()).filter((t=>t===e)).length}getNextAvailableColor(e,t){const r=new Map(this.colors.map((e=>[e,this.getColorUsageCount(e)]))),a=Array.from(this.chartLabelsColorMap.keys()),n=a.indexOf(e),o=(()=>{const e=n>0?a[n-1]:null,t=n<a.length-1?a[n+1]:null;return[e?this.chartLabelsColorMap.get(e):null,t?this.chartLabelsColorMap.get(t):null].filter((e=>e))})(),s=e=>(r.get(e)||0)+(o.includes(e)?100:0),i=this.colors.find((e=>0===(r.get(e)||0)));return i||this.colors.filter((e=>e!==t)).reduce(((e,t)=>{const r=s(e);return s(t)<r?t:e}),t)}setColor(e,t){return this.forcedColors[(0,o.A)(e)]=t,this}getColorMap(){const e={};return this.scale.domain().forEach((t=>{e[t.toString()]=this.scale(t)})),{...e,...this.forcedColors}}copy(){const e=new c(this.scale.range(),this.forcedColors);return e.forcedColors={...this.forcedColors},e.domain(this.domain()),e.unknown(this.unknown()),e}domain(e){return void 0===e?this.scale.domain():(this.scale.domain(e),this)}range(e){return void 0===e?this.scale.range():(this.colors=e,this.scale.range(e),this)}unknown(e){return void 0===e?this.scale.unknown():(this.scale.unknown(e),this)}}const d=c},12066:(e,t,r)=>{"use strict";function a(e){const t=new Set;return JSON.stringify(e,((e,r)=>{if("object"==typeof r&&null!==r){if(t.has(r))try{return JSON.parse(JSON.stringify(r))}catch(e){return}t.add(r)}return r}))}r.d(t,{J:()=>a})},12817:(e,t,r)=>{"use strict";r.d(t,{_:()=>n});var a=r(49588);function n(e,t,r){return t.filter((t=>{var n,o;return!e.excluded.includes(t)&&(null==(n=r.find((e=>{var r;return(null==e?void 0:e.type)===a.oT&&(null==(r=e.meta)?void 0:r.chartId)===t})))||null==(o=n.parents)?void 0:o.some((t=>e.rootPath.includes(t))))}))}},13270:(e,t,r)=>{"use strict";function a(e){return null!=e}r.d(t,{A:()=>a})},13573:(e,t,r)=>{"use strict";r.d(t,{P:()=>_});var a=r(96453),n=r(17437),o=r(95579),s=r(87903),i=r(31566),l=r(40183),c=r(35668),d=r(29567),u=r(79404),m=r(14296),p=r(2445);const h=a.I4.div`
  ${({theme:e})=>n.AH`
    display: flex;
    justify-content: center;
    align-items: center;
    width: ${6*e.gridUnit}px;
    height: ${6*e.gridUnit}px;
    margin-right: ${e.gridUnit}px;

    && svg {
      margin-right: 0;
      margin-left: 0;
      width: 100%;
      height: 100%;
    }
  `};
`;function _({type:e}){let t=(0,p.Y)(i.A,{"aria-label":(0,o.t)("unknown type icon")});return""===e||"expression"===e?t=(0,p.Y)(l.A,{"aria-label":(0,o.t)("function type icon")}):e===s.s.String?t=(0,p.Y)(c.A,{"aria-label":(0,o.t)("string type icon")}):e===s.s.Numeric?t=(0,p.Y)(d.A,{"aria-label":(0,o.t)("numeric type icon")}):e===s.s.Boolean?t=(0,p.Y)(u.A,{"aria-label":(0,o.t)("boolean type icon")}):e===s.s.Temporal&&(t=(0,p.Y)(m.A,{"aria-label":(0,o.t)("temporal type icon")})),(0,p.Y)(h,{children:t})}},14304:(e,t,r)=>{"use strict";r.d(t,{c:()=>a});const a=e=>{var t,r,a,n,o,s,i;const l=null==e||null==(t=e.form_data)?void 0:t.dashboardId;return{chartId:null==e||null==(r=e.slice)?void 0:r.slice_id,dashboardId:l,hasDashboardColorScheme:!!l&&!(null==e||null==(a=e.form_data)||!a.dashboard_color_scheme),hasCustomLabelsColor:Object.keys((null==e||null==(n=e.form_data)?void 0:n.label_colors)||{}).length>0,colorNamespace:null==e||null==(o=e.form_data)?void 0:o.color_namespace,mapLabelsColors:(null==e||null==(s=e.form_data)?void 0:s.map_label_colors)||{},sharedLabelsColors:(null==e||null==(i=e.form_data)?void 0:i.shared_label_colors)||[]}}},15151:(e,t,r)=>{"use strict";r.d(t,{L:()=>p,PU:()=>l,UX:()=>f,bE:()=>h,ed:()=>u,fZ:()=>_,mu:()=>i,nr:()=>y,qC:()=>c});var a=r(7349),n=r(85170),o=r(62952);const s="<empty string>",i="<NULL>",l="TRUE",c="FALSE",d=(0,a.mo)(n.A.DATABASE_DATETIME);function u(e){return null===e?i:""===e?s:!0===e?l:!1===e?c:"string"!=typeof e&&e.toString?e.toString():e}function m(e){return e.name||e}function p(e,t){let r=t.length?`${t.map(m).join("\t")}\n`:"";for(let a=0;a<e.length;a+=1){const n={};for(let r=0;r<t.length;r+=1){const o=m(t[r]);o in e[a]?n[r]=e[a][o]:n[r]=e[a][parseFloat(o)]}r+=`${Object.values(n).join("\t")}\n`}return r}function h(e,t){return e&&0!==e.length&&0!==(0,o.A)(t).length?e.map((e=>({...e,...t.reduce(((t,r)=>(null!==e[r]&&void 0!==e[r]&&(t[r]=d(e[r])),t)),{})}))):e}const _=()=>{},f=()=>{const{appVersion:e}=navigator;return e.includes("Win")?"Windows":e.includes("Mac")?"MacOS":e.includes("X11")?"UNIX":e.includes("Linux")?"Linux":"Unknown OS"},y=()=>{const{userAgent:e}=navigator;return e&&/^((?!chrome|android).)*safari/i.test(e)}},16294:(e,t,r)=>{"use strict";r.d(t,{A:()=>Ze});var a=r(90128),n=r.n(a),o=r(92295),s=r(11058),i=r(41889),l=r(9561),c=r(1372),d=r(34331),u=r(72121),m=r(30845),p=r(40562),h=r(83762),_=r(26924),f=r(8065),y=r(18591),E=r(32153),g=r(3786),T=r(77906),A=r(81018),b=r(24768),S=r(7713),v=r(55886),R=r(14262),I=r(14296),O=r(21143),C=r(6746),D=r(90888),w=r(30513),L=r(48990),N=r(80088),q=r(41566),x=r(39069),U=r(59499),P=r(73964),M=r(2064),F=r(94824),k=r(85539),Y=r(14319),Q=r(29729),B=r(11387),H=r(94904),j=r(69988),$=r(31628),G=r(21883),V=r(41710),z=r(65710),W=r(87942),K=r(85225),X=r(78027),J=r(57287),Z=r(40183),ee=r(10464),te=r(65010),re=r(92171),ae=r(19803),ne=r(84890),oe=r(385),se=r(36962),ie=r(65619),le=r(35709),ce=r(35066),de=r(78854),ue=r(92396),me=r(85900),pe=r(39822),he=r(68940),_e=r(80581),fe=r(14588),ye=r(43903),Ee=r(20736),ge=r(78602),Te=r(62786),Ae=r(28266),be=r(74581),Se=r(1005),ve=r(64595),Re=r(49932),Ie=r(13341),Oe=r(75763),Ce=r(77028),De=r(74046),we=r(3085),Le=r(87450),Ne=r(98361),qe=r(77574),xe=r(97),Ue=r(17451),Pe=r(29567),Me=r(70462),Fe=r(73108),ke=r(36704),Ye=r(50378),Qe=r(96453),Be=r(17437),He=r(2445);const je=({component:e,iconColor:t,iconSize:r,viewBox:a,customIcons:n,...o})=>{const s=(0,Qe.DP)(),i=Be.AH`
    color: ${t||s.colors.grayscale.base};
    font-size: ${r?`${s.typography.sizes[r]||s.typography.sizes.m}px`:"24px"};
  `,l=null!=o&&o.onClick?"button":"img",c=(e=>{const t=e.replace(/_/g,"-"),r=t.split(/(?=[A-Z])/);return 2===r.length?r[0].toLowerCase():r.length>=3?`${r[0].toLowerCase()}-${r[1].toLowerCase()}`:t.toLowerCase()})(o.fileName||"");return n?(0,He.Y)("span",{role:l,"aria-label":c,css:[Be.AH`
          display: inline-flex;
          align-items: center;
          line-height: 0;
          vertical-align: middle;
        `,i,"",""],children:(0,He.Y)(e,{viewBox:a||"0 0 24 24",width:r?`${s.typography.sizes[r]||s.typography.sizes.m}px`:"24px",height:r?`${s.typography.sizes[r]||s.typography.sizes.m}px`:"24px",...o})}):(0,He.Y)(e,{css:i,role:l,"aria-label":c,...o})},$e={AlignCenterOutlined:o.A,AlignLeftOutlined:s.A,AlignRightOutlined:i.A,ApartmentOutlined:l.A,AppstoreOutlined:c.A,AreaChartOutlined:d.A,ArrowRightOutlined:u.A,BarChartOutlined:m.A,BellOutlined:p.A,BookOutlined:h.A,CaretUpOutlined:_.A,CaretDownOutlined:f.A,CaretLeftOutlined:y.A,CaretRightOutlined:E.A,CalendarOutlined:g.A,CheckOutlined:T.A,CheckCircleOutlined:A.A,CheckCircleFilled:b.A,CheckSquareOutlined:S.A,CloseOutlined:v.A,CloseCircleOutlined:R.A,ClockCircleOutlined:I.A,ColumnWidthOutlined:O.A,CommentOutlined:C.A,ConsoleSqlOutlined:D.A,CopyOutlined:w.A,DashboardOutlined:L.A,DatabaseOutlined:N.A,DeleteFilled:q.A,DownSquareOutlined:x.A,DeleteOutlined:U.A,DownOutlined:P.A,DownloadOutlined:M.A,EditOutlined:F.A,EllipsisOutlined:k.A,ExclamationCircleOutlined:Y.A,ExclamationCircleFilled:Q.A,EyeOutlined:B.A,EyeInvisibleOutlined:H.A,FallOutlined:j.A,FieldTimeOutlined:$.A,FileImageOutlined:G.A,FileOutlined:V.A,FileTextOutlined:z.A,FireOutlined:W.A,FullscreenExitOutlined:K.A,FullscreenOutlined:X.A,FundProjectionScreenOutlined:J.A,FunctionOutlined:Z.A,InfoCircleOutlined:ee.A,InfoCircleFilled:te.A,InsertRowAboveOutlined:re.A,InsertRowBelowOutlined:ae.A,LineChartOutlined:ne.A,LinkOutlined:oe.A,LoadingOutlined:se.A,MailOutlined:ie.A,MinusCircleOutlined:le.A,MonitorOutlined:ce.A,MoreOutlined:de.A,PieChartOutlined:ue.A,PicCenterOutlined:me.A,PlusCircleOutlined:pe.A,PlusOutlined:he.A,ReloadOutlined:_e.A,RightOutlined:fe.A,SaveOutlined:ye.A,SearchOutlined:Ee.A,SettingOutlined:ge.A,StarOutlined:Te.A,StarFilled:Ae.A,StopOutlined:be.A,SyncOutlined:Se.A,TagOutlined:ve.A,TagsOutlined:Re.A,TableOutlined:Ie.A,LockOutlined:Oe.A,UploadOutlined:Ce.A,UnlockOutlined:De.A,UpOutlined:we.A,UserOutlined:Le.A,VerticalAlignBottomOutlined:Ne.A,VerticalAlignTopOutlined:qe.A,VerticalLeftOutlined:xe.A,VerticalRightOutlined:Ue.A,NumberOutlined:Pe.A,ThunderboltOutlined:Me.A,FilterOutlined:Fe.A,UnorderedListOutlined:ke.A,WarningOutlined:Ye.A},Ge=Object.keys($e).filter((e=>!e.includes("TwoTone"))).map((e=>({[e]:t=>(0,He.Y)(je,{component:$e[e],fileName:e,...t})}))).reduce(((e,t)=>({...e,...t})));var Ve=r(96540);function ze(){return ze=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var a in r)({}).hasOwnProperty.call(r,a)&&(e[a]=r[a])}return e},ze.apply(null,arguments)}const We=({title:e,titleId:t,...r},a)=>Ve.createElement("svg",ze({xmlns:"http://www.w3.org/2000/svg",width:24,height:24,fill:"none",ref:a,"aria-labelledby":t},r)),Ke=(0,Ve.forwardRef)(We),Xe=e=>{const[,t]=(0,Ve.useState)(!1),a=(0,Ve.useRef)(),{fileName:n}=e;return(0,Ve.useEffect)((()=>{let e=!1;return async function(){a.current=(await r(27724)(`./${n}.svg`)).default,e||t(!0)}(),()=>{e=!0}}),[n,a]),(0,He.Y)(je,{component:a.current||Ke,...e})},Je={};["ballot","big-number-chart-tile","binoculars","category","certified","checkbox-half","checkbox-off","checkbox-on","circle_solid","drag","error_solid_small_red","error","full","layers","queued","redo","running","slack","square","sort_asc","sort_desc","sort","transparent","triangle_down","undo"].forEach((e=>{const t=n()(e).replace(/ /g,"");Je[t]=t=>(0,He.Y)(Xe,{customIcons:!0,fileName:e,...t})}));const Ze={...Ge,...Je}},16784:(e,t,r)=>{"use strict";r.d(t,{A:()=>u});var a=r(6924),n=r.n(a),o=r(96540),s=r(63142),i=r(30709),l=r(8834),c=r(27366),d=r(2445);const u=function({source:e,htmlSanitization:t=!0,htmlSchemaOverrides:a={}}){const u=(0,c.G7)(c.TO.EscapeMarkdownHtml),[m,p]=(0,o.useState)(null),[h,_]=(0,o.useState)(null);(0,o.useEffect)((()=>{Promise.all([Promise.all([r.e(4693),r.e(9917)]).then(r.bind(r,9917)),Promise.all([r.e(4693),r.e(9544)]).then(r.bind(r,89544))]).then((([e,t])=>{p((()=>e.default)),_((()=>t.default))}))}),[]);const f=(0,o.useMemo)((()=>{const e=[];if(!u&&m&&(e.push(m),t)){const t=function(e,t){return n()(e,t,((e,t)=>Array.isArray(e)?e.concat(t):void 0))}(s.j,a);e.push([i.A,t])}return e}),[u,t,a,m]);return h&&m?(0,d.Y)(h,{rehypePlugins:f,remarkPlugins:[l.A],skipHtml:!1,transformLinkUri:null,children:e}):null}},17444:(e,t,r)=>{"use strict";r.d(t,{A:()=>c});var a=r(96453),n=r(46942),o=r.n(n),s=r(39197),i=r(2445);const l=a.I4.img`
  z-index: 99;
  width: 50px;
  height: unset;
  position: relative;
  margin: 10px;
  &.inline {
    margin: 0px;
    width: 30px;
  }
  &.inline-centered {
    margin: 0 auto;
    width: 30px;
    display: block;
  }
  &.floating {
    padding: 0;
    margin: 0;
    position: absolute;
    left: 50%;
    top: 50%;
    transform: translate(-50%, -50%);
  }
`;function c({position:e="floating",image:t,className:r}){return(0,i.Y)(l,{className:o()("loading",e,r),alt:"Loading...",src:t||s,role:"status","aria-live":"polite","aria-label":"Loading"})}},17596:(e,t,r)=>{"use strict";r.d(t,{a6:()=>k,jX:()=>b,Tb:()=>v,QC:()=>T,GW:()=>S,dI:()=>L,LK:()=>R,QQ:()=>E});var a={};r.r(a),r.d(a,{NVD3TimeSeries:()=>f,annotations:()=>_,colorScheme:()=>p,datasourceAndVizType:()=>m,sqlaTimeSeries:()=>h});var n=r(41811),o=r(5795),s=r(18253),i=r(36818),l=r(7858),c=r(95579),d=r(93327),u=r(2445);const m={controlSetRows:[["datasource"],["viz_type"],[{name:"slice_id",config:{type:"HiddenControl",label:(0,c.t)("Chart ID"),hidden:!0,description:(0,c.t)("The id of the active chart")}},{name:"cache_timeout",config:{type:"HiddenControl",label:(0,c.t)("Cache Timeout (seconds)"),hidden:!0,description:(0,c.t)("The number of seconds before expiring the cache")}},{name:"url_params",config:{type:"HiddenControl",label:(0,c.t)("URL parameters"),hidden:!0,description:(0,c.t)("Extra parameters for use in jinja templated queries")}}]]},p={label:(0,c.t)("Color scheme"),controlSetRows:[["color_scheme"]]},h={label:(0,c.t)("Time"),description:(0,c.t)("Time related form attributes"),expanded:!0,controlSetRows:[["granularity_sqla"],["time_range"]]},_={label:(0,c.t)("Annotations and layers"),tabOverride:"data",expanded:!0,controlSetRows:[[{name:"annotation_layers",config:{type:"AnnotationLayerControl",label:"",default:[],description:(0,c.t)("Annotation layers"),renderTrigger:!0,tabOverride:"data"}}]]},f=[{label:(0,c.t)("Query"),expanded:!0,controlSetRows:[["metrics"],["adhoc_filters"],["groupby"],["limit","timeseries_limit_metric"],["order_desc"],[{name:"contribution",config:{type:"CheckboxControl",label:(0,c.t)("Contribution"),default:!1,description:(0,c.t)("Compute the contribution to the total")}}],["row_limit",null]]},{label:(0,c.t)("Advanced analytics"),tabOverride:"data",description:(0,c.t)("This section contains options that allow for advanced analytical post processing of query results"),controlSetRows:[[(0,u.Y)(d.y,{children:(0,c.t)("Rolling window")})],[{name:"rolling_type",config:{type:"SelectControl",label:(0,c.t)("Rolling function"),default:"None",choices:[["None",(0,c.t)("None")],["mean",(0,c.t)("mean")],["sum",(0,c.t)("sum")],["std",(0,c.t)("std")],["cumsum",(0,c.t)("cumsum")]],description:(0,c.t)("Defines a rolling window function to apply, works along with the [Periods] text box")}},{name:"rolling_periods",config:{type:"TextControl",label:(0,c.t)("Periods"),isInt:!0,description:(0,c.t)("Defines the size of the rolling window function, relative to the time granularity selected")}},{name:"min_periods",config:{type:"TextControl",label:(0,c.t)("Min periods"),isInt:!0,description:(0,c.t)('The minimum number of rolling periods required to show a value. For instance if you do a cumulative sum on 7 days you may want your "Min Period" to be 7, so that all data points shown are the total of 7 periods. This will hide the "ramp up" taking place over the first 7 periods')}}],[(0,u.Y)(d.y,{children:(0,c.t)("Time comparison")})],[{name:"time_compare",config:{type:"SelectControl",multi:!0,freeForm:!0,label:(0,c.t)("Time shift"),choices:[["1 day",(0,c.t)("1 day")],["1 week",(0,c.t)("1 week")],["28 days",(0,c.t)("28 days")],["30 days",(0,c.t)("30 days")],["52 weeks",(0,c.t)("52 weeks")],["1 year",(0,c.t)("1 year")],["104 weeks",(0,c.t)("104 weeks")],["2 years",(0,c.t)("2 years")],["156 weeks",(0,c.t)("156 weeks")],["3 years",(0,c.t)("3 years")]],description:(0,c.t)("Overlay one or more timeseries from a relative time period. Expects relative time deltas in natural language (example: 24 hours, 7 days, 52 weeks, 365 days). Free text is supported.")}},{name:"comparison_type",config:{type:"SelectControl",label:(0,c.t)("Calculation type"),default:"values",choices:[["values",(0,c.t)("Actual values")],["absolute",(0,c.t)("Difference")],["percentage",(0,c.t)("Percentage change")],["ratio",(0,c.t)("Ratio")]],description:(0,c.t)("How to display time shifts: as individual lines; as the difference between the main time series and each time shift; as the percentage change; or as the ratio between series and time shifts.")}}],[(0,u.Y)(d.y,{children:(0,c.t)("Resample")})],[{name:"resample_rule",config:{type:"SelectControl",freeForm:!0,label:(0,c.t)("Rule"),default:null,choices:[["1T",(0,c.t)("1T")],["1H",(0,c.t)("1H")],["1D",(0,c.t)("1D")],["7D",(0,c.t)("7D")],["1M",(0,c.t)("1M")],["1AS",(0,c.t)("1AS")]],description:(0,c.t)("Pandas resample rule")}},{name:"resample_method",config:{type:"SelectControl",freeForm:!0,label:(0,c.t)("Method"),default:null,choices:[["asfreq",(0,c.t)("asfreq")],["bfill",(0,c.t)("bfill")],["ffill",(0,c.t)("ffill")],["median",(0,c.t)("median")],["mean",(0,c.t)("mean")],["sum",(0,c.t)("sum")]],description:(0,c.t)("Pandas resample method")}}]]}],y=(0,n.A)(((e,t)=>{const{sectionOverrides:r={},controlOverrides:n,controlPanelSections:s=[]}=t,c={...a};Object.entries(r).forEach((([e,t])=>{"object"==typeof t&&t.constructor===Object?c[e]={...c[e],...t}:c[e]=t}));const{datasourceAndVizType:d}=c,u=[o.cT.Query,o.cT.Table].includes(e)?["granularity"]:["granularity_sqla","time_grain_sqla"];return[d].concat(s.filter(i.lW)).map((e=>{const{controlSetRows:t}=e;return{...e,controlSetRows:(null==t?void 0:t.map((e=>e.filter((e=>"string"!=typeof e||!u.includes(e))).map((e=>(0,l.s)(e,n))))))||[]}}))}));function E(e,t){const r=(0,s.A)().get(e)||{};return y(t,r)}const g=(0,n.A)(((e,t)=>{const{controlOverrides:r={},controlPanelSections:a=[]}=t,n=(0,l.s)(function(e,t){var r;return null!=(r=e.filter(i.lW).map((e=>e.controlSetRows)).flat(2).find((e=>t===e||null!==e&&"object"==typeof e&&"name"in e&&e.name===t)))?r:null}(a,e),r);return n&&"config"in n?n.config:n})),T=function(e,t){const r=(0,s.A)().get(t)||{};return g(e,r)};var A=r(62952);function b(e,t){const{mapStateToProps:r}=e;let a={...e},{value:n}=a;return r&&t&&(a={...e,...r.call(e,t,e)},n=n||a.value),"function"==typeof a.initialValue&&(a.initialValue=a.initialValue(a,t),"function"==typeof a.initialValue&&delete a.initialValue),a.initialValue&&(n=a.initialValue,delete a.initialValue),"function"==typeof a.default&&(a.default=a.default(a,t),"function"==typeof a.default&&delete a.default),a.default&&void 0===n&&(n=a.default),n&&a.multi&&!Array.isArray(n)&&(n=[n]),a.value=n,function(e,t){const r=e.validators,{externalValidationErrors:a=[]}=e,n=[];r&&r.length>0&&r.forEach((r=>{const a=r.call(e,e.value,t);a&&n.push(a)}));const o=[...n,...a];return{...e,validationErrors:o}}(function(e){if("SelectControl"===e.type&&!e.freeForm&&e.choices&&e.value){const t={...e},r=e.choices,a=(0,A.A)(e.value),n=r.map((e=>e[0]));if(e.multi&&a.length>0)return t.value=a.filter((e=>n.includes(e))),t;if(!e.multi&&!n.includes(a[0]))return t.value=null,t}return e}(a),a)}function S(e,t,r){if(!e)return null;const a={...e,value:r};return null!=t&&t.controls||null===t?b(a,t):a}function v(e,t,r,a){const n={};return E(e,t).forEach((e=>e.controlSetRows.forEach((e=>e.forEach((e=>{if(null!=e&&e.config&&e.name){const{config:t,name:o}=e;n[o]=S(t,r,a[o])}})))))),n}function R(e){const t={};return Object.keys(e).forEach((r=>{const a=e[r];t[r]=a.value})),t}var I=r(62193),O=r.n(I),C=r(91778),D=r(808);const w=(e,t,r)=>t.options&&"string"==typeof r&&(!O()(t.options)&&t.options.some((e=>Array.isArray(e)?e[0]===r:e.column_name===r))||!O()(null==e?void 0:e.columns))?e.columns.some((e=>e.column_name===r)):t.savedMetrics&&(0,C.S_)(r)&&(t.savedMetrics.some((e=>e.metric_name===r))||!O()(null==e?void 0:e.metrics))?e.metrics.some((e=>e.metric_name===r)):t.columns&&((0,C.IN)(r)||(0,D.md)(r))&&(!O()(t.columns)&&t.columns.some((e=>{var t;return e.column_name===(null==(t=r.column)?void 0:t.column_name)||e.column_name===r.subject}))||!O()(null==e?void 0:e.columns))?e.columns.some((e=>{var t;return e.column_name===(null==(t=r.column)?void 0:t.column_name)||e.column_name===r.subject})):!!(0,C.WL)(r)&&(Object.assign(r,{datasourceWarning:!0}),!0),L=(e,t,r)=>{if(null!=r){if(Array.isArray(r)){const a=r.filter((r=>w(e,t,r)));return a.length>0?a:t.default}return w(e,t,r)?r:t.default}};var N=r(90179),q=r.n(N),x=r(24928),U=r(91715);const P=["metric","metrics","metric_2","size","x","y","secondary_metric"],M=["groupby","columns","groupbyColumns","groupbyRows","entity","series","series_columns"],F=["granularity_sqla","time_grain_sqla","time_range","adhoc_filters","limit","timeseries_limit_metric","series_limit_metric","order_desc","row_limit","x_axis","rolling_type","rolling_periods","min_periods","time_compare","comparison_type","resample_rule","resample_method"];class k{constructor(e){var t,r;this.sfd=void 0;const a=Object.freeze(e),n=null==a||null==(t=a.standardizedFormData)?void 0:t.memorizedFormData,o=a.viz_type;let s,i=new Map;if(Array.isArray(n)&&n.length>0&&a.datasource===(null==(r=n.slice(-1)[0][1])?void 0:r.datasource))i=new Map(a.standardizedFormData.memorizedFormData),i.has(o)&&i.delete(o),i.set(o,a),s=k.getStandardizedControls(a);else{const e=q()(a,"standardizedFormData");i.set(o,e),s=k.getStandardizedControls(e)}this.sfd={controls:s,memorizedFormData:i}}static getStandardizedControls(e){const t={metrics:[],columns:[]};if(Object.entries(e).forEach((([e,r])=>{P.includes(e)&&t.metrics.push(...(0,A.A)(r)),M.includes(e)&&t.columns.push(...(0,A.A)(r))})),(0,i.Wk)(e)){const{metrics:r,columns:a}=e.standardizedFormData.controls;t.metrics.push(...r),t.columns.push(...a)}return t}getLatestFormData(e){return this.has(e)?this.get(e):this.memorizedFormData.slice(-1)[0][1]}get standardizedControls(){return this.sfd.controls}get memorizedFormData(){return Array.from(this.sfd.memorizedFormData.entries())}serialize(){return{controls:this.standardizedControls,memorizedFormData:this.memorizedFormData}}has(e){return this.sfd.memorizedFormData.has(e)}get(e){return this.sfd.memorizedFormData.get(e)}transform(e,t){const r=this.getLatestFormData(e),a={};F.forEach((e=>{e in t.form_data&&(a[e]=t.form_data[e])}));const n=(0,U.Eu)(t,{...r,...a,viz_type:e}),o={...R(n),standardizedFormData:this.serialize()};let i={formData:o,controlsState:n};const l=(0,s.A)().get(e);if(null!=l&&l.formDataOverrides){(0,x.a)().setStandardizedControls(o);const e={...l.formDataOverrides(o),standardizedFormData:{controls:{...(0,x.a)().controls},memorizedFormData:this.memorizedFormData}};(0,x.a)().clear(),i={formData:e,controlsState:(0,U.Eu)(t,e)}}return i.controlsState=(0,U.Eu)({...t,controls:i.controlsState},i.formData),i}}},18253:(e,t,r)=>{"use strict";r.d(t,{A:()=>s});var a=r(25373),n=r(70360);class o extends a.A{constructor(){super({name:"ChartControlPanel"})}}const s=(0,n.A)(o)},19129:(e,t,r)=>{"use strict";r.d(t,{m_:()=>s});var a=r(96453),n=r(27583),o=r(2445);const s=({overlayStyle:e,...t})=>(0,o.Y)(n.A,{styles:{body:{overflow:"hidden",textOverflow:"ellipsis"},root:null!=e?e:{}},color:`${a.TT.colors.grayscale.dark2}e6`,...t})},20824:(e,t,r)=>{"use strict";r.d(t,{Ay:()=>d,FC:()=>l});var a=r(78130),n=r(52123),o=r(81151),s=r(68921),i=r(24647);const l={scope:[o.wv],immune:[]},c=[a.mg];function d(e={},t){const r={[a.mg](e){const{newSelectedValues:r,merge:a}=t,n=Object.keys(r).reduce(((e,t)=>a&&t in e?{...e,[t]:[...e[t],...r[t]]}:{...e,[t]:r[t]}),{...e.columns});return{...e,columns:n}},[a.J2](e){const{path:r}=t;return{...e,directPathToFilter:r}}};if(t.type===a.GK)return(0,s.kl)({dashboardFilters:e,components:t.components}),e;if(t.type===a.GS){const r=t.scopes,a=Object.entries(r).reduce(((e,t)=>{const[r,{scope:a,immune:n}]=t,{chartId:o,column:s}=(0,i.w)(r),l={...e[o].scopes,[s]:{scope:a,immune:n}};return{...e,[o]:{...e[o],scopes:l}}}),e);return(0,s.kl)({dashboardFilters:a}),a}if(t.type===n.n)return t.data.dashboardFilters;if(t.type in r){const a={...e,[t.chartId]:r[t.type](e[t.chartId])};return c.includes(t.type)&&(0,s.kl)({dashboardFilters:a}),a}return e}},23807:(e,t,r)=>{"use strict";r.d(t,{Q:()=>m});var a,n=r(16781),o=r(39472),s=r(99601),i=r(31357),l=r(41817);!function(e){e.LIGHT="light"}(a||(a={}));const c={[a.LIGHT]:e=>({...l.A.defaultAlgorithm(e),borderRadiusLG:s.w.borderRadius,borderRadiusOuter:s.w.borderRadius,borderRadiusSM:s.w.borderRadius,borderRadiusXS:s.w.borderRadius,colorBgContainer:s.w.colors.primary.light4,colorBgElevated:s.w.colors.primary.base,colorBgLayout:s.w.colors.grayscale.light4,colorBgMask:s.w.colors.grayscale.light2,colorBgSpotlight:s.w.colors.grayscale.dark1,colorBorder:s.w.colors.grayscale.light2,colorBorderSecondary:s.w.colors.grayscale.light3,colorErrorActive:s.w.colors.error.dark1,colorErrorBg:s.w.colors.error.light2,colorErrorBgActive:s.w.colors.error.light1,colorErrorBgHover:s.w.colors.error.light2,colorErrorBorder:s.w.colors.error.light1,colorErrorBorderHover:s.w.colors.error.light1,colorErrorHover:s.w.colors.error.base,colorErrorText:s.w.colors.error.base,colorErrorTextActive:s.w.colors.error.dark1,colorErrorTextHover:s.w.colors.error.base,colorFill:s.w.colors.grayscale.light4,colorFillSecondary:s.w.colors.grayscale.light2,colorFillTertiary:s.w.colors.grayscale.light3,colorInfoActive:s.w.colors.info.dark1,colorInfoBg:s.w.colors.info.light2,colorInfoBgHover:s.w.colors.info.light1,colorInfoBorder:s.w.colors.info.light1,colorInfoBorderHover:s.w.colors.info.dark1,colorInfoHover:s.w.colors.info.dark1,colorInfoText:s.w.colors.info.dark1,colorInfoTextActive:s.w.colors.info.dark2,colorInfoTextHover:s.w.colors.info.dark1,colorLinkActive:s.w.colors.info.dark2,colorLinkHover:s.w.colors.info.dark1,colorPrimaryActive:s.w.colors.primary.dark2,colorPrimaryBg:s.w.colors.primary.light4,colorPrimaryBgHover:s.w.colors.primary.light3,colorPrimaryBorder:s.w.colors.primary.light2,colorPrimaryBorderHover:s.w.colors.primary.light1,colorPrimaryHover:s.w.colors.primary.dark1,colorPrimaryText:s.w.colors.primary.dark1,colorPrimaryTextActive:s.w.colors.primary.dark2,colorPrimaryTextHover:s.w.colors.primary.dark1,colorSuccessActive:s.w.colors.success.dark1,colorSuccessBg:s.w.colors.success.light2,colorSuccessBgHover:s.w.colors.success.light1,colorSuccessBorder:s.w.colors.success.light1,colorSuccessBorderHover:s.w.colors.success.dark1,colorSuccessHover:s.w.colors.success.dark1,colorSuccessText:s.w.colors.success.dark1,colorSuccessTextActive:s.w.colors.success.dark2,colorSuccessTextHover:s.w.colors.success.dark1,colorText:s.w.colors.grayscale.dark2,colorTextQuaternary:s.w.colors.grayscale.light1,colorTextSecondary:s.w.colors.text.label,colorTextTertiary:s.w.colors.text.help,colorWarningActive:s.w.colors.warning.dark1,colorWarningBg:s.w.colors.warning.light2,colorWarningBgHover:s.w.colors.warning.light1,colorWarningBorder:s.w.colors.warning.light1,colorWarningBorderHover:s.w.colors.warning.dark1,colorWarningHover:s.w.colors.warning.dark1,colorWarningText:s.w.colors.warning.dark1,colorWarningTextActive:s.w.colors.warning.dark2,colorWarningTextHover:s.w.colors.warning.dark1,colorWhite:s.w.colors.grayscale.light5,fontSizeHeading1:s.w.typography.sizes.xxl,fontSizeHeading2:s.w.typography.sizes.xl,fontSizeHeading3:s.w.typography.sizes.l,fontSizeHeading4:s.w.typography.sizes.m,fontSizeHeading5:s.w.typography.sizes.s,fontSizeLG:s.w.typography.sizes.l,fontSizeSM:s.w.typography.sizes.s,fontSizeXL:s.w.typography.sizes.xl,lineWidthBold:s.w.gridUnit/2})},d={token:{borderRadius:s.w.borderRadius,colorBgBase:s.w.colors.primary.light4,colorError:s.w.colors.error.base,colorInfo:s.w.colors.info.base,colorLink:s.w.colors.grayscale.dark1,colorPrimary:s.w.colors.primary.base,colorSuccess:s.w.colors.success.base,colorTextBase:s.w.colors.grayscale.dark2,colorWarning:s.w.colors.warning.base,controlHeight:32,fontFamily:s.w.typography.families.sansSerif,fontFamilyCode:s.w.typography.families.monospace,fontSize:s.w.typography.sizes.m,lineType:"solid",lineWidth:1,sizeStep:s.w.gridUnit,sizeUnit:s.w.gridUnit,zIndexBase:0,zIndexPopupBase:s.w.zIndex.max},components:{Avatar:{containerSize:32,fontSize:s.w.typography.sizes.s,lineHeight:32},Badge:{paddingXS:2*s.w.gridUnit},Button:{defaultBg:s.w.colors.primary.light4,defaultHoverBg:(0,i.jh)(.1,s.w.colors.primary.base,s.w.colors.primary.light4),defaultActiveBg:(0,i.jh)(.25,s.w.colors.primary.base,s.w.colors.primary.light4),defaultColor:s.w.colors.primary.dark1,defaultHoverColor:s.w.colors.primary.dark1,defaultBorderColor:"transparent",defaultHoverBorderColor:"transparent",colorPrimaryHover:s.w.colors.primary.dark1,colorPrimaryActive:(0,i.jh)(.2,s.w.colors.grayscale.dark2,s.w.colors.primary.dark1),primaryColor:s.w.colors.grayscale.light5,colorPrimaryTextHover:s.w.colors.grayscale.light5,colorError:s.w.colors.error.base,colorErrorHover:(0,i.jh)(.1,s.w.colors.grayscale.light5,s.w.colors.error.base),colorErrorBg:(0,i.jh)(.2,s.w.colors.grayscale.dark2,s.w.colors.error.base),dangerColor:s.w.colors.grayscale.light5,colorLinkHover:s.w.colors.primary.base,linkHoverBg:"transparent"},Card:{paddingLG:6*s.w.gridUnit,fontWeightStrong:s.w.typography.weights.medium,colorBgContainer:s.w.colors.grayscale.light4},DatePicker:{colorBgContainer:s.w.colors.grayscale.light5,colorBgElevated:s.w.colors.grayscale.light5,borderRadiusSM:s.w.gridUnit/2},Divider:{colorSplit:s.w.colors.grayscale.light3},Dropdown:{colorBgElevated:s.w.colors.grayscale.light5,zIndexPopup:s.w.zIndex.max},Input:{colorBorder:s.w.colors.secondary.light3,colorBgContainer:s.w.colors.grayscale.light5,activeShadow:`0 0 0 ${s.w.gridUnit/2}px ${s.w.colors.primary.light3}`},InputNumber:{colorBorder:s.w.colors.secondary.light3,colorBgContainer:s.w.colors.grayscale.light5,activeShadow:`0 0 0 ${s.w.gridUnit/2}px ${s.w.colors.primary.light3}`},List:{itemPadding:`${s.w.gridUnit+2}px ${3*s.w.gridUnit}px`,paddingLG:3*s.w.gridUnit,colorSplit:s.w.colors.grayscale.light3,colorText:s.w.colors.grayscale.dark1},Menu:{itemHeight:32,colorBgContainer:s.w.colors.grayscale.light5,subMenuItemBg:s.w.colors.grayscale.light5,colorBgElevated:s.w.colors.grayscale.light5,boxShadowSecondary:`0 3px 6px -4px ${(0,o.o3)(s.w.colors.grayscale.dark2,.12)}, 0 6px 16px 0 ${(0,o.o3)(s.w.colors.grayscale.dark2,.08)}, 0 9px 28px 8px ${(0,o.o3)(s.w.colors.grayscale.dark2,.05)}`,activeBarHeight:0,itemHoverBg:s.w.colors.secondary.light5,padding:2*s.w.gridUnit,subMenuItemBorderRadius:0,horizontalLineHeight:1.4,zIndexPopup:s.w.zIndex.max},Modal:{colorBgMask:`${s.w.colors.grayscale.dark2}73`,contentBg:s.w.colors.grayscale.light5,titleFontSize:4*s.w.gridUnit,titleColor:`${s.w.colors.grayscale.dark2}D9`,headerBg:s.w.colors.grayscale.light4},Tag:{borderRadiusSM:2,defaultBg:s.w.colors.grayscale.light4},Progress:{fontSize:s.w.typography.sizes.s,colorText:s.w.colors.text.label,remainingColor:s.w.colors.grayscale.light4},Popover:{colorBgElevated:s.w.colors.grayscale.light5},Slider:{trackBgDisabled:s.w.colors.grayscale.light1,colorBgElevated:s.w.colors.grayscale.light5,handleSizeHover:10,handleLineWidthHover:2},Steps:{margin:2*s.w.gridUnit,iconSizeSM:20},Switch:{colorPrimaryHover:s.w.colors.primary.base,colorTextTertiary:s.w.colors.grayscale.light1},Tooltip:{fontSize:s.w.typography.sizes.s,lineHeight:1.6}}};var u=r(2445);const m=({theme:e,children:t,...r})=>{return(0,u.Y)(n.Ay,{theme:e||(o=a.LIGHT,{...d,algorithm:c[o||a.LIGHT]}),prefixCls:"antd5",...r,children:t});var o}},23926:(e,t,r)=>{"use strict";r.d(t,{BT:()=>c,Ck:()=>u,eX:()=>d});var a=r(95579),n=r(82920),o=r(62952),s=r(96627),i=r(67984);const l=e=>"horizontal"===(null==e?void 0:e.orientation)?{label:(0,a.t)("Y-axis"),description:(0,a.t)("Dimension to use on y-axis.")}:{label:(0,a.t)("X-axis"),description:(0,a.t)("Dimension to use on x-axis.")},c={label:e=>l(null==e?void 0:e.form_data).label,multi:!1,description:e=>l(null==e?void 0:e.form_data).description,validators:[n.A],initialValue:(e,t)=>{var r,a;if(null!=t&&null!=(r=t.form_data)&&r.granularity_sqla&&(null==(a=t.form_data)||!a.x_axis)&&(null==e||!e.value))return t.form_data.granularity_sqla},default:void 0},d={isTemporal:!0,mapStateToProps:({datasource:e})=>{const t=(0,i.W)(e);return{options:t.temporalColumns,default:t.defaultTemporalColumn}}},u={initialValue:(e,t)=>{var r,a,n,l;if(null!=t&&null!=(r=t.controls)&&null!=(a=r.time_range)&&a.value||(0,o.A)(e.value).findIndex((e=>"TEMPORAL_RANGE"===(null==e?void 0:e.operator)))>-1)return;if(null!=t&&null!=(n=t.form_data)&&n.granularity_sqla&&null!=t&&null!=(l=t.form_data)&&l.time_range)return[...(0,o.A)(e.value),{clause:"WHERE",subject:t.form_data.granularity_sqla,operator:"TEMPORAL_RANGE",comparator:t.form_data.time_range,expressionType:"SIMPLE"}];const c=(null==t?void 0:t.datasource)&&(0,i.W)(t.datasource).defaultTemporalColumn;var d,u;return c?[...(0,o.A)(e.value),{clause:"WHERE",subject:c,operator:"TEMPORAL_RANGE",comparator:(null==t||null==(d=t.common)||null==(u=d.conf)?void 0:u.DEFAULT_TIME_FILTER)||s.WC,expressionType:"SIMPLE"}]:void 0}}},24647:(e,t,r)=>{"use strict";function a({chartId:e,column:t}){return`${e}_${t}`}r.d(t,{s:()=>a,w:()=>o});const n=/^([0-9]+)_(.*)$/;function o(e){const t=n.exec(e);if(!t)throw new Error("Cannot parse invalid filter key");return{chartId:parseInt(t[1],10),column:t[2]}}},24928:(e,t,r)=>{"use strict";r.d(t,{a:()=>o});var a=r(70360),n=r(36818);const o=(0,a.A)(class{constructor(){this.controls=void 0,this.controls={metrics:[],columns:[]}}setStandardizedControls(e){if((0,n.Wk)(e)){const{controls:t}=e.standardizedFormData;this.controls={metrics:t.metrics,columns:t.columns}}}shiftMetric(){return this.controls.metrics.shift()}shiftColumn(){return this.controls.columns.shift()}popAllMetrics(){return this.controls.metrics.splice(0,this.controls.metrics.length)}popAllColumns(){return this.controls.columns.splice(0,this.controls.columns.length)}clear(){this.controls={metrics:[],columns:[]}}})},25946:(e,t,r)=>{"use strict";r.d(t,{A:()=>o});var a=r(84295),n=r(2445);function o(e){const{type:t="info",description:r,showIcon:o=!0,closable:s=!0,children:i,...l}=e;return(0,n.Y)(a.A,{role:"alert","aria-live":"error"===t?"assertive":"polite",type:t,showIcon:o,closable:s,message:i||"Default message",description:r,...l})}},26415:(e,t,r)=>{"use strict";r.d(t,{OM:()=>l,Od:()=>u,R4:()=>p,S9:()=>_,TH:()=>h,X6:()=>E,Xf:()=>c,Y$:()=>m,cd:()=>g,dO:()=>d,oB:()=>A,ow:()=>f,tX:()=>T,zE:()=>y});var a=r(88055),n=r.n(a),o=r(93505),s=r(95004),i=r(48285);const l="SET_NATIVE_FILTERS_CONFIG_COMPLETE",c="SET_IN_SCOPE_STATUS_OF_FILTERS",d=e=>async(t,r)=>{var a;if((e=>Object.values(e).every((e=>Array.isArray(e)&&!e.length)))(e))return;const{id:n}=r().dashboardInfo,c=null==(a=r().nativeFilters)?void 0:a.filters;t({type:"SET_NATIVE_FILTERS_CONFIG_BEGIN",filterChanges:e});const d=(0,o.A)({method:"PUT",endpoint:`/api/v1/dashboard/${n}/filters`});try{const r=await d(e);t((0,i.n7)(r.result)),t({type:l,filterChanges:r.result}),t((0,s.Gb)(e,c))}catch(r){t({type:"SET_NATIVE_FILTERS_CONFIG_FAIL",filterConfig:e})}},u=e=>async(t,r)=>{var a;const o=null==(a=r().nativeFilters)?void 0:a.filters,s=e.map((e=>({...o[e.filterId],chartsInScope:e.chartsInScope,tabsInScope:e.tabsInScope})));t({type:c,filterConfig:s});const l=n()(r().dashboardInfo.metadata),d=l.native_filter_configuration.map((e=>{const t=s.find((t=>t.id===e.id));return t?{...t,...e}:e}));l.native_filter_configuration=d,t((0,i.PD)({metadata:l}))},m="SET_FOCUSED_NATIVE_FILTER",p="UNSET_FOCUSED_NATIVE_FILTER";function h(e){return{type:m,id:e}}function _(){return{type:p}}const f="SET_HOVERED_NATIVE_FILTER",y="UNSET_HOVERED_NATIVE_FILTER";function E(e){return{type:f,id:e}}function g(){return{type:y}}const T="UPDATE_CASCADE_PARENT_IDS";function A(e,t){return{type:T,id:e,parentIds:t}}},26632:(e,t,r)=>{"use strict";r.d(t,{A:()=>d});var a=r(91778),n=r(808),o=r(39131);function s(e){let t=e;return e.includes("--")&&(t=`${e}\n`),`(${t})`}var i=r(46302),l=r(96627),c=r(13270);function d(e,t){var r,d;const{annotation_layers:u=[],extra_form_data:m,time_range:p,since:h,until:_,row_limit:f,row_offset:y,order_desc:E,limit:g,timeseries_limit_metric:T,granularity:A,url_params:b={},custom_params:S={},series_columns:v,series_limit:R,series_limit_metric:I,...O}=e,{adhoc_filters:C=[],filters:D=[],custom_form_data:w={},...L}=m||{},N=Number(f),q=Number(y),{metrics:x,columns:U,orderby:P}=(0,i.A)(O,t),M=function(e){const t={},r=[],a={},n={filters:r,extras:a,applied_time_extras:t},o={__time_range:"time_range",__time_col:"granularity_sqla",__time_grain:"time_grain_sqla",__granularity:"granularity"};return(e.extra_filters||[]).forEach((e=>{if(e.col in o){const r=e.col;n[o[r]]=e.val,t[r]=e.val}else r.push(e)})),a.time_grain_sqla=n.time_grain_sqla||e.time_grain_sqla,n.granularity=n.granularity_sqla||e.granularity||e.granularity_sqla,delete n.granularity_sqla,delete n.time_grain_sqla,n}(e),{filters:F}=M,k={filters:[...F,...D],adhoc_filters:[...e.adhoc_filters||[],...C]},Y=function(e){const{adhoc_filters:t,extras:r={},filters:a=[],where:i}=e,l=a,c=[];i&&c.push(i);const d=[];return(t||[]).forEach((e=>{const{clause:t}=e;if((0,n.md)(e)){const r=(0,o.A)(e);"WHERE"===t&&l.push(r)}else{const{sqlExpression:r}=e;"WHERE"===t?c.push(r):d.push(r)}})),r.having=d.map(s).join(" AND "),r.where=c.map(s).join(" AND "),{filters:l,extras:r}}({...e,...M,...k});let Q={time_range:p||void 0,since:h||void 0,until:_||void 0,granularity:A||void 0,...M,...Y,columns:U,metrics:x,orderby:P,annotation_layers:u,row_limit:null==f||Number.isNaN(N)?void 0:N,row_offset:null==y||Number.isNaN(q)?void 0:q,series_columns:v,series_limit:null!=R?R:(0,c.A)(g)?Number(g):0,series_limit_metric:null!=(r=null!=(d=(e=>{if((0,a.Pr)(e))return e})(I))?d:T)?r:void 0,order_desc:void 0===E||E,url_params:b||void 0,custom_params:S};return Q=function(e,t){const r={...e},{extras:a={}}=r;return Object.entries(l.DV).forEach((([e,a])=>{const n=t[e];void 0!==n&&(r[a]=n)})),l.KE.forEach((e=>{e in t&&(a[e]=t[e])})),Object.keys(a).length>0&&(r.extras=a),r}(Q,L),{...Q,custom_form_data:w}}},27724:(e,t,r)=>{var a={"./ballot.svg":[65665,5665],"./big-number-chart-tile.svg":[6421,6421],"./binoculars.svg":[23577,3577],"./category.svg":[61087,1087],"./certified.svg":[75794,5794],"./checkbox-half.svg":[94466,4466],"./checkbox-off.svg":[26480,6480],"./checkbox-on.svg":[36682,6682],"./circle_solid.svg":[65843,5843],"./drag.svg":[17557,7557],"./error.svg":[38247,8247],"./error_solid_small_red.svg":[16979,6979],"./full.svg":[42192,2192],"./layers.svg":[93425,3425],"./queued.svg":[66656,6656],"./redo.svg":[6479,6479],"./running.svg":[43232,3232],"./slack.svg":[29785,9785],"./sort.svg":[54879,4879],"./sort_asc.svg":[84041,4041],"./sort_desc.svg":[42013,2013],"./square.svg":[59574,9574],"./transparent.svg":[63388,1007],"./triangle_down.svg":[91329,3710],"./undo.svg":[31809,1809]};function n(e){if(!r.o(a,e))return Promise.resolve().then((()=>{var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}));var t=a[e],n=t[0];return r.e(t[1]).then((()=>r(n)))}n.keys=()=>Object.keys(a),n.id=27724,e.exports=n},32132:(e,t,r)=>{"use strict";r.d(t,{Dl:()=>b,JE:()=>A,Kx:()=>E,P3:()=>m,oq:()=>g,ye:()=>f,zJ:()=>S});var a=r(62193),n=r.n(a),o=r(35742),s=r(13270),i=r(58561),l=r.n(i),c=r(27023),d=r(68921),u=r(36878);function m({name:e,type:t}){const r=new URLSearchParams(window.location.search).get(e);switch(t){case"number":return r?"true"===r.toLowerCase()?1:"false"===r.toLowerCase()?0:Number.isNaN(Number(r))?null:Number(r):null;case"object":return r?JSON.parse(r):null;case"boolean":return r?"false"!==r.toLowerCase()&&"0"!==r:null;case"rison":if(!r)return null;try{return l().decode(r)}catch{return r}default:return r}}function p(e){const t=new URLSearchParams;return new URLSearchParams(window.location.search).forEach(((r,a)=>{e.includes(a)||t.append(a,r)})),t}function h(e){const t=[];return e.forEach(((e,r)=>t.push([r,e]))),t}function _(e){const t=e||c.v2,r=p(t),a=(0,d.ug)();return n()(a)||t.includes(c.vX.preselectFilters.name)||r.append(c.vX.preselectFilters.name,JSON.stringify((0,u.A)((0,d.ug)()))),h(r)}function f(e=[]){const t=p([...c.Xs,...e]),r=(0,d.ug)();return n()(r)||t.append(c.vX.preselectFilters.name,JSON.stringify((0,u.A)((0,d.ug)()))),h(t)}function y(e,t){return o.A.post({endpoint:e,jsonPayload:t}).then((e=>e.json.url))}function E(e,t){return y("/api/v1/explore/permalink",{formData:e,urlParams:_(t)})}function g({dashboardId:e,dataMask:t,activeTabs:r,anchor:a}){return y(`/api/v1/dashboard/${e}/permalink`,{urlParams:f(),dataMask:t,activeTabs:r,anchor:a})}const T=/^([^:/?#]+:)?(?:(\/\/)?([^/?#]*))?([^?#]+)?(\?[^#]*)?(#.*)?/;function A(e){const t=e.match(T)||[];return"string"==typeof t[1]&&t[1].length>0||"//"===t[2]||"string"==typeof t[3]&&t[3].length>0}function b(e){const t=e.match(T)||[];return!A(e)||(0,s.A)(t[1])||e.startsWith("//")?e:`//${e}`}function S(e){const t=[];return Object.keys(e).forEach((r=>{const a=e[r];null!=a&&t.push(`${encodeURIComponent(r)}=${encodeURIComponent(a)}`)})),t.length>0?`?${t.join("&")}`:""}},34342:(e,t,r)=>{"use strict";r.d(t,{A7:()=>A,Eg:()=>u,H7:()=>v,HF:()=>p,I2:()=>S,R2:()=>b,X5:()=>T,XL:()=>m,em:()=>f,fj:()=>g,ht:()=>h,jc:()=>y,xX:()=>E,z:()=>R,zz:()=>_});var a=r(95579),n=r(82920),o=r(36818),s=r(42370),i=r(75827),l=r(93698),c=r(23926),d=r(2445);const u={type:"DndColumnSelect",label:(0,a.t)("Dimensions"),multi:!0,freeForm:!0,clearable:!0,default:[],includeTime:!1,description:(0,a.t)("Dimensions contain qualitative values such as names, dates, or geographical data. Use dimensions to categorize, segment, and reveal the details in your data. Dimensions affect the level of detail in the view."),optionRenderer:e=>(0,d.Y)(i.K,{showType:!0,column:e}),valueRenderer:e=>(0,d.Y)(i.K,{column:e}),valueKey:"column_name",allowAll:!0,filterOption:({data:e},t)=>{var r,a;return(null==(r=e.column_name)?void 0:r.toLowerCase().includes(t.toLowerCase()))||(null==(a=e.verbose_name)?void 0:a.toLowerCase().includes(t.toLowerCase()))||!1},promptTextCreator:e=>e,mapStateToProps(e,t){var r;const a={},{datasource:n}=e;if(null!=n&&null!=(r=n.columns[0])&&r.hasOwnProperty("groupby")){const e=n.columns.filter((e=>e.groupby));null!=t&&t.includeTime&&e.unshift(s.CE),a.options=e,a.savedMetrics=n.metrics||[]}else{const e=(null==n?void 0:n.columns)||[];null!=t&&t.includeTime&&e.unshift(s.aO),a.options=e}return a},commaChoosesOption:!1},m={...u,label:(0,a.t)("Columns"),description:(0,a.t)("Add dataset columns here to group the pivot table columns.")},p={...u,label:(0,a.t)("Dimension"),multi:!1,default:null,description:(0,a.t)("Defines the grouping of entities. Each series is represented by a specific color in the chart.")},h={...u,label:(0,a.t)("Entity"),default:null,multi:!1,validators:[n.A],description:(0,a.t)("This defines the element to be plotted on the chart")},_={type:"DndFilterSelect",label:(0,a.t)("Filters"),default:[],description:"",mapStateToProps:({datasource:e,form_data:t})=>({columns:(0,o.TI)(e)?e.columns.filter((e=>e.filterable)):(null==e?void 0:e.columns)||[],savedMetrics:(0,l._)(e),selectedMetrics:t.metrics||(t.metric?[t.metric]:[]),datasource:e}),provideFormDataToProps:!0,...c.Ck},f={type:"DndMetricSelect",multi:!0,label:(0,a.t)("Metrics"),validators:[n.A],mapStateToProps:({datasource:e})=>({columns:(null==e?void 0:e.columns)||[],savedMetrics:(0,l._)(e),datasource:e,datasourceType:null==e?void 0:e.type}),description:(0,a.t)("Select one or many metrics to display. You can use an aggregation function on a column or write custom SQL to create a metric.")},y={...f,multi:!1,label:(0,a.t)("Metric"),description:(0,a.t)("Select a metric to display. You can use an aggregation function on a column or write custom SQL to create a metric.")},E={...y,label:(0,a.t)("Right Axis Metric"),clearable:!0,description:(0,a.t)("Select a metric to display on the right axis")},g={type:"DndMetricSelect",label:(0,a.t)("Sort query by"),default:null,description:(0,a.t)("Orders the query result that generates the source data for this chart. If a series or row limit is reached, this determines what data are truncated. If undefined, defaults to the first metric (where appropriate)."),mapStateToProps:({datasource:e})=>({columns:(null==e?void 0:e.columns)||[],savedMetrics:(0,l._)(e),datasource:e,datasourceType:null==e?void 0:e.type})},T={...y,label:(0,a.t)("Bubble Size"),description:(0,a.t)("Metric used to calculate bubble size"),default:null},A={...y,label:(0,a.t)("X Axis"),description:(0,a.t)("The dataset column/metric that returns the values on your chart's x-axis."),default:null},b={...y,label:(0,a.t)("Y Axis"),description:(0,a.t)("The dataset column/metric that returns the values on your chart's y-axis."),default:null},S={...y,label:(0,a.t)("Color Metric"),default:null,validators:[],description:(0,a.t)("A metric to use for color")},v={...p,...c.eX,label:s.Fp.granularity_sqla,description:(0,a.t)("The time column for the visualization. Note that you can define arbitrary expression that return a DATETIME column in the table. Also note that the filter below is applied against this column or expression"),default:e=>e.default,clearable:!1,canDelete:!1,ghostButtonText:(0,a.t)("Drop a temporal column here or click"),optionRenderer:e=>(0,d.Y)(i.K,{showType:!0,column:e}),valueRenderer:e=>(0,d.Y)(i.K,{column:e}),valueKey:"column_name"},R={...u,...c.BT}},34975:(e,t,r)=>{"use strict";r.d(t,{VZ:()=>i,nC:()=>o,p3:()=>a});var a,n=r(35742);function o(e){return{type:a.SetDatasources,datasources:e}}function s(e,t){return{type:a.SetDatasource,key:t,datasource:e}}function i(e){return(t,r)=>{const{datasources:a}=r(),o=a[e];return o?t(s(o,e)):n.A.get({endpoint:`/superset/fetch_datasource_metadata?datasourceKey=${e}`}).then((({json:r})=>t(s(r,e))))}}!function(e){e.SetDatasources="SET_DATASOURCES",e.SetDatasource="SET_DATASOURCE"}(a||(a={}))},35043:(e,t,r)=>{"use strict";r.d(t,{aN:()=>_,S4:()=>h,Db:()=>m,Vl:()=>g,Ay:()=>T});var a=r(49588),n=r(81151);const o=n.W3+1,s=n.W3+3,i=n.W3+4,l=n.W3+5,c={[a.tq]:{[a.wc]:n.W3,[a.$9]:n.W3},[a.$9]:{[a.oT]:o,[a.rG]:o,[a.xY]:o,[a.QP]:o,[a.n6]:o,[a.PP]:o,[a._8]:o,[a.wc]:o},[a._8]:{[a.oT]:i,[a.rG]:i,[a.xY]:i,[a.QP]:i},[a.wc]:{[a.B8]:s},[a.B8]:{[a.oT]:l,[a.rG]:l,[a.xY]:l,[a.QP]:s,[a.n6]:l,[a.PP]:l,[a._8]:s,[a.wc]:s},[a.QP]:{[a.oT]:l,[a.PP]:l,[a.xY]:l,[a._8]:s,[a.n6]:s,[a.wc]:s},[a.oT]:{},[a.rG]:{},[a.n6]:{},[a.PP]:{},[a.xY]:{}};function d(e){var t;const{parentType:r,childType:a,parentDepth:n}=e;if(!r||!a||"number"!=typeof n)return!1;const o=null==(t=c[r])?void 0:t[a];return"number"==typeof o&&n<=o}const u="DROP_TOP",m="DROP_RIGHT",p="DROP_BOTTOM",h="DROP_LEFT",_="DROP_FORBIDDEN",f=20,y=20;let E={};function g(){E={}}function T(e,t){const{depth:r,parentComponent:n,component:o,orientation:s,isDraggingOverShallow:i}=t.props,l=e.getItem();if(!l||l.id===o.id)return null;const c=d({parentType:o.type,parentDepth:r,childType:l.type}),g=n&&n.type,T=d({parentType:g,parentDepth:r+(g===a.B8||g===a.wc?0:-1),childType:l.type});if(!c&&!T)return _;const A=(o.children||[]).length>0,b="row"===s?"vertical":"horizontal",S="row"===s?"horizontal":"vertical";if(c&&!T)return"vertical"===b?A?m:h:A?p:u;const v=t.ref.getBoundingClientRect(),R=e.getClientOffset()||E[o.id];if(!R||!v)return null;E[o.id]=R;const I=Math.abs(R.y-v.top),O=Math.abs(R.y-v.bottom),C=Math.abs(R.x-v.left),D=Math.abs(R.x-v.right);if(!i&&[I,O,C,D].every((e=>e>y)))return null;if(T&&!c){if("vertical"===S){const e=v.left+(v.right-v.left)/2;return R.x<e?h:m}const e=v.top+(v.bottom-v.top)/2;return R.y<e?u:p}if(T&&c){if("vertical"===S){if(C<f)return h;if(D<f)return m}else{if(I<f)return u;if(O<f)return p}return"vertical"===b?A?m:h:A?p:u}return null}},35700:(e,t,r)=>{"use strict";r.d(t,{AI:()=>z,AP:()=>j,A_:()=>F,C7:()=>O,CY:()=>K,Ek:()=>k,FA:()=>l,FO:()=>d,GM:()=>$,HH:()=>v,HK:()=>i,Lb:()=>H,Mr:()=>Q,Ob:()=>G,PN:()=>I,PV:()=>W,R2:()=>A,Ro:()=>P,U7:()=>u,Vy:()=>J,XC:()=>Y,Xj:()=>o,YC:()=>X,ar:()=>T,bD:()=>x,c1:()=>y,ci:()=>E,cm:()=>R,es:()=>s,fL:()=>B,ft:()=>V,g$:()=>M,gi:()=>U,hK:()=>N,hl:()=>p,k8:()=>w,ky:()=>c,oA:()=>b,oW:()=>m,pi:()=>q,q0:()=>g,r2:()=>_,tE:()=>n,tO:()=>a,tw:()=>h,v2:()=>L,v6:()=>S,vp:()=>D,wc:()=>f,xb:()=>C});const a="load_chart",n="render_chart",o="hide_browser_tab",s="mount_dashboard",i="mount_explorer",l="select_dashboard_tab",c="force_refresh_chart",d="change_explore_controls",u="toggle_edit_dashboard",m="force_refresh_dashboard",p="periodic_render_dashboard",h="explore_dashboard_chart",_="export_csv_dashboard_chart",f="export_xlsx_dashboard_chart",y="change_dashboard_filter",E="dataset_creation_empty_cancellation",g="dataset_creation_database_cancellation",T="dataset_creation_schema_cancellation",A="dataset_creation_table_cancellation",b="dataset_creation_success",S="spa_navigation",v="confirm_overwrite_dashboard_metadata",R="dashboard_download_as_image",I="dashboard_download_as_pdf",O="chart_download_as_image",C="chart_download_as_csv",D="chart_download_as_csv_pivoted",w="chart_download_as_xls",L="chart_download_as_json",N="sqllab_warn_local_storage_usage",q="sqllab_fetch_failed_query",x="drill_by_modal_opened",U="further_drill_by",P="drill_by_edit_chart",M="drill_by_breadcrumb_clicked",F="sqllab_monitor_local_storage_usage",k="sqllab_create_table_as",Y="sqllab_create_view_as",Q="sqllab_run_query",B="sqllab_stop_query",H="sqllab_estimate_query_cost",j="sqllab_save_query",$="sqllab_copy_link",G="sqllab_format_sql",V="sqllab_download_csv",z="sqllab_copy_result_to_clipboard",W="sqllab_create_chart",K="sqllab_load_tab_state",X=new Set([a,n,o,q,K]),J=(new Set([s,l,h,c,_,y,d,u,m,p,i,v,R,I,O]),{timeOriginOffset:0,markTimeOrigin(){this.timeOriginOffset=window.performance.now()},getTimestamp(){return Math.round(window.performance.now()-this.timeOriginOffset)}})},35837:(e,t,r)=>{"use strict";r.d(t,{Q1:()=>l,_v:()=>c});var a=r(96540),n=r(27023),o=r(32132),s=r(2445);const i=(0,a.createContext)({hideTitle:!1,hideTab:!1,hideNav:!1,hideChartControls:!1}),l=()=>(0,a.useContext)(i),c=({children:e})=>{const t=(0,o.P3)(n.vX.uiConfig)||0,[r]=(0,a.useState)({hideTitle:!!(1&t),hideTab:!!(2&t),hideNav:!!(4&t),hideChartControls:!!(8&t)});return(0,s.Y)(i.Provider,{value:r,children:e})}},35839:(e,t,r)=>{"use strict";r.d(t,{As:()=>p,CE:()=>E,OL:()=>y,ZT:()=>_,j2:()=>h,r$:()=>T,sF:()=>g,uI:()=>f});var a=r(29132),n=r.n(a),o=r(90179),s=r.n(o),i=r(42194),l=r.n(i),c=r(2404),d=r.n(c),u=r(43561),m=(r(97211),r(62952));function p(e,t,r){const a={...e[t]},n={...r};return n.id||(n.id=(0,u.Ak)()),a[n.id]=n,{...e,[t]:a}}function h(e,t,r,a){const n={...e[t]};return n[r.id]={...n[r.id],...a},{...e,[t]:n}}function _(e,t,r,a,n="id"){const o=[];return e[t].forEach((e=>{r[n]===e[n]?o.push({...e,...a}):o.push(e)})),{...e,[t]:o}}function f(e,t,r,a="id"){const n=[];return e[t].forEach((e=>{r[a]!==e[a]&&n.push(e)})),{...e,[t]:n}}function y(e,t){let r;return e.forEach((e=>{e.id===t&&(r=e)})),r}function E(e,t,r,a=!1){const n={...r};n.id||(n.id=(0,u.Ak)());const o={};return o[t]=a?[n,...e[t]]:[...e[t],n],{...e,...o}}function g(e,t,r,a=!1){const n=[...r];n.forEach((e=>{e.id||(e.id=(0,u.Ak)())}));const o={};return o[t]=a?[...n,...e[t]]:[...e[t],...n],{...e,...o}}function T(e,t,r={ignoreUndefined:!1,ignoreNull:!1,ignoreFields:[]}){var a;let o=e,i=t;if(r.ignoreUndefined&&(o=l()(o,(e=>void 0===e)),i=l()(i,(e=>void 0===e))),r.ignoreNull&&(o=l()(o,(e=>null===e)),i=l()(i,(e=>null===e))),null!=(a=r.ignoreFields)&&a.length){const e=(0,m.A)(r.ignoreFields);return n()(o,i,((t,r)=>d()((0,m.A)(t).map((t=>s()(t,e))),(0,m.A)(r).map((t=>s()(t,e))))))}return d()(o,i)}},36770:(e,t,r)=>{"use strict";r.d(t,{A:()=>n});var a=r(91778);function n(e){return(0,a.S_)(e)?e:e.label?e.label:(0,a.IN)(e)?`${e.aggregate}(${e.column.columnName||e.column.column_name})`:e.sqlExpression}},36818:(e,t,r)=>{"use strict";r.d(t,{M5:()=>a,Mb:()=>m,TI:()=>d,Wk:()=>n,fH:()=>o,kj:()=>u,lW:()=>c,oU:()=>l,ro:()=>s,wS:()=>i});const a=e=>"object"==typeof e&&null!==e&&"string"==typeof("name"in e&&e.name)&&"object"==typeof("config"in e&&e.config)&&null!==e.config,n=e=>{var t,r;return(null==e||null==(t=e.standardizedFormData)?void 0:t.controls)&&(null==e||null==(r=e.standardizedFormData)?void 0:r.memorizedFormData)&&Array.isArray(e.standardizedFormData.controls.metrics)&&Array.isArray(e.standardizedFormData.controls.columns)};var o;!function(e){e.None="None",e.GreaterThan=">",e.LessThan="<",e.GreaterOrEqual="≥",e.LessOrEqual="≤",e.Equal="=",e.NotEqual="≠",e.Between="< x <",e.BetweenOrEqual="≤ x ≤",e.BetweenOrLeftEqual="≤ x <",e.BetweenOrRightEqual="< x ≤"}(o||(o={}));const s=[o.Between,o.BetweenOrEqual,o.BetweenOrLeftEqual,o.BetweenOrRightEqual];function i(e){return!!e&&"column_name"in e}function l(e){return"column_name"in e&&"expression"in e&&!!e.expression}function c(e){return null!==e}function d(e){return!!e&&"columns"in e&&!("sqlEditorId"in e)}function u(e){return!!e&&"results"in e&&"sqlEditorId"in e}var m;!function(e){e.Name="name",e.Max="max",e.Min="min",e.Sum="sum",e.Avg="avg"}(m||(m={}))},36878:(e,t,r)=>{"use strict";r.d(t,{A:()=>n});var a=r(24647);function n(e){return Object.entries(e).reduce(((e,t)=>{const[r,{values:n}]=t,{chartId:o,column:s}=(0,a.w)(r),i={...e[o],[s]:n};return{...e,[o]:i}}),{})}},37725:(e,t,r)=>{"use strict";function a(){return(window.location.hash||"#").substring(1)}r.d(t,{A:()=>a})},38677:(e,t,r)=>{"use strict";r.d(t,{Od:()=>i,aj:()=>s,yj:()=>l});var a=r(70700),n=r(96627),o=r(86444);const s=e=>(0,a.x$)(e.x_axis),i=e=>{if(e.granularity_sqla||e.x_axis)return s(e)?e.x_axis:n.Tf},l=e=>{const t=i(e);if(t)return(0,o.A)(t)}},39131:(e,t,r)=>{"use strict";r.d(t,{A:()=>n});var a=r(808);function n(e){const{subject:t}=e;if((0,a.TI)(e)){const{operator:r}=e;return{col:t,op:r}}if((0,a.bo)(e)){const{operator:r}=e;return{col:t,op:r,val:e.comparator}}const{operator:r}=e;return{col:t,op:r,val:e.comparator}}},39197:(e,t,r)=>{"use strict";e.exports=r.p+"loading.cff8a5da.gif"},39472:(e,t,r)=>{"use strict";r.d(t,{E2:()=>l,OB:()=>o,Ob:()=>c,o3:()=>i,yG:()=>s});var a=r(84140);const n=/^rgb\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*\)$/;function o(e,t=186){let r=0,a=0,o=0;if(e.length>7){const t=n.exec(e);if(!t)throw new Error(`Invalid color: ${e}`);r=parseInt(t[1],10),a=parseInt(t[2],10),o=parseInt(t[3],10)}else{let t=e;if(t.startsWith("#")&&(t=t.substring(1)),3===t.length&&(t=[t[0],t[0],t[1],t[1],t[2],t[2]].join("")),6!==t.length)throw new Error(`Invalid color: ${e}`);r=parseInt(t.slice(0,2),16),a=parseInt(t.slice(2,4),16),o=parseInt(t.slice(4,6),16)}return.299*r+.587*a+.114*o>t?"#000":"#FFF"}function s(e,t){const r=[],n=e.map((e=>(0,a.A)(e).analogous(t+3).slice(3)));for(;null!=(o=n[n.length-1])&&o.length;){var o;n.forEach((e=>{const t=e.shift();r.push(t.toHexString())}))}return r}function i(e,t){if(t>1||t<0)throw new Error(`The opacity should between 0 and 1, but got: ${t}`);return`${e}${`0${Math.round(255*t).toString(16).toUpperCase()}`.slice(-2)}`}function l(e){let t="0",r="0",a="0";return 4===e.length?(t=`0x${e[1]}${e[1]}`,r=`0x${e[2]}${e[2]}`,a=`0x${e[3]}${e[3]}`):7===e.length&&(t=`0x${e[1]}${e[2]}`,r=`0x${e[3]}${e[4]}`,a=`0x${e[5]}${e[6]}`),`rgb(${+t}, ${+r}, ${+a})`}function c(e,t,r){let a=e.toString(16),n=t.toString(16),o=r.toString(16);return 1===a.length&&(a=`0${a}`),1===n.length&&(n=`0${n}`),1===o.length&&(o=`0${o}`),`#${a}${n}${o}`}},39829:(e,t,r)=>{"use strict";var a;r.d(t,{AU:()=>a,N0:()=>n,V0:()=>s,lr:()=>o}),function(e){e[e.V1=1]="V1"}(a||(a={}));const n=a.V1;var o;!function(e){e[e.SaveNew=1]="SaveNew",e[e.OverwriteDataset=2]="OverwriteDataset"}(o||(o={}));const s={metrics:[],groupby:[],time_range:"No filter",row_limit:1e3}},42242:(e,t,r)=>{"use strict";r.d(t,{PG:()=>_,ii:()=>h,rq:()=>p,ty:()=>y,z7:()=>f});var a=r(96540),n=r(86963),o=r(32132),s=r(43031),i=r(3247);const l=s.F.injectEndpoints({endpoints:e=>({tables:e.query({providesTags:["Tables"],query:({dbId:e,catalog:t,schema:r,forceRefresh:a})=>({endpoint:`/api/v1/database/${null!=e?e:"undefined"}/tables/`,urlParams:{force:a,schema_name:r?encodeURIComponent(r):"",...t&&{catalog_name:t}},transformResponse:({json:e})=>({options:e.result,hasMore:e.count>e.result.length})}),serializeQueryArgs:({queryArgs:{dbId:e,schema:t}})=>({dbId:e,schema:t})}),tableMetadata:e.query({providesTags:e=>e?[{type:"TableMetadatas",id:e.name},{type:"TableMetadatas",id:"LIST"}]:[{type:"TableMetadatas",id:"LIST"}],query:({dbId:e,catalog:t,schema:r,table:a})=>({endpoint:`/api/v1/database/${e}/table_metadata/${(0,o.zJ)({name:a,catalog:t,schema:r})}`,transformResponse:({json:e})=>e})}),tableExtendedMetadata:e.query({query:({dbId:e,catalog:t,schema:r,table:a})=>({endpoint:`/api/v1/database/${e}/table_metadata/extra/${(0,o.zJ)({name:a,catalog:t,schema:r})}`,transformResponse:({json:e})=>e}),providesTags:(e,t,{table:r})=>[{type:"TableMetadatas",id:r}]})})}),{useLazyTablesQuery:c,useTablesQuery:d,useLazyTableMetadataQuery:u,useLazyTableExtendedMetadataQuery:m,useTableMetadataQuery:p,useTableExtendedMetadataQuery:h,endpoints:_,util:f}=l;function y(e){const{dbId:t,catalog:r,schema:o,onSuccess:s,onError:l}=e||{},u=(0,a.useRef)(!1),{currentData:m,isFetching:p}=(0,i.Ip)({dbId:t,catalog:r||void 0}),h=(0,a.useMemo)((()=>new Set(null==m?void 0:m.map((({value:e})=>e)))),[m]),_=Boolean(t&&o&&!p&&h.has(o)),f=d({dbId:t,catalog:r,schema:o,forceRefresh:!1},{skip:!_}),[y]=c(),E=(0,n.A)(((e,t)=>{null==s||s(e,t)})),g=(0,n.A)((e=>{null==l||l(e)})),T=(0,a.useCallback)((()=>{_&&y({dbId:t,catalog:r,schema:o,forceRefresh:!0}).then((({isSuccess:e,isError:t,data:r,error:a})=>{e&&r&&E(r,!0),t&&g(a)}))}),[t,r,o,_,E,g,y]);return(0,a.useEffect)((()=>{if(u.current){const{requestId:e,isSuccess:t,isError:r,isFetching:a,currentData:n,error:o,originalArgs:s}=f;null!=s&&s.forceRefresh||!e||a||(t&&n&&E(n,!1),r&&g(o))}else u.current=!0}),[f,E,g]),{...f,refetch:T}}},42370:(e,t,r)=>{"use strict";r.d(t,{CE:()=>u,FE:()=>E,Fp:()=>c,Io:()=>y,Kd:()=>h,Ow:()=>_,Uz:()=>d,aO:()=>m,cA:()=>p,ov:()=>f,sH:()=>l});var a=r(95579),n=r(96627),o=r(87903),s=r(79758),i=r(36818);const l=1e5,c={time_range:(0,a.t)("Time Range"),granularity_sqla:(0,a.t)("Time Column"),time_grain_sqla:(0,a.t)("Time Grain"),granularity:(0,a.t)("Time Granularity")},d={[n.Tf]:(0,a.t)("Time")},u={verbose_name:d[n.Tf],column_name:n.Tf,type:"TIMESTAMP",type_generic:o.s.Temporal,description:(0,a.t)("A reference to the [Time] configuration, taking granularity into account")},m={column_name:n.Tf,is_dttm:!0,type:"TIMESTAMP",type_generic:o.s.Temporal},p={[s.g.Aggregate]:(0,a.t)("Aggregate"),[s.g.Raw]:(0,a.t)("Raw records")},h={sort_series_type:i.Mb.Sum,sort_series_ascending:!1},_=[[i.Mb.Name,(0,a.t)("Category name")],[i.Mb.Sum,(0,a.t)("Total value")],[i.Mb.Min,(0,a.t)("Minimum value")],[i.Mb.Max,(0,a.t)("Maximum value")],[i.Mb.Avg,(0,a.t)("Average value")]],f={sort_series_type:i.Mb.Name,sort_series_ascending:!0},y=/\d{4}-\d{2}-\d{2}/g,E="Invalid date"},43031:(e,t,r)=>{"use strict";r.d(t,{F:()=>l});var a=r(58561),n=r.n(a),o=r(93020),s=r(35742),i=r(51436);const l=(0,o.xP)({reducerPath:"queryApi",tagTypes:["Catalogs","Schemas","Tables","DatabaseFunctions","QueryValidations","TableMetadatas","SqlLabInitialState","EditorQueries"],endpoints:()=>({}),baseQuery:({endpoint:e,urlParams:t,transformResponse:r,method:a="GET",parseMethod:o="json",...l},c)=>s.A.request({...l,endpoint:`${e}${t?`?q=${n().encode(t)}`:""}`,method:a,parseMethod:o,signal:c.signal}).then((e=>{var t;return{data:null!=(t=null==r?void 0:r(e))?t:e}})).catch((e=>(0,i.h4)(e).then((t=>({error:{error:(null==t?void 0:t.message)||(null==t?void 0:t.error)||e.statusText,errors:(null==t?void 0:t.errors)||[],status:e.status}})))))})},44407:(e,t,r)=>{"use strict";r.d(t,{A:()=>i});var a=r(578),n=r(81151),o=r(49588);function s({id:e,components:t}){const r=t[e];if(!r)return 0;let a=0;return(r.children||[]).forEach((e=>{const r=t[e]||{};a+=(r.meta||{}).width||0})),a}function i({id:e,component:t,components:r={}}){const l={width:void 0,occupiedWidth:void 0,minimumWidth:void 0},c=t||r[e];return c?(l.width=(c.meta||{}).width,l.occupiedWidth=l.width,c.type===o._8?(l.width=i({id:(0,a.A)({childId:c.id,layout:r}),components:r}).width||n.cV,l.occupiedWidth=s({id:c.id,components:r}),l.minimumWidth=l.occupiedWidth||n.tK):c.type===o.QP?(l.minimumWidth=n.tK,l.occupiedWidth=0,(c.children||[]).forEach((e=>{r[e].type===o._8&&(l.minimumWidth=Math.max(l.minimumWidth,s({id:e,components:r})))}))):c.type!==o.rG&&c.type!==o.xY&&c.type!==o.oT||(l.minimumWidth=n.tK),l):l}},44711:(e,t,r)=>{"use strict";r.d(t,{A:()=>a});const a=class{constructor(e){this.name="TypedRegistry",this.records=void 0,this.records=e}get(e){return this.records[e]}set(e,t){this.records[e]=t}}},45881:(e,t,r)=>{"use strict";r.d(t,{A:()=>s,C:()=>o});var a=r(26415),n=r(52123);function o({filterConfig:e,state:t}){const r={},a={};var n;return e?(e.forEach((e=>{const{id:t}=e;a[t]=e})),r.filters=a):r.filters=null!=(n=null==t?void 0:t.filters)?n:{},r.focusedFilterId=void 0,r}function s(e={filters:{}},t){switch(t.type){case n.n:return{filters:t.data.nativeFilters.filters};case a.Xf:return o({filterConfig:t.filterConfig,state:e});case a.OM:return function(e,t){return{...e,filters:Object.fromEntries(t.map((e=>[e.id,e])))}}(e,t.filterChanges);case a.Y$:return{...e,focusedFilterId:t.id};case a.R4:return{...e,focusedFilterId:void 0};case a.ow:return{...e,hoveredFilterId:t.id};case a.zE:return{...e,hoveredFilterId:void 0};case a.tX:return{...e,filters:{...e.filters,[t.id]:{...e.filters[t.id],cascadeParentIds:t.parentIds}}};default:return e}}},46074:(e,t,r)=>{"use strict";r.d(t,{A:()=>i,o:()=>s});var a=r(95579),n=r(80464),o=r(52123);const s={slices:{},isLoading:!0,errorMessage:null,lastUpdated:0};function i(e=s,t){const r={[o.n]:()=>({...t.data.sliceEntities}),[n.T1]:()=>({...e,isLoading:!0}),[n.ut]:()=>({...e,isLoading:!1,slices:{...e.slices,...t.payload.slices},lastUpdated:(new Date).getTime()}),[n.$G]:()=>({isLoading:!1,slices:{...t.payload.slices},lastUpdated:(new Date).getTime()}),[n.Lj]:()=>({...e,isLoading:!1,lastUpdated:(new Date).getTime(),errorMessage:t.payload.error||(0,a.t)("Could not fetch all saved charts")})};return t.type in r?r[t.type]():e}},46302:(e,t,r)=>{"use strict";r.d(t,{A:()=>l});var a=r(95579),n=r(64389),o=r(86444),s=r(36770),i=r(79758);function l(e,t){const r={metric:"metrics",metric_2:"metrics",secondary_metric:"metrics",x:"metrics",y:"metrics",size:"metrics",all_columns:"columns",series:"groupby",order_by_cols:"orderby",...t},{query_mode:l,...c}=e;let d=[],u=[],m=[];return Object.entries(c).forEach((([e,t])=>{if(null==t)return;let a=r[e]||e;l===i.g.Aggregate&&"columns"===a||(l!==i.g.Raw||"groupby"!==a&&"metrics"!==a)&&("groupby"===a&&(a="columns"),"metrics"===a?u=u.concat(t):"columns"===a?d=d.concat(t):"orderby"===a&&(m=m.concat(t)))})),{columns:(0,n.A)(d.filter((e=>""!==e)),o.A),metrics:l===i.g.Raw?void 0:(0,n.A)(u,s.A),orderby:m.length>0?m.map((e=>{if("string"==typeof e)try{return JSON.parse(e)}catch(e){throw new Error((0,a.t)("Found invalid orderby options"))}return e})):void 0}}},46920:(e,t,r)=>{"use strict";r.d(t,{A:()=>p});var a=r(17437),n=r(96540),o=r(31357),s=r(46942),i=r.n(s),l=r(67303),c=r(96453),d=r(19129),u=r(2445);const m=e=>({primary:"primary",danger:"primary",warning:"primary",success:"primary",secondary:"default",default:"default",tertiary:"default",dashed:"dashed",link:"link"}[e]);function p(e){const{tooltip:t,placement:r,disabled:s=!1,buttonSize:p,buttonStyle:h,className:_,cta:f,children:y,href:E,showMarginRight:g=!0,...T}=e,A=(0,c.DP)(),{colors:b,transitionTiming:S,borderRadius:v,typography:R}=A,{primary:I,grayscale:O,success:C,warning:D}=b;let w,L,N,q=32,x=18;"xsmall"===p?(q=22,x=5):"small"===p&&(q=30,x=10);let U,P,M,F,k=O.light2,Y=0,Q="none",B="transparent";"tertiary"===h||"dashed"===h?(w=O.light5,L=O.light5,N=O.light5,k=O.light5,Y=1,Q="dashed"===h?"dashed":"solid",M=I.dark1,F=I.light1,B=O.light2):"danger"===h?P=U:"warning"===h?(w=D.base,L=(0,o.jh)(.1,O.dark2,D.base),N=(0,o.jh)(.2,O.dark2,D.base),U=O.light5,P=U):"success"===h?(w=C.base,L=(0,o.jh)(.1,O.light5,C.base),N=(0,o.jh)(.2,O.dark2,C.base),U=O.light5,P=U):"link"===h&&(w="transparent",L="transparent",N="transparent",U=I.dark1);const H=y;let j=[];j=H&&H.type===n.Fragment?n.Children.toArray(H.props.children):n.Children.toArray(y);const $=g&&j.length>1?2*A.gridUnit:0,G=null!=h?h:"default",V=(0,u.Y)(l.Ay,{href:s?void 0:E,disabled:s,type:m(G),danger:"danger"===G,className:i()(_,"superset-button",`superset-button-${h}`,{cta:!!f}),css:(0,a.AH)({display:"inline-flex",alignItems:"center",justifyContent:"center",lineHeight:1.5715,fontSize:R.sizes.s,fontWeight:R.weights.bold,height:q,padding:`0px ${x}px`,transition:`all ${S}s`,minWidth:f?36*A.gridUnit:void 0,minHeight:f?8*A.gridUnit:void 0,boxShadow:"none",borderWidth:Y,borderStyle:Q,borderColor:M,borderRadius:v,color:U,background:w,...P||L||F?{[`&.superset-button.superset-button-${h}:hover`]:{...P&&{color:P},...L&&{background:L},...F&&{borderColor:F}}}:{},"&:active":{color:U,backgroundColor:N},"&:focus":{color:U,backgroundColor:w,borderColor:M},"&[disabled], &[disabled]:hover":{color:O.base,backgroundColor:"link"===h?"transparent":k,borderColor:"link"===h?"transparent":B,pointerEvents:"none"},marginLeft:0,"& + .superset-button":{marginLeft:2*A.gridUnit},"& > span > :first-of-type":{marginRight:$}},"",""),...T,children:y});return t?(0,u.Y)(d.m_,{placement:r,title:t,children:s?(0,u.Y)("span",{css:(0,a.AH)({cursor:"not-allowed","& > .superset-button":{marginLeft:2*A.gridUnit}},"",""),children:V}):V}):V}},47472:(e,t,r)=>{"use strict";r.d(t,{V:()=>i});var a=r(95579),n=r(66537),o=r(97689),s=r(2445);function i({name:e,description:t,label:r,tooltipOnClick:i,onClick:l,warning:c,danger:d,leftNode:u,rightNode:m,validationErrors:p=[],renderTrigger:h=!1,hovered:_=!1,required:f=!1}){if(!r)return null;const y=p.length>0?"text-danger":"";return(0,s.FD)("div",{className:"ControlHeader",children:[(0,s.Y)("div",{className:"pull-left",children:(0,s.FD)("label",{className:"control-label",htmlFor:e,children:[u&&(0,s.Y)("span",{children:u}),(0,s.Y)("span",{role:"button",tabIndex:0,onClick:l,className:y,style:{cursor:l?"pointer":""},children:r})," ",c&&(0,s.FD)("span",{children:[(0,s.Y)(o.m,{id:"error-tooltip",placement:"top",title:c,children:(0,s.Y)("i",{className:"fa fa-exclamation-circle text-warning"})})," "]}),d&&(0,s.FD)("span",{children:[(0,s.Y)(o.m,{id:"error-tooltip",placement:"top",title:d,children:(0,s.Y)("i",{className:"fa fa-exclamation-circle text-danger"})})," "]}),p.length>0&&(0,s.FD)("span",{children:[(0,s.Y)(o.m,{id:"error-tooltip",placement:"top",title:p.join(" "),children:(0,s.Y)("i",{className:"fa fa-exclamation-circle text-danger"})})," "]}),_?(0,s.FD)("span",{children:[t&&(0,s.FD)("span",{children:[(0,s.Y)(n.W,{label:(0,a.t)("description"),tooltip:t,placement:"top",onClick:i})," "]}),h&&(0,s.FD)("span",{children:[(0,s.Y)(n.W,{label:(0,a.t)("bolt"),tooltip:(0,a.t)("Changing this control takes effect instantly"),placement:"top",icon:"bolt"})," "]})]}):null,f&&(0,s.Y)("span",{className:"text-danger m-l-4",children:(0,s.Y)("strong",{children:"*"})})]})}),m&&(0,s.Y)("div",{className:"pull-right",children:m}),(0,s.Y)("div",{className:"clearfix"})]})}},48285:(e,t,r)=>{"use strict";r.d(t,{Ff:()=>c,Iw:()=>p,KP:()=>_,PD:()=>d,_M:()=>l,iI:()=>m,ll:()=>f,n7:()=>u,rP:()=>h,tS:()=>y});var a=r(93505),n=r(95579),o=r(51436),s=r(95272),i=r(72173);const l="DASHBOARD_INFO_UPDATED",c="DASHBOARD_INFO_FILTERS_CHANGED";function d(e){return{type:l,newInfo:e}}function u(e){return{type:c,newInfo:e}}const m="SAVE_CHART_CONFIG_COMPLETE",p=({chartConfiguration:e,globalChartConfiguration:t})=>async(r,o)=>{r({type:"SAVE_CHART_CONFIG_BEGIN",chartConfiguration:e,globalChartConfiguration:t});const{id:i,metadata:l}=o().dashboardInfo,c=(0,a.A)({method:"PUT",endpoint:`/api/v1/dashboard/${i}`});try{const a=await c({json_metadata:JSON.stringify({...l,chart_configuration:null!=e?e:l.chart_configuration,global_chart_configuration:null!=t?t:l.global_chart_configuration})});r(d({metadata:JSON.parse(a.result.json_metadata)})),r({type:m,chartConfiguration:e,globalChartConfiguration:t})}catch(a){r({type:"SAVE_CHART_CONFIG_FAIL",chartConfiguration:e,globalChartConfiguration:t}),r((0,s.iB)((0,n.t)("Failed to save cross-filter scoping")))}},h="SET_FILTER_BAR_ORIENTATION",_="SET_CROSS_FILTERS_ENABLED";function f(e){return async(t,r)=>{const{id:n,metadata:l}=r().dashboardInfo,c=(0,a.A)({method:"PUT",endpoint:`/api/v1/dashboard/${n}`});try{const r=await c({json_metadata:JSON.stringify({...l,filter_bar_orientation:e})}),a=r.result,n=r.last_modified_time;if(a.json_metadata){const e=JSON.parse(a.json_metadata);e.filter_bar_orientation&&t((d=e.filter_bar_orientation,{type:h,filterBarOrientation:d}))}n&&t((0,i.t_)(n))}catch(e){const r=await(0,o.ER)(e,"dashboard");throw t((0,s.iB)(r)),e}var d}}function y(e){return async(t,r)=>{const{id:n,metadata:l}=r().dashboardInfo,c=(0,a.A)({method:"PUT",endpoint:`/api/v1/dashboard/${n}`});try{const r=await c({json_metadata:JSON.stringify({...l,cross_filters_enabled:e})}),a=r.result,n=r.last_modified_time;a.json_metadata&&t(function(e){return{type:_,crossFiltersEnabled:e}}(JSON.parse(a.json_metadata).cross_filters_enabled)),n&&t((0,i.t_)(n))}catch(e){const r=await(0,o.ER)(e,"dashboard");throw t((0,s.iB)(r)),e}}}},48822:(e,t,r)=>{"use strict";var a,n;r.d(t,{AA:()=>a,Ay:()=>o,g1:()=>n}),function(e){e.Mean="mean",e.Sum="sum",e.Std="std",e.Cumsum="cumsum"}(a||(a={})),function(e){e.Values="values",e.Difference="difference",e.Percentage="percentage",e.Ratio="ratio"}(n||(n={}));const o={}},49588:(e,t,r)=>{"use strict";r.d(t,{$9:()=>s,Ay:()=>f,B8:()=>h,KR:()=>o,PP:()=>c,QP:()=>n,_8:()=>m,cP:()=>u,n6:()=>l,oT:()=>a,rG:()=>_,tq:()=>i,wc:()=>p,xY:()=>d});const a="CHART",n="COLUMN",o="HEADER",s="GRID",i="ROOT",l="DIVIDER",c="HEADER",d="MARKDOWN",u="NEW_COMPONENT_SOURCE",m="ROW",p="TABS",h="TAB",_="DYNAMIC",f={CHART_TYPE:a,COLUMN_TYPE:n,DASHBOARD_HEADER_TYPE:o,DASHBOARD_GRID_TYPE:s,DASHBOARD_ROOT_TYPE:i,DIVIDER_TYPE:l,HEADER_TYPE:c,MARKDOWN_TYPE:d,NEW_COMPONENT_SOURCE_TYPE:u,ROW_TYPE:m,TABS_TYPE:p,TAB_TYPE:h,DYNAMIC_TYPE:_}},49953:(e,t,r)=>{"use strict";r.d(t,{A:()=>n});var a=r(95579);function n(e){return!(!e||!Number.isNaN(Number(e))&&parseInt(e,10)===Number(e))&&(0,a.t)("is expected to be an integer")}},51436:(e,t,r)=>{"use strict";r.d(t,{A8:()=>c,ER:()=>h,bY:()=>l,ei:()=>u,h4:()=>p,hi:()=>_,io:()=>m,q2:()=>d});var a=r(58642),n=r(95579),o=r(1639),s=r(69108);const i={400:"Bad request",401:"Unauthorized",402:"Payment required",403:"Forbidden",404:"Not found",405:"Method not allowed",406:"Not acceptable",407:"Proxy authentication required",408:"Request timeout",409:"Conflict",410:"Gone",411:"Length required",412:"Precondition failed",413:"Payload too large",414:"URI too long",415:"Unsupported media type",416:"Range not satisfiable",417:"Expectation failed",418:"I'm a teapot",500:"Server error",501:"Not implemented",502:"Bad gateway",503:"Service unavailable",504:"Gateway timeout",505:"HTTP version not supported",506:"Variant also negotiates",507:"Insufficient storage",508:"Loop detected",510:"Not extended",511:"Network authentication required",599:"Network error"};function l(e){return!(0,a.Eo)(e)&&(0,a.fE)(e)}function c(e){if(l(e)){for(const[t,r]of Object.entries(i))if(new RegExp(`${t}|${r}`,"i").test(e))return(0,n.t)(r);return(0,n.t)("Unknown error")}return e}function d(e){return i[e]||null}function u(e,t){return("status"in t?d(t.status):null)||c(e)}function m(e){let t={...e};var r,a,s;(t.errors&&t.errors.length>0&&(t.error=t.description=t.errors[0].message,t.link=null==(r=t.errors[0])||null==(a=r.extra)?void 0:a.link),!t.error&&t.message)&&("object"==typeof t.message&&(t.error=(null==(s=Object.values(t.message)[0])?void 0:s[0])||(0,n.t)("Invalid input")),"string"==typeof t.message&&(l(t.message)?t.error=u(t.message,t):t.error=t.message));return t.stack?t={...t,error:(0,n.t)("Unexpected error: ")+(t.description||(0,n.t)("(no description, click to see stack trace)")),stacktrace:t.stack}:t.responseText&&t.responseText.indexOf("CSRF")>=0&&(t={...t,error:(0,n.t)(o.HL.SESSION_TIMED_OUT)}),{...t,error:t.error}}function p(e){return new Promise((t=>{if("string"==typeof e)return void t({error:c(e)});if(e instanceof TypeError&&"Failed to fetch"===e.message)return void t({error:(0,n.t)("Network error")});if("timeout"in e&&"statusText"in e&&"timeout"===e.statusText)return void t({...e,error:(0,n.t)("Request timed out"),errors:[{error_type:s.eK.FRONTEND_TIMEOUT_ERROR,extra:{timeout:e.timeout/1e3,issue_codes:[{code:1e3,message:(0,n.t)("Issue 1000 - The dataset is too large to query.")},{code:1001,message:(0,n.t)("Issue 1001 - The database is under an unusual load.")}]},level:"error",message:"Request timed out"}]});const r=e instanceof Response?e:e.response;if(r&&!r.bodyUsed)return void r.clone().json().then((e=>{const{url:a,status:n,statusText:o,redirected:s,type:i}=r,l={...e,url:a,status:n,statusText:o,redirected:s,type:i};t(m(l))})).catch((()=>{r.text().then((e=>{t({...r,error:u(e,r)})}))}));let a=e.statusText||e.message;a||(console.error("non-standard error:",e),a=(0,n.t)("An error occurred")),t({...r,error:c(a)})}))}async function h(e,t){const{error:r,message:a}=await p(e);let o=(0,n.t)("Sorry, an unknown error occurred.");return r&&(o=(0,n.t)("Sorry, there was an error saving this %s: %s",t,r)),"string"==typeof a&&"Forbidden"===a&&(o=(0,n.t)("You do not have permission to edit this %s",t)),o}function _(e,t){let r=e;const a=(null==t?void 0:t.message)||(null==t?void 0:t.error);return a&&(r=`${r}:\n${a}`),r}},52123:(e,t,r)=>{"use strict";r.d(t,{n:()=>A,M:()=>b});var a=r(68458),n=r(46074),o=r(45881),s=r(91715),i=r(68921),l=r(84666),c=r(65256),d=r(83255),u=r(81151),m=r(49588),p=r(37725),h=r(72619),_=r(27023),f=r(32132),y=r(86274),E=r(88488),g=r(54193),T=r(10504);const A="HYDRATE_DASHBOARD",b=({history:e,dashboard:t,charts:r,dataMask:b,activeTabs:S})=>(v,R)=>{const{user:I,common:O,dashboardState:C}=R(),{metadata:D,position_data:w}=t,L=(0,E.A)("regular"),N="true"===(0,E.A)("reserved").edit;r.forEach((e=>{e.slice_id=e.form_data.slice_id}));const q=w&&Object.keys(w).length>0?w:{[u.CW]:"v2",[u.wv]:{type:m.tq,id:u.wv,children:[u.mK]},[u.mK]:{type:m.$9,id:u.mK,children:[],parents:[u.wv]}},x={};Object.values(q).forEach((e=>{e.type===m.oT&&(x[e.meta.chartId]=e.id)}));const U=function(e={}){let t=e[u.wv];return t=t&&t.children.length&&e[t.children[0]].type===m.wc?e[e[t.children[0]].children[0]]:e[t.children[0]],t.id}(q),P=q[U];let M,F=0;const k={},Y={},Q={},B=new Set,H=new Map;r.forEach((e=>{const t=e.slice_id,r={...e.form_data,url_params:{...e.form_data.url_params,...L}};if(k[t]={...a.b,id:t,form_data:(0,s.S7)(r)},Q[t]={slice_id:t,slice_url:e.slice_url,slice_name:e.slice_name,form_data:e.form_data,viz_type:e.form_data.viz_type,datasource:e.form_data.datasource,description:e.description,description_markeddown:e.description_markeddown,owners:e.owners,modified:e.modified,changed_on:new Date(e.changed_on).getTime()},B.add(t),!x[t]&&q[U]){var n;(0===F||F+u.nm>u.cV)&&(M=(0,h.A)(m._8,(P.parents||[]).slice()),q[M.id]=M,P.children.push(M.id),F=0);const t=(0,h.A)(m.oT,{chartId:e.slice_id},(M.parents||[]).slice()),r=(null!=(n=H.get(e.slice_id))?n:0)+1;t.id=`${m.oT}-explore-${e.slice_id}-${r}`,H.set(e.slice_id,r),q[t.id]=t,M.children.push(t.id),x[t.meta.chartId]=t.id,F+=u.nm}const o=x[t];o&&q[o]&&(q[o].meta.sliceName=e.slice_name)})),Object.values(q).some((e=>e.id!==u.wv&&!e.parents))&&(0,g.A)({currentComponent:q[u.wv],layout:q}),(0,i.kl)({dashboardFilters:Y,components:q}),q[u.XY]={id:u.XY,type:m.KR,meta:{text:t.dashboard_title}};const j={past:[],present:q,future:[]},$=(0,f.P3)(_.vX.dashboardFocusedChart);let G;if($){const t=Object.values(j.present).find((e=>{var t;return(null==(t=e.meta)?void 0:t.chartId)===$}));G=null==t?void 0:t.id;const r=new URLSearchParams(window.location.search);r.delete(_.vX.dashboardFocusedChart.name),e.replace({search:r.toString()})}const V=G||(0,p.A)();let z=C.directPathToChild||[];q[V]&&(z=(q[V].parents||[]).slice(),z.push(V));const W=(0,o.C)({filterConfig:(null==D?void 0:D.native_filter_configuration)||[]}),{chartConfiguration:K,globalChartConfiguration:X}=(0,d.k)(j.present,D,k);D.chart_configuration=K,D.global_chart_configuration=X;const{roles:J}=I,Z=(0,c.m9)(t,I),ee=(0,d.b)(D.cross_filters_enabled);return v({type:A,data:{sliceEntities:{...n.o,slices:Q,isLoading:!1},charts:k,dashboardInfo:{...t,metadata:D,userId:I.userId?String(I.userId):null,dash_edit_perm:Z,dash_save_perm:(0,c.bD)(t,I),dash_share_perm:(0,l.L)("can_share_dashboard","Superset",J),superset_can_explore:(0,l.L)("can_explore","Superset",J),superset_can_share:(0,l.L)("can_share_chart","Superset",J),superset_can_csv:(0,l.L)("can_csv","Superset",J),common:{flash_messages:null==O?void 0:O.flash_messages,conf:null==O?void 0:O.conf},filterBarOrientation:D.filter_bar_orientation||T.QI.Vertical,crossFiltersEnabled:ee},dataMask:b,dashboardFilters:Y,nativeFilters:W,dashboardState:{preselectNativeFilters:(0,f.P3)(_.vX.nativeFilters),sliceIds:Array.from(B),directPathToChild:z,directPathLastUpdated:Date.now(),focusedFilterField:null,expandedSlices:(null==D?void 0:D.expanded_slices)||{},refreshFrequency:(null==D?void 0:D.refresh_frequency)||0,shouldPersistRefreshFrequency:!1,css:t.css||"",colorNamespace:(null==D?void 0:D.color_namespace)||null,colorScheme:(null==D?void 0:D.color_scheme)||null,editMode:Z&&N,isPublished:t.published,hasUnsavedChanges:!1,dashboardIsSaving:!1,maxUndoHistoryExceeded:!1,lastModifiedTime:t.changed_on,isRefreshing:!1,isFiltersRefreshing:!1,activeTabs:S||(null==C?void 0:C.activeTabs)||[],datasetsStatus:(null==C?void 0:C.datasetsStatus)||y.bk.Loading},dashboardLayout:j}})}},54193:(e,t,r)=>{"use strict";r.d(t,{A:()=>n});var a=r(5362);function n({currentComponent:e,layout:t={}}){if(e&&t)if(t[e.id]){const r=Array.isArray(e.parents)?e.parents.slice():[];r.push(e.id),Array.isArray(e.children)&&e.children.forEach((e=>{t[e]?(t[e]={...t[e],parents:r},n({currentComponent:t[e],layout:t})):a.A.warn(`The current layout does not contain a component with the id: ${e}.  Skipping this component`)}))}else a.A.warn(`The current layout does not contain a component with the id: ${null==e?void 0:e.id}.  Skipping this component`)}},54797:(e,t,r)=>{"use strict";r.d(t,{A:()=>$});var a=r(62193),n=r.n(a),o=r(76968),s=r(69161),i=r(95579),l=r(13270),c=r(96627),d=r(49953),u=r(99947),m=r(48822),p=r(62952),h=r(14304),_=r(98229),f=r(88631),y=r(94071),E=r(42370),g=r(34342);const T=(0,o.A)(),A=(0,s.A)(),b=[5,10,25,50,100,500],S=document.getElementById("app"),{user:v}=JSON.parse((null==S?void 0:S.getAttribute("data-bootstrap"))||"{}"),R={type:"DatasourceControl",label:(0,i.t)("Datasource"),default:null,description:null,mapStateToProps:({datasource:e,form_data:t})=>({datasource:e,form_data:t,user:v})},I={type:"VizTypeControl",label:(0,i.t)("Visualization Type"),default:"table",description:(0,i.t)("The type of visualization to display")},O={type:"ColorPickerControl",label:(0,i.t)("Fixed Color"),description:(0,i.t)("Use this to define a static color for all circles"),default:{r:0,g:122,b:135,a:1},renderTrigger:!0},C={type:"ColorSchemeControl",label:(0,i.t)("Linear Color Scheme"),choices:()=>A.values().map((e=>[e.id,e.label])),default:A.getDefaultKey(),clearable:!1,description:"",renderTrigger:!0,schemes:()=>A.getMap(),isLinear:!0,mapStateToProps:e=>(0,h.c)(e)},D={type:"SelectControl",freeForm:!0,label:E.Fp.granularity,default:"one day",choices:[[null,(0,i.t)("all")],["PT5S",(0,i.t)("5 seconds")],["PT30S",(0,i.t)("30 seconds")],["PT1M",(0,i.t)("1 minute")],["PT5M",(0,i.t)("5 minutes")],["PT30M",(0,i.t)("30 minutes")],["PT1H",(0,i.t)("1 hour")],["PT6H",(0,i.t)("6 hour")],["P1D",(0,i.t)("1 day")],["P7D",(0,i.t)("7 days")],["P1W",(0,i.t)("week")],["week_starting_sunday",(0,i.t)("week starting Sunday")],["week_ending_saturday",(0,i.t)("week ending Saturday")],["P1M",(0,i.t)("month")],["P3M",(0,i.t)("quarter")],["P1Y",(0,i.t)("year")]],description:(0,i.t)("The time granularity for the visualization. Note that you can type and use simple natural language as in `10 seconds`, `1 day` or `56 weeks`")},w={type:"SelectControl",label:E.Fp.time_grain_sqla,placeholder:(0,i.t)("None"),initialValue:(e,t)=>{var r,a;return(0,l.A)(t)?null!=t&&t.metadata||"time_grain_sqla"in(null!=(r=null==t?void 0:t.form_data)?r:{})?null==t||null==(a=t.form_data)?void 0:a.time_grain_sqla:"P1D":e.value},description:(0,i.t)("Select a time grain for the visualization. The grain is the time interval represented by a single point on the chart."),mapStateToProps:({datasource:e})=>({choices:(null==e?void 0:e.time_grain_sqla)||[]}),visibility:_.z},L={type:"DateFilterControl",freeForm:!0,label:E.Fp.time_range,default:c.WC,description:(0,i.t)('This control filters the whole chart based on the selected time range. All relative times, e.g. "Last month", "Last 7 days", "now", etc. are evaluated on the server using the server\'s local time (sans timezone). All tooltips and placeholder times are expressed in UTC (sans timezone). The timestamps are then evaluated by the database using the engine\'s local timezone. Note one can explicitly set the timezone per the ISO 8601 format if specifying either the start and/or end time.')},N={type:"SelectControl",freeForm:!0,label:(0,i.t)("Row limit"),clearable:!1,mapStateToProps:e=>{var t,r;return{maxValue:null==e||null==(t=e.common)||null==(r=t.conf)?void 0:r.SQL_MAX_ROW}},validators:[d.A,(e,t)=>(0,u.A)(e,(null==t?void 0:t.maxValue)||E.sH)],default:1e4,choices:(0,f.u)([10,50,100,250,500,1e3,5e3,1e4,5e4]),description:(0,i.t)("Limits the number of the rows that are computed in the query that is the source of the data used for this chart.")},q={type:"CheckboxControl",label:(0,i.t)("Sort Descending"),default:!0,description:(0,i.t)("If enabled, this control sorts the results/values descending, otherwise it sorts the results ascending."),visibility:({controls:e})=>Boolean((null==e?void 0:e.timeseries_limit_metric.value)&&!n()(null==e?void 0:e.timeseries_limit_metric.value))},x={type:"SelectControl",freeForm:!0,label:(0,i.t)("Series limit"),placeholder:(0,i.t)("None"),validators:[d.A],choices:(0,f.u)(b),clearable:!0,description:(0,i.t)("Limits the number of series that get displayed. A joined subquery (or an extra phase where subqueries are not supported) is applied to limit the number of series that get fetched and rendered. This feature is useful when grouping by high cardinality column(s) though does increase the query complexity and cost.")},U={type:"SelectControl",freeForm:!0,label:(0,i.t)("Series limit"),placeholder:(0,i.t)("None"),validators:[d.A],choices:(0,f.u)(b),description:(0,i.t)("Limits the number of series that get displayed. A joined subquery (or an extra phase where subqueries are not supported) is applied to limit the number of series that get fetched and rendered. This feature is useful when grouping by high cardinality column(s) though does increase the query complexity and cost.")},P={type:"SelectControl",freeForm:!0,label:(0,i.t)("Y Axis Format"),renderTrigger:!0,default:y.KY,choices:y.Bb,description:y.YH,tokenSeparators:["\n","\t",";"],filterOption:({data:e},t)=>e.label.includes(t)||e.value.includes(t),mapStateToProps:e=>{var t,r;return{choices:(null==(t=e.controls)||null==(r=t.comparison_type)?void 0:r.value)===m.g1.Percentage?y.Bb.filter((e=>e[0].includes("%"))):y.Bb}}},M={type:"CurrencyControl",label:(0,i.t)("Currency format"),renderTrigger:!0},F={type:"SelectControl",freeForm:!0,label:(0,i.t)("Time format"),renderTrigger:!0,default:y.EN,choices:y.lR,description:y.gb,filterOption:({data:e},t)=>e.label.includes(t)||e.value.includes(t)},k={type:"ColorSchemeControl",label:(0,i.t)("Color Scheme"),default:T.getDefaultKey(),renderTrigger:!0,choices:()=>T.keys().map((e=>[e,e])),description:(0,i.t)("The color scheme for rendering chart"),schemes:()=>T.getMap(),mapStateToProps:e=>(0,h.c)(e)},Y={type:"CheckboxControl",label:(0,i.t)("Match time shift color with original series"),default:!0,renderTrigger:!0,description:(0,i.t)("When unchecked, colors from the selected color scheme will be used for time shifted series"),visibility:({controls:e})=>{var t,r;return Boolean((null==e||null==(t=e.time_compare)?void 0:t.value)&&!n()(null==e||null==(r=e.time_compare)?void 0:r.value))}},Q={type:"CheckboxControl",label:(0,i.t)("Truncate Metric"),default:!0,description:(0,i.t)("Whether to truncate metrics")},B={type:"CheckboxControl",label:(0,i.t)("Show empty columns"),default:!0,description:(0,i.t)("Show empty columns")},H={type:"HiddenControl",initialValue:(e,t)=>{var r;return Object.fromEntries((0,p.A)(null==t||null==(r=t.datasource)?void 0:r.columns).filter((e=>e.is_dttm)).map((e=>{var t;return[null!=(t=e.column_name)?t:e.name,e.is_dttm]})))}},j={type:"CheckboxControl",label:(0,i.t)("Sort by metric"),description:(0,i.t)("Whether to sort results by the selected metric in descending order.")},$={metrics:g.em,metric:g.jc,datasource:R,viz_type:I,color_picker:O,metric_2:g.xX,linear_color_scheme:C,secondary_metric:g.I2,groupby:g.Eg,columns:g.XL,granularity:D,granularity_sqla:g.H7,time_grain_sqla:w,time_range:L,row_limit:N,limit:x,timeseries_limit_metric:g.fj,orderby:g.fj,order_desc:q,series:g.HF,entity:g.ht,x:g.A7,y:g.R2,size:g.X5,y_axis_format:P,x_axis_time_format:F,adhoc_filters:g.zz,color_scheme:k,time_shift_color:Y,series_columns:g.XL,series_limit:U,series_limit_metric:g.fj,legacy_order_by:g.fj,truncate_metric:Q,x_axis:g.z,show_empty_columns:B,temporal_columns_lookup:H,currency_format:M,sort_by_metric:j}},55045:(e,t,r)=>{"use strict";r.d(t,{A:()=>s});var a=r(95579),n=r(39829);function o(e){return e.reduce(((e,t)=>e.slice(-1)[0]===t?e:e.concat(t)),[])}function s({common:e,active_tab:t,tab_state_ids:r=[],databases:s,queries:i,...l}){let c={};const d={version:n.N0,loaded:!0,name:(0,a.t)("Untitled query"),sql:"",latestQueryId:null,autorun:!1,dbId:e.conf.SQLLAB_DEFAULT_DBID,queryLimit:e.conf.DEFAULT_SQLLAB_LIMIT,hideLeftBar:!1,remoteId:null,cursorPosition:{row:0,column:0}};let u={};r.forEach((({id:e,label:r})=>{let a;var o,s,i,l;a=t&&t.id===e?{version:null!=(o=null==(s=t.extra_json)?void 0:s.version)?o:n.AU.V1,id:e.toString(),loaded:!0,name:t.label,sql:t.sql||"",selectedText:void 0,latestQueryId:t.latest_query?t.latest_query.id:null,remoteId:(null==(i=t.saved_query)?void 0:i.id)||null,autorun:Boolean(t.autorun),templateParams:t.template_params||void 0,dbId:t.database_id,catalog:t.catalog,schema:t.schema,queryLimit:t.query_limit,hideLeftBar:t.hide_left_bar,updatedAt:null==(l=t.extra_json)?void 0:l.updatedAt}:{...d,id:e.toString(),loaded:!1,name:r,dbId:void 0},c={...c,[a.id]:a}}));const m=t?[t.id.toString()]:[];let p=t?t.id.toString():"",h={},_=Date.now();var f;t&&(_=(null==(f=t.extra_json)?void 0:f.updatedAt)||_,t.table_schemas.filter((e=>null!==e.description)).forEach((e=>{var t;const{dataPreviewQueryId:r,...a}=e.description,n={dbId:null!=(t=e.database_id)?t:0,queryEditorId:e.tab_state_id.toString(),catalog:e.catalog,schema:e.schema,name:e.table,expanded:Boolean(e.expanded),id:e.id,dataPreviewQueryId:r,persistData:a,initialized:!0};h={...h,[n.id]:n}})));const y={...i,...(null==t?void 0:t.latest_query)&&{[t.latest_query.id]:t.latest_query}},E={};try{const e=localStorage.getItem("redux"),t=e?JSON.parse(e):void 0;if(e&&null!=t&&t.sqlLab){const{sqlLab:e}=t;if(0===e.queryEditors.length)localStorage.removeItem("redux");else{u=e.unsavedQueryEditor||u,e.queryEditors.forEach((e=>{var t,r;const a=Boolean(c[e.id]),n=null==(t=c[e.id])?void 0:t.updatedAt,o=e.updatedAt&&(!n||e.updatedAt>n),s=!a||o?e:{};c={...c,[e.id]:{...c[e.id],...s,name:s.title||s.name||(null==(r=c[e.id])?void 0:r.name),...s.id&&u.id===e.id&&u,inLocalStorage:!a,loaded:!0}}}));const t=new Set;e.tables&&(h=e.tables.reduce(((e,r)=>{const a=!t.has(r.queryEditorId);return a&&t.add(r.queryEditorId),{...e,[r.id]:{...h[r.id],...r,expanded:a,inLocalStorage:!0}}}),h)),e.queries&&Object.values(e.queries).forEach((e=>{y[e.id]={...e,inLocalStorage:!0}})),e.tabHistory&&m.push(...e.tabHistory),p=m.slice(m.length-1)[0]||"",e.destroyedQueryEditors&&Object.entries(e.destroyedQueryEditors).forEach((([e,t])=>{c[e]&&(E[e]=t,delete c[e])}))}}}catch(e){}return{sqlLab:{activeSouthPaneTab:"Results",alerts:[],databases:s,offline:!1,queries:Object.fromEntries(Object.entries(y).map((([e,t])=>[e,{...t,...t.startDttm&&{startDttm:Number(t.startDttm)},...t.endDttm&&{endDttm:Number(t.endDttm)}}]))),queryEditors:Object.values(c),tabHistory:o(m),tables:Object.values(h),queriesLastUpdate:Date.now(),editorTabLastUpdatedAt:_,queryCostEstimates:{},unsavedQueryEditor:u,lastUpdatedActiveTab:p,destroyedQueryEditors:E},localStorageUsageInKilobytes:0,common:e,...l}}},55556:(e,t,r)=>{"use strict";r.d(t,{D2:()=>S,Hq:()=>g,Ky:()=>b,Z6:()=>_,bp:()=>T,ik:()=>f,pb:()=>A,t7:()=>y,xV:()=>E});var a=r(44383),n=r.n(a),o=r(90179),s=r.n(o),i=r(5287),l=r.n(i),c=r(7148),d=r(62952),u=r(76968),m=r(94963),p=r(35839);const h=[],_=e=>e||void 0,f=e=>Array.isArray(e)?e:h,y=(e=[])=>{const{chartsLabelsMap:t}=(0,c.Ay)(),r=Array.from(t.values()).flatMap((({labels:e})=>e)),a=Array.from(r.reduce(((e,t)=>e.set(t,(e.get(t)||0)+1)),new Map)).filter((([,e])=>e>1)).map((([e])=>e));return Array.from(new Set([...(0,d.A)(e),...a]))},E=(e={})=>{const t=(0,c.Ay)(),r=Object.fromEntries(t.getColorMap());return Object.keys(e).forEach((e=>{delete r[e]})),r},g=(e,t={})=>s()(e,Object.keys(t)),T=e=>{var t;return(null==(t=(0,u.A)().get(e))?void 0:t.colors)||[]},A=(e,t,r)=>{if(!Object.keys(t).length)return!0;const a=l()(Object.keys(e),Object.keys(t)),o=n()(e,a),s=n()(t,a);return(0,p.r$)(o,s,{ignoreFields:Object.keys(r)})},b=e=>{const t=(0,c.Ay)();m.getNamespace(_(e)).resetColors(),t.reset()},S=(e,t=!1,r=!1,a=!1)=>{const n=_(null==e?void 0:e.color_namespace),o=m.getNamespace(n),s=null==e?void 0:e.color_scheme,i=(null==e?void 0:e.map_label_colors)||{},l=f(null==e?void 0:e.shared_label_colors),d=(null==e?void 0:e.label_colors)||{},u=((e,t)=>Object.fromEntries(Object.entries(e).filter((([e])=>t.includes(e)))))(i,l);t&&!Array.isArray(t)&&o.resetColors(),t&&Array.isArray(t)&&o.resetColorsForLabels(t),(t||r)&&((e,t,r=!1)=>{const a=_(e),n=m.getNamespace(a);(0,c.Ay)().updateColorMap(n,t,r)})(null==e?void 0:e.color_namespace,s,r);let p=i;t&&(p={...E(d)}),r&&(p={...i,...E(d)}),a&&(p=u),p={...p,...d},p&&Object.keys(p).forEach((e=>{o.setColor(e,p[e])}))}},56091:(e,t,r)=>{"use strict";r.d(t,{A:()=>l,Z:()=>i});var a=r(1932),n=r(58919),o=r(52123),s=r(95004);r(35839);function i(e,t={}){return{...void 0!==e?{id:e}:{},extraFormData:{},filterState:{},ownState:{},...t}}const l=(0,a.jM)(((e,t)=>{var r,a,l,c,d;const u={};switch(t.type){case s.aJ:return u;case s.Ak:return e[t.filterId]={...i(t.filterId),...e[t.filterId],...t.dataMask},e;case o.n:return Object.keys(null==(r=t.data.dashboardInfo)||null==(a=r.metadata)?void 0:a.chart_configuration).forEach((e=>{u[e]={...i(e)}})),m=null!=(l=null==(c=t.data.dashboardInfo)||null==(d=c.metadata)?void 0:d.native_filter_configuration)?l:[],p=u,h=e,_=t.data.dataMask,m.forEach((e=>{const t=_||{};p[e.id]={...i(e.id),...e.defaultDataMask,...t[e.id]}})),Object.values(h).forEach((e=>{String(null==e?void 0:e.id).startsWith(n._L)||(p[null==e?void 0:e.id]=e)})),u;case s.sB:return function(e,t,r,a){const o=a||{};Object.entries(o).forEach((([e,r])=>{t[e]={...r,...r.defaultDataMask}})),e.deleted.forEach((e=>{delete t[e]})),e.modified.forEach((e=>{t[e.id]={...i(e.id),...e.defaultDataMask,...e}})),Object.values(r).forEach((e=>{String(null==e?void 0:e.id).startsWith(n._L)||(t[null==e?void 0:e.id]=e)}))}(t.filterChanges,u,e,t.filters),u;default:return e}var m,p,h,_}),{})},56655:(e,t,r)=>{"use strict";function a(e,t){return new Promise((r=>{setTimeout((()=>{r(e())}),t)}))}r.d(t,{A:()=>a})},57246:(e,t,r)=>{"use strict";r.d(t,{Gq:()=>n,UH:()=>s,jy:()=>l});const a=new Set(["IS NOT NULL","IS NULL"]);function n(e){return a.has(e)}const o=new Set(["==","!=",">","<",">=","<=","ILIKE","LIKE","NOT LIKE","REGEX","TEMPORAL_RANGE"]);function s(e){return o.has(e)}const i=new Set(["IN","NOT IN"]);function l(e){return i.has(e)}},57337:(e,t,r)=>{"use strict";r.d(t,{i:()=>u});var a=r(96540),n=r(66265),o=r(56679),s=r(96453),i=r(17437),l=r(95579),c=r(2445);const d=(0,s.I4)(o.A)`
  ${({theme:e})=>i.AH`
    color: ${e.colors.grayscale.base};
    font-size: ${e.typography.sizes.s}px;
    & svg {
      margin-left: ${e.gridUnit}px;
      margin-right: ${e.gridUnit}px;
    }
  `}
`,u=e=>{const t=(0,s.DP)(),[o,i]=(0,a.useState)(null);return(0,a.useEffect)((()=>{Promise.all([Promise.all([r.e(8096),r.e(952),r.e(1541)]).then(r.bind(r,70470)),r.e(2040).then(r.t.bind(r,72040,23))]).then((([e])=>{i((()=>e.default))}))}),[]),o?(0,c.Y)(n.A,{content:(0,c.Y)(o,{mode:"sql",value:e.sqlExpression,editorProps:{$blockScrolling:!0},setOptions:{highlightActiveLine:!1,highlightGutterLine:!1},minLines:2,maxLines:6,readOnly:!0,wrapEnabled:!0,style:{border:`1px solid ${t.colors.grayscale.light2}`,background:t.colors.secondary.light5,maxWidth:100*t.gridUnit}}),placement:"bottomLeft",arrow:{pointAtCenter:!0},title:(0,l.t)("SQL expression"),...e,children:(0,c.Y)(d,{})}):null}},58642:(e,t,r)=>{"use strict";r.d(t,{Eo:()=>m,Id:()=>i,Vi:()=>p,fE:()=>l,nn:()=>d,pU:()=>c,pn:()=>s,zF:()=>u});var a=r(34005),n=r(2445);const o=new a.FilterXSS({whiteList:{...(0,a.getDefaultWhiteList)(),span:["style","class","title"],div:["style","class"],a:["style","class","href","title","target"],img:["style","class","src","alt","title","width","height"],video:["autoplay","controls","loop","preload","src","height","width","muted"]},stripIgnoreTag:!0,css:!1});function s(e){return o.process(e)}function i(e){return/<(html|head|body|div|span|a|p|h[1-6]|title|meta|link|script|style)/i.test(e)}function l(e){const t=e.trim().toLowerCase();if(t.startsWith("<!doctype html>")&&i(t))return!0;const r=(new DOMParser).parseFromString(t,"text/html");return Array.from(r.body.childNodes).some((({nodeType:e})=>1===e))}function c(e){return l(e)?s(e):e}function d(e){return l(e)?(0,n.Y)("span",{className:"safe-html-wrapper",dangerouslySetInnerHTML:{__html:s(e)}}):e}function u(e){return e.replace(/<[^>]*>/g,"")}function m(e){try{return JSON.parse(e),!0}catch(e){return!1}}function p(e){if(!l(e))return null;const t=(new DOMParser).parseFromString(e,"text/html").querySelectorAll("p");if(0===t.length)return null;const r={};return t.forEach(((e,t)=>{r[`p${t+1}`]=e.textContent||""})),r}},58863:(e,t,r)=>{"use strict";var a,n,o;r.d(t,{$s:()=>n,Ay:()=>c,Gw:()=>l,HE:()=>s,jW:()=>o,l7:()=>i,nS:()=>a}),function(e){e.InteractiveChart="INTERACTIVE_CHART",e.NativeFilter="NATIVE_FILTER",e.DrillToDetail="DRILL_TO_DETAIL",e.DrillBy="DRILL_BY"}(a||(a={})),function(e){e.Explore="EXPLORE",e.Dashboard="DASHBOARD",e.FilterBar="FILTER_BAR",e.FilterConfigModal="FILTER_CONFIG_MODAL",e.Embedded="EMBEDDED"}(n||(n={})),function(e){e.Deprecated="DEPRECATED",e.Featured="FEATURED"}(o||(o={}));const s={[o.Deprecated]:"This chart uses features or modules which are no longer actively maintained. It will eventually be replaced or removed.",[o.Featured]:"This chart was tested and verified, so the overall experience should be stable."},i={[o.Deprecated]:{weight:-.1},[o.Featured]:{weight:.1}};var l;!function(e){e.Category="category",e.Value="value",e.Time="time",e.Log="log"}(l||(l={}));const c={}},58919:(e,t,r)=>{"use strict";r.d(t,{E9:()=>p,K1:()=>d,Vp:()=>l,Z4:()=>h,_L:()=>m,_k:()=>u,fN:()=>_,l:()=>c});var a=r(43561),n=r(56091),o=r(5362),s=r(73992),i=r(81151);const l=(e,t,r=[])=>{if(r.includes(t))return!0;const a=e.get(t);return!!a&&a.some((a=>l(e,a,[...r,t])))},c=async(e,t,r)=>{try{let t;try{t=await e.validateFields()}catch(e){var a;if(null!=e&&null!=(a=e.errorFields)&&a.length||null==e||!e.outOfDate)throw e;t=e.values}return t}catch(e){var n;if(o.A.warn("Filter configuration failed:",e),null==(n=e.errorFields)||!n.length)return null;const a=e.errorFields;if(!a.some((e=>e.name[1]===t))){const e=a.find((e=>"filters"===e.name[0]));e&&r(e.name[1])}return null}},d=(e,t,r,a)=>async()=>{const o=t.modified.map((e=>{var t,o,l,c;const d=(null==(t=r.filters)?void 0:t[e])||a[e];if(!d)return;if(d.type===s.EH.Divider)return{id:e,type:s.EH.Divider,scope:{rootPath:[i.wv],excluded:[]},title:d.title,description:d.description};const u={};return d.dataset&&(u.datasetId=d.dataset.value),d.dataset&&d.column&&(u.column={name:d.column}),{id:e,adhoc_filters:d.adhoc_filters,time_range:d.time_range,controlValues:null!=(o=d.controlValues)?o:{},granularity_sqla:d.granularity_sqla,requiredFirst:Object.values(null!=(l=d.requiredFirst)?l:{}).find((e=>e)),name:d.name,filterType:d.filterType,targets:[u],defaultDataMask:null!=(c=d.defaultDataMask)?c:(0,n.Z)(),cascadeParentIds:d.dependencies||[],scope:d.scope,sortMetric:d.sortMetric,type:d.type,description:(d.description||"").trim()}})).filter(Boolean),l={...t,modified:o};await e(l)},u=(e,t,r,a)=>n=>{const o=window.setTimeout((()=>{(r=>{e((e=>({...e,[r]:{isPending:!1}}))),t((e=>e.filter((e=>e!==r))))})(n)}),5e3);e((e=>({...e,[n]:{isPending:!0,timerId:o}}))),a(n),r(!1)},m="NATIVE_FILTER-",p="NATIVE_FILTER_DIVIDER-",h=e=>`${e===s.EH.NativeFilter?m:p}${(0,a.Ak)()}`,_=e=>e.map((e=>e.id))},58962:(e,t,r)=>{"use strict";r.d(t,{ne:()=>g});var a=r(76968),n=r(69161),o=r(95579),s=r(82920),i=r(49953),l=r(85183),c=r(95483),d=r(84080),u=r(2445);const m=(0,a.A)(),p=(0,n.A)(),h=[["SMART_NUMBER",(0,o.t)("Adaptive formatting")],["~g",(0,o.t)("Original value")],[",d",",d (12345.432 => 12,345)"],[".1s",".1s (12345.432 => 10k)"],[".3s",".3s (12345.432 => 12.3k)"],[",.1%",",.1% (12345.432 => 1,234,543.2%)"],[".3%",".3% (12345.432 => 1234543.200%)"],[".4r",".4r (12345.432 => 12350)"],[",.3f",",.3f (12345.432 => 12,345.432)"],["+,","+, (12345.432 => +12,345.432)"],["$,.2f","$,.2f (12345.432 => $12,345.43)"],["DURATION",(0,o.t)("Duration in ms (66000 => 1m 6s)")],["DURATION_SUB",(0,o.t)("Duration in ms (100.40008 => 100ms 400µs 80ns)")]],_=((0,o.t)("Adaptive formatting"),{verbose_name:"Time",column_name:"__timestamp",description:(0,o.t)("A reference to the [Time] configuration, taking granularity into account")}),f={type:"SelectControl",multi:!0,freeForm:!0,label:(0,o.t)("Dimensions"),default:[],includeTime:!1,description:(0,o.t)("One or many columns to group by. High cardinality groupings should include a series limit to limit the number of fetched and rendered series."),optionRenderer:e=>(0,u.Y)(d.V,{column:e,showType:!0}),valueKey:"column_name",filterOption:({data:e},t)=>e.column_name&&e.column_name.toLowerCase().indexOf(t.toLowerCase())>=0||e.verbose_name&&e.verbose_name.toLowerCase().indexOf(t.toLowerCase())>=0,mapStateToProps:(e,t)=>{const r={};return e.datasource&&(r.options=e.datasource.columns.filter((e=>e.groupby)),t&&t.includeTime&&r.options.push(_)),r}},y={type:"MetricsControl",multi:!0,label:(0,o.t)("Metrics"),validators:[s.A],mapStateToProps:e=>{const{datasource:t}=e;return{columns:t?t.columns:[],savedMetrics:t?t.metrics:[],datasource:t}},description:(0,o.t)("One or many metrics to display")},E={...y,multi:!1,label:(0,o.t)("Metric"),description:(0,o.t)("Metric")},g={metrics:y,metric:E,datasource:{type:"DatasourceControl",label:(0,o.t)("Dataset"),default:null,description:null,mapStateToProps:({datasource:e})=>({datasource:e,isEditable:!!e})},viz_type:{type:"VizTypeControl",default:"table",description:(0,o.t)("The type of visualization to display")},color_picker:{label:(0,o.t)("Fixed color"),description:(0,o.t)("Use this to define a static color for all circles"),type:"ColorPickerControl",default:{r:0,g:122,b:135,a:1},renderTrigger:!0},metric_2:{...E,label:(0,o.t)("Right axis metric"),clearable:!0,description:(0,o.t)("Choose a metric for right axis")},linear_color_scheme:{type:"ColorSchemeControl",label:(0,o.t)("Linear color scheme"),choices:()=>p.values().map((e=>[e.id,e.label])),default:p.getDefaultKey(),clearable:!1,description:"",renderTrigger:!0,schemes:()=>p.getMap(),isLinear:!0},secondary_metric:{...E,label:(0,o.t)("Color metric"),default:null,validators:[],description:(0,o.t)("A metric to use for color")},groupby:f,columns:{...f,label:(0,o.t)("Columns"),description:(0,o.t)("One or many controls to pivot as columns")},granularity:{type:"SelectControl",freeForm:!0,label:c.Fp.granularity,default:"P1D",choices:[[null,(0,o.t)("all")],["PT5S",(0,o.t)("5 seconds")],["PT30S",(0,o.t)("30 seconds")],["PT1M",(0,o.t)("1 minute")],["PT5M",(0,o.t)("5 minutes")],["PT30M",(0,o.t)("30 minutes")],["PT1H",(0,o.t)("1 hour")],["PT6H",(0,o.t)("6 hour")],["P1D",(0,o.t)("1 day")],["P7D",(0,o.t)("7 days")],["P1W",(0,o.t)("week")],["week_starting_sunday",(0,o.t)("week starting Sunday")],["week_ending_saturday",(0,o.t)("week ending Saturday")],["P1M",(0,o.t)("month")],["P3M",(0,o.t)("quarter")],["P1Y",(0,o.t)("year")]],description:(0,o.t)("The time granularity for the visualization. Note that you can type and use simple natural language as in `10 seconds`,`1 day` or `56 weeks`")},granularity_sqla:{type:"SelectControl",label:c.Fp.granularity_sqla,description:(0,o.t)("The time column for the visualization. Note that you can define arbitrary expression that return a DATETIME column in the table. Also note that the filter below is applied against this column or expression"),clearable:!1,optionRenderer:e=>(0,u.Y)(d.V,{column:e,showType:!0}),valueKey:"column_name",mapStateToProps:e=>{const t={};return e.datasource&&(t.choices=e.datasource.granularity_sqla,t.default=null,e.datasource.main_dttm_col?t.default=e.datasource.main_dttm_col:t.choices&&t.choices.length>0&&(t.default=t.choices[0].column_name)),t}},time_grain_sqla:{type:"SelectControl",label:c.Fp.time_grain_sqla,default:"P1D",description:(0,o.t)("The time granularity for the visualization. This applies a date transformation to alter your time column and defines a new time granularity. The options here are defined on a per database engine basis in the Superset source code."),mapStateToProps:e=>({choices:e.datasource?e.datasource.time_grain_sqla:null})},time_range:{type:"DateFilterControl",freeForm:!0,label:c.Fp.time_range,default:(0,o.t)("No filter"),description:(0,o.t)('The time range for the visualization. All relative times, e.g. "Last month", "Last 7 days", "now", etc. are evaluated on the server using the server\'s local time (sans timezone). All tooltips and placeholder times are expressed in UTC (sans timezone). The timestamps are then evaluated by the database using the engine\'s local timezone. Note one can explicitly set the timezone per the ISO 8601 format if specifying either the start and/or end time.')},row_limit:{type:"SelectControl",freeForm:!0,label:(0,o.t)("Row limit"),validators:[i.A],default:1e4,choices:(0,l.u8)([10,50,100,250,500,1e3,5e3,1e4,5e4]),description:(0,o.t)("Limits the number of rows that get displayed.")},limit:{type:"SelectControl",freeForm:!0,label:(0,o.t)("Series limit"),validators:[i.A],choices:(0,l.u8)([5,10,25,50,100,500]),clearable:!0,description:(0,o.t)("Limits the number of series that get displayed. A joined subquery (or an extra phase where subqueries are not supported) is applied to limit the number of series that get fetched and rendered. This feature is useful when grouping by high cardinality column(s) though does increase the query complexity and cost.")},timeseries_limit_metric:{type:"MetricsControl",label:(0,o.t)("Sort by"),default:null,clearable:!0,description:(0,o.t)("Metric used to define how the top series are sorted if a series or row limit is present. If undefined reverts to the first metric (where appropriate)."),mapStateToProps:e=>({columns:e.datasource?e.datasource.columns:[],savedMetrics:e.datasource?e.datasource.metrics:[],datasource:e.datasource})},series:{...f,label:(0,o.t)("Dimensions"),multi:!1,default:null,description:(0,o.t)("Defines the grouping of entities. Each series is shown as a specific color on the chart and has a legend toggle")},entity:{...f,label:(0,o.t)("Entity"),default:null,multi:!1,validators:[s.A],description:(0,o.t)("This defines the element to be plotted on the chart")},x:{...E,label:(0,o.t)("X Axis"),description:(0,o.t)("Metric assigned to the [X] axis"),default:null},y:{...E,label:(0,o.t)("Y Axis"),default:null,description:(0,o.t)("Metric assigned to the [Y] axis")},size:{...E,label:(0,o.t)("Bubble size"),default:null},y_axis_format:{type:"SelectControl",freeForm:!0,label:(0,o.t)("Y Axis Format"),renderTrigger:!0,default:"SMART_NUMBER",choices:h,description:"D3 format syntax: https://github.com/d3/d3-format",mapStateToProps:e=>{const t=e.controls&&e.controls.comparison_type&&"percentage"===e.controls.comparison_type.value;return{warning:t?(0,o.t)('When `Calculation type` is set to "Percentage change", the Y Axis Format is forced to `.1%`'):null,disabled:t}}},adhoc_filters:{type:"AdhocFilterControl",label:(0,o.t)("Filters"),default:null,description:"",mapStateToProps:e=>({columns:e.datasource?e.datasource.columns.filter((e=>e.filterable)):[],savedMetrics:e.datasource?e.datasource.metrics:[],datasource:e.datasource})},color_scheme:{type:"ColorSchemeControl",label:(0,o.t)("Color scheme"),default:m.getDefaultKey(),renderTrigger:!0,choices:()=>m.keys().map((e=>[e,e])),description:(0,o.t)("The color scheme for rendering chart"),schemes:()=>m.getMap()}}},58999:(e,t,r)=>{"use strict";r.d(t,{A:()=>u});var a=r(96540),n=r(19129),o=r(85861),s=r(16294),i=r(25946),l=r(95579),c=r(96453),d=r(2445);const u=({errorType:e=(0,l.t)("Error"),message:t,type:r="error",description:u,descriptionDetails:m,descriptionDetailsCollapsed:p=!0,descriptionPre:h=!0,compact:_=!1,children:f,closable:y=!0,showIcon:E=!0,className:g})=>{const[T,A]=(0,a.useState)(!p),[b,S]=(0,a.useState)(!1),v=()=>{A(!T)},R=(0,c.DP)(),I={whiteSpace:"pre-wrap",fontFamily:R.typography.families.sansSerif},O=a=>(0,d.FD)(i.A,{description:(0,d.FD)("div",{children:[u&&(0,d.Y)("p",{style:h?I:{},"data-testid":"description",children:u}),m&&(0,d.FD)("div",{children:[T&&(0,d.Y)("p",{style:h?I:{},children:m}),(0,d.Y)("span",{role:"button",tabIndex:0,onClick:v,style:{textDecoration:"underline",cursor:"pointer"},children:T?(0,l.t)("See less"):(0,l.t)("See more")})]})]}),type:r,showIcon:!0,closable:a,className:g,children:[(0,d.Y)("strong",{children:e}),t&&(0,d.FD)(d.FK,{children:[": ",(0,d.Y)("span",{children:t})]})]});return _?(0,d.FD)(d.FK,{children:[(0,d.Y)(n.m_,{title:`${e}: ${t}`,children:(0,d.Y)("span",{role:"button",onClick:()=>S(!0),tabIndex:0,children:(()=>{const t="warning"===r?(0,d.Y)(s.A.WarningOutlined,{}):(0,d.Y)(s.A.ExclamationCircleOutlined,{}),a="warning"===r?R.colors.warning.base:R.colors.error.base;return(0,d.FD)("div",{className:g,style:{cursor:"pointer"},children:[(0,d.FD)("span",{style:{color:a},children:[t," "]}),e]})})()})}),(0,d.FD)(o.Ay,{title:e,show:b,onHide:()=>S(!1),footer:null,children:[O(!1),f]})]}):O(y)}},60130:(e,t,r)=>{"use strict";r.r(t),r.d(t,{CREATE_NEW_SLICE:()=>q,FETCH_DATASOURCES_STARTED:()=>p,FETCH_DATASOURCES_SUCCEEDED:()=>_,FETCH_DATASOURCE_SUCCEEDED:()=>u,FETCH_FAVE_STAR:()=>g,POST_DATASOURCE_STARTED:()=>d,SAVE_FAVE_STAR:()=>A,SET_EXPLORE_CONTROLS:()=>R,SET_FIELD_VALUE:()=>S,SET_FORCE_QUERY:()=>M,SET_FORM_DATA:()=>O,SET_SAVE_ACTION:()=>L,SET_STASH_FORM_DATA:()=>k,SLICE_UPDATED:()=>U,START_METADATA_LOADING:()=>Q,STOP_METADATA_LOADING:()=>H,SYNC_DATASOURCE_METADATA:()=>$,TOGGLE_FAVE_STAR:()=>y,UPDATE_CHART_TITLE:()=>D,UPDATE_FORM_DATA_BY_DATASOURCE:()=>l,createNewSlice:()=>x,exploreActions:()=>V,fetchDatasourceSucceeded:()=>m,fetchDatasourcesStarted:()=>h,fetchDatasourcesSucceeded:()=>f,fetchFaveStar:()=>T,saveFaveStar:()=>b,setControlValue:()=>v,setExploreControls:()=>I,setForceQuery:()=>F,setFormData:()=>C,setSaveAction:()=>N,setStashFormData:()=>Y,sliceUpdated:()=>P,startMetaDataLoading:()=>B,stopMetaDataLoading:()=>j,syncDatasourceMetadata:()=>G,toggleFaveStar:()=>E,updateChartTitle:()=>w,updateFormDataByDatasource:()=>c});var a=r(58561),n=r.n(a),o=r(35742),s=r(95579),i=r(95272);const l="UPDATE_FORM_DATA_BY_DATASOURCE";function c(e,t){return{type:l,prevDatasource:e,newDatasource:t}}const d="POST_DATASOURCE_STARTED",u="FETCH_DATASOURCE_SUCCEEDED";function m(){return{type:u}}const p="FETCH_DATASOURCES_STARTED";function h(){return{type:p}}const _="FETCH_DATASOURCES_SUCCEEDED";function f(){return{type:_}}const y="TOGGLE_FAVE_STAR";function E(e){return{type:y,isStarred:e}}const g="FETCH_FAVE_STAR";function T(e){return function(t){o.A.get({endpoint:`/api/v1/chart/favorite_status/?q=${n().encode([e])}`}).then((({json:e})=>{var r,a;t(E(!(null==e||null==(r=e.result)||null==(a=r[0])||!a.value)))}))}}const A="SAVE_FAVE_STAR";function b(e,t){return function(r){const a=`/api/v1/chart/${e}/favorites/`;(t?o.A.delete({endpoint:a}):o.A.post({endpoint:a})).then((()=>r(E(!t)))).catch((()=>{r((0,i.iB)((0,s.t)("An error occurred while starring this chart")))}))}}const S="SET_FIELD_VALUE";function v(e,t,r){return{type:S,controlName:e,value:t,validationErrors:r}}const R="UPDATE_EXPLORE_CONTROLS";function I(e){return{type:R,formData:e}}const O="UPDATE_FORM_DATA";function C(e){return{type:O,formData:e}}const D="UPDATE_CHART_TITLE";function w(e){return{type:D,sliceName:e}}const L="SET_SAVE_ACTION";function N(e){return{type:L,saveAction:e}}const q="CREATE_NEW_SLICE";function x(e,t,r,a,n){return{type:q,can_add:e,can_download:t,can_overwrite:r,slice:a,form_data:n}}const U="SLICE_UPDATED";function P(e){return{type:U,slice:e}}const M="SET_FORCE_QUERY";function F(e){return{type:M,force:e}}const k="SET_STASH_FORM_DATA";function Y(e,t){return{type:k,isHidden:e,fieldNames:t}}const Q="START_METADATA_LOADING";function B(){return{type:Q}}const H="STOP_METADATA_LOADING";function j(){return{type:H}}const $="SYNC_DATASOURCE_METADATA";function G(e){return{type:$,datasource:e}}const V={...i.h$,fetchDatasourcesStarted:h,fetchDatasourcesSucceeded:f,toggleFaveStar:E,fetchFaveStar:T,saveFaveStar:b,setControlValue:v,setExploreControls:I,setStashFormData:Y,updateChartTitle:w,createNewSlice:x,sliceUpdated:P,setForceQuery:F,syncDatasourceMetadata:G}},60274:(e,t,r)=>{"use strict";var a;r.d(t,{C:()=>a}),function(e){e.Info="INFO_TOAST",e.Success="SUCCESS_TOAST",e.Warning="WARNING_TOAST",e.Danger="DANGER_TOAST"}(a||(a={}))},62787:(e,t,r)=>{"use strict";r.d(t,{A:()=>d});var a=r(20249),n=r.n(a),o=r(96453),s=r(95579),i=r(97689),l=r(2445);const c=o.I4.div`
  margin-bottom: ${({theme:e})=>2*e.gridUnit}px;
`,d=function({certifiedBy:e,details:t,metricName:r}){const a=(0,o.DP)();return(0,l.Y)(i.A,{id:`${n()(r)}-tooltip`,title:(0,l.FD)("div",{children:[e&&(0,l.Y)(c,{children:(0,s.t)("Certified by %s",e)}),(0,l.Y)("div",{children:t})]}),children:(0,l.Y)("svg",{xmlns:"http://www.w3.org/2000/svg",enableBackground:"new 0 0 24 24",height:"14",viewBox:"0 0 24 24",width:"14",children:(0,l.Y)("g",{children:(0,l.Y)("path",{fill:a.colors.primary.base,d:"M23,12l-2.44-2.79l0.34-3.69l-3.61-0.82L15.4,1.5L12,2.96L8.6,1.5L6.71,4.69L3.1,5.5L3.44,9.2L1,12l2.44,2.79l-0.34,3.7 l3.61,0.82L8.6,22.5l3.4-1.47l3.4,1.46l1.89-3.19l3.61-0.82l-0.34-3.69L23,12z M9.38,16.01L7,13.61c-0.39-0.39-0.39-1.02,0-1.41 l0.07-0.07c0.39-0.39,1.03-0.39,1.42,0l1.61,1.62l5.15-5.16c0.39-0.39,1.03-0.39,1.42,0l0.07,0.07c0.39,0.39,0.39,1.02,0,1.41 l-5.92,5.94C10.41,16.4,9.78,16.4,9.38,16.01z"})})})})}},62952:(e,t,r)=>{"use strict";function a(e){return null==e?[]:Array.isArray(e)?e:[e]}r.d(t,{A:()=>a})},64349:(e,t,r)=>{"use strict";r.d(t,{O0:()=>d,ZS:()=>i});var a=r(35742),n=r(51436),o=r(95272),s=r(60130);const i="SET_DATASOURCE";function l(e){return{type:i,datasource:e}}function c(e){return function(t,r){const{explore:{datasource:a}}=r();t(l(e)),t((0,s.updateFormDataByDatasource)(a,e))}}const d={setDatasource:l,changeDatasource:c,saveDataset:function({schema:e,sql:t,database:r,templateParams:s,datasourceName:i,columns:l}){return async function(d){try{const{json:{data:n}}=await a.A.post({endpoint:"/api/v1/dataset/",headers:{"Content-Type":"application/json"},body:JSON.stringify({database:null==r?void 0:r.id,table_name:i,schema:e,sql:t,template_params:s,columns:l})});return d(c(n)),n}catch(e){throw(0,n.h4)(e).then((e=>{d((0,o.iB)(e.error))})),e}}}}},64389:(e,t,r)=>{"use strict";r.d(t,{A:()=>a});const a=function(e,t){if(t){const r=new Set;return e.filter((e=>{const a=t(e);return!r.has(a)&&(r.add(a),!0)}))}return[...new Set(e)]}},65256:(e,t,r)=>{"use strict";r.d(t,{m9:()=>d,bD:()=>m,N6:()=>l,ZU:()=>u});var a=r(27366),n=r(11331),o=r.n(n);function s(e){return function(e){return o()(e)&&"username"in e}(e)&&"permissions"in e&&"roles"in e}var i=r(84666);const l=e=>s(e)&&Object.keys(e.roles||{}).some((e=>"admin"===e.toLowerCase())),c=(e,t)=>s(t)&&e.owners.some((e=>e.id===t.userId)),d=(e,t)=>s(t)&&(l(t)||c(e,t))&&(0,i.L)("can_write","Dashboard",null==t?void 0:t.roles);function u(e,t,r){return l(e)||s(e)&&Object.values(e.roles||{}).flat().some((e=>e[0]===r&&e[1]===t))}const m=(e,t)=>s(t)&&(0,i.L)("can_write","Dashboard",null==t?void 0:t.roles)&&(!(0,a.G7)(a.TO.DashboardRbac)||l(t)||c(e,t))},66537:(e,t,r)=>{"use strict";r.d(t,{A:()=>c,W:()=>l});var a=r(20249),n=r.n(a),o=r(95579),s=r(97689),i=r(2445);function l({label:e,tooltip:t,bsStyle:r,onClick:a,icon:l="info-circle",className:c="text-muted",placement:d="right",iconsStyle:u={}}){const m=`fa fa-${l} ${c} ${r?`text-${r}`:""}`,p=(0,i.Y)("i",{role:"button","aria-label":(0,o.t)("Show info tooltip"),tabIndex:0,className:m,style:{cursor:a?"pointer":void 0,...u},onClick:a,onKeyPress:a&&(e=>{"Enter"!==e.key&&" "!==e.key||a()})});return t?(0,i.Y)(s.m,{id:`${n()(e)}-tooltip`,title:t,placement:d,children:p}):p}const c=l},66903:(e,t,r)=>{"use strict";r.d(t,{EL:()=>m,Gw:()=>p,I4:()=>h,MQ:()=>u});var a=r(96453),n=r(17437),o=r(95579),s=r(2445);const i=a.I4.div`
  ${({theme:e})=>n.AH`
    display: -webkit-box;
    -webkit-line-clamp: 40;
    -webkit-box-orient: vertical;
    overflow: hidden;
    text-overflow: ellipsis;

    font-size: ${e.typography.sizes.s}px;
    line-height: 1.2;

    &:not(:last-of-type) {
      margin-bottom: ${2*e.gridUnit}px;
    }
  `}
`,l=a.I4.span`
  ${({theme:e})=>n.AH`
    font-weight: ${e.typography.weights.bold};
  `}
`,c=({label:e,text:t})=>(0,s.FD)(i,{children:[(0,s.Y)(l,{children:e}),": ",(0,s.Y)("span",{children:t})]}),d=e=>{var t,r;return!!((null==e||null==(t=e.current)?void 0:t.scrollWidth)>(null==e||null==(r=e.current)?void 0:r.clientWidth))},u=e=>e.verbose_name||e.column_name,m=e=>e.type?(0,s.Y)(c,{label:(0,o.t)("Column type"),text:e.type}):null,p=(e,t)=>e.column_name&&e.verbose_name||e.description||d(t)?(0,s.FD)(s.FK,{children:[e.column_name&&(0,s.Y)(c,{label:(0,o.t)("Column name"),text:e.column_name}),e.verbose_name&&(0,s.Y)(c,{label:(0,o.t)("Label"),text:e.verbose_name}),e.description&&(0,s.Y)(c,{label:(0,o.t)("Description"),text:e.description})]}):null,h=(e,t)=>e.verbose_name||e.description||e.label||d(t)?(0,s.FD)(s.FK,{children:[(0,s.Y)(c,{label:(0,o.t)("Metric name"),text:e.metric_name}),(e.label||e.verbose_name)&&(0,s.Y)(c,{label:(0,o.t)("Label"),text:e.label||e.verbose_name}),e.description&&(0,s.Y)(c,{label:(0,o.t)("Description"),text:e.description})]}):null},67054:(e,t,r)=>{"use strict";r.d(t,{A:()=>i});var a=r(81151),n=r(578),o=r(44407),s=r(72619);function i({dropResult:e,layout:t}){const{source:r,destination:i,dragging:l}=e,c=r.id===a.k0?(0,s.A)(l.type):t[l.id]||{};if(r.id===i.id)return c.meta.width;const{width:d,minimumWidth:u}=(0,o.A)({component:c,components:t}),{width:m,occupiedWidth:p}=(0,o.A)({id:i.id,components:t});let h=Number(m-p);if(Number.isNaN(h)){const{width:e,occupiedWidth:r}=(0,o.A)({id:(0,n.A)({childId:i.id,layout:t}),components:t});h=Number(e-r)}return Number.isNaN(h)||Number.isNaN(Number(d))||h>=d?d:h>=u?h:-1}},67295:(e,t,r)=>{"use strict";r.d(t,{S:()=>a});const a=e=>{var t,r;return null!=(t=e.uid)?t:`${null!=(r=e.id)?r:"None"}__${e.type}`}},67553:(e,t,r)=>{"use strict";r.d(t,{$V:()=>f,A7:()=>y,B8:()=>l,Cq:()=>v,GJ:()=>b,K8:()=>o,Ml:()=>T,QJ:()=>A,T_:()=>I,W8:()=>i,b:()=>m,cD:()=>_,d$:()=>d,de:()=>C,du:()=>p,e3:()=>O,fq:()=>u,lI:()=>R,oL:()=>c,pO:()=>g,sA:()=>n,sC:()=>S,tR:()=>h,v9:()=>D,wc:()=>E,yZ:()=>s});var a=r(95579);const n={offline:"danger",failed:"danger",pending:"info",fetching:"info",running:"warning",stopped:"danger",success:"success"},o={offline:(0,a.t)("offline"),failed:(0,a.t)("failed"),pending:(0,a.t)("pending"),fetching:(0,a.t)("fetching"),running:(0,a.t)("running"),stopped:(0,a.t)("stopped"),success:(0,a.t)("success")},s={success:"success",failed:"failed",running:"running",offline:"offline",pending:"pending"},i={success:(0,a.t)("success"),failed:(0,a.t)("failed"),running:(0,a.t)("running"),offline:(0,a.t)("offline"),pending:(0,a.t)("pending")},l=5,c=3,d=51,u=400,m=10,p=30,h=70,_=2e3,f=600,y=100,E=1024,g=2,T=864e5,A=5120,b=1024,S=.9,v=8e3,R=100,I=90,O=60,C=55,D=50},67984:(e,t,r)=>{"use strict";r.d(t,{D:()=>i,W:()=>s});var a=r(62952),n=r(13270),o=r(36818);function s(e){const t={temporalColumns:[],defaultTemporalColumn:void 0};var r,s,i;return(0,o.TI)(e)&&(t.temporalColumns=(0,a.A)(e.columns).filter((e=>e.is_dttm))),(0,o.kj)(e)&&(t.temporalColumns=(0,a.A)(e.columns).filter((e=>e.is_dttm))),(0,o.TI)(e)&&(t.defaultTemporalColumn=e.main_dttm_col),(0,n.A)(t.defaultTemporalColumn)||(t.defaultTemporalColumn=null!=(r=null==(s=t.temporalColumns[0])?void 0:s.column_name)?r:null==(i=t.temporalColumns[0])?void 0:i.name),t}function i(e,t){const r=s(t).temporalColumns;for(let t=0;t<r.length;t+=1)if(r[t].column_name===e)return!0;return!1}},68458:(e,t,r)=>{"use strict";r.d(t,{A:()=>p,b:()=>m});var a=r(90179),n=r.n(a),o=r(95579),s=r(52123),i=r(34975),l=r(17596),c=r(91522),d=r(7089),u=r(2514);const m={id:0,chartAlert:null,chartStatus:"loading",chartStackTrace:null,chartUpdateEndTime:null,chartUpdateStartTime:0,latestQueryFormData:{},sliceFormData:null,queryController:null,queriesResponse:null,triggerQuery:!0,lastRendered:0};function p(e={},t){const r={[u.ADD_CHART]:()=>({...m,...t.chart}),[u.CHART_UPDATE_SUCCEEDED]:e=>({...e,chartStatus:"success",chartAlert:null,queriesResponse:t.queriesResponse,chartUpdateEndTime:(0,d.tB)()}),[u.CHART_UPDATE_STARTED]:e=>({...e,chartStatus:"loading",chartStackTrace:null,chartAlert:null,chartUpdateEndTime:null,chartUpdateStartTime:(0,d.tB)(),queryController:t.queryController}),[u.CHART_UPDATE_STOPPED]:e=>({...e,chartStatus:"stopped",chartAlert:(0,o.t)("Updating chart was stopped"),chartUpdateEndTime:(0,d.tB)()}),[u.CHART_RENDERING_SUCCEEDED]:e=>({...e,chartStatus:"rendered",chartUpdateEndTime:(0,d.tB)()}),[u.CHART_RENDERING_FAILED]:e=>({...e,chartStatus:"failed",chartStackTrace:t.stackTrace,chartAlert:(0,o.t)("An error occurred while rendering the visualization: %s",t.error)}),[u.CHART_UPDATE_FAILED](e){var r,a,n,s;return{...e,chartStatus:"failed",chartAlert:t.queriesResponse?null==(r=t.queriesResponse)||null==(a=r[0])?void 0:a.error:(0,o.t)("Network error."),chartUpdateEndTime:(0,d.tB)(),queriesResponse:t.queriesResponse,chartStackTrace:t.queriesResponse?null==(n=t.queriesResponse)||null==(s=n[0])?void 0:s.stacktrace:null}},[u.DYNAMIC_PLUGIN_CONTROLS_READY]:e=>({...e,sliceFormData:(0,l.LK)(t.controlsState)}),[u.TRIGGER_QUERY]:e=>({...e,triggerQuery:t.value,chartStatus:"loading"}),[u.RENDER_TRIGGERED]:e=>({...e,lastRendered:t.value}),[u.UPDATE_QUERY_FORM_DATA]:e=>({...e,latestQueryFormData:t.value}),[u.ANNOTATION_QUERY_STARTED](e){var r;null!=(r=e.annotationQuery)&&r[t.annotation.name]&&e.annotationQuery[t.annotation.name].abort();const a={...e.annotationQuery,[t.annotation.name]:t.queryController};return{...e,annotationQuery:a}},[u.ANNOTATION_QUERY_SUCCESS](e){const r={...e.annotationData,[t.annotation.name]:t.queryResponse.data},a={...e.annotationError};delete a[t.annotation.name];const n={...e.annotationQuery};return delete n[t.annotation.name],{...e,annotationData:r,annotationError:a,annotationQuery:n}},[u.ANNOTATION_QUERY_FAILED](e){const r={...e.annotationData};delete r[t.annotation.name];const a={...e.annotationError,[t.annotation.name]:t.queryResponse?t.queryResponse.error:(0,o.t)("Network error.")},n={...e.annotationQuery};return delete n[t.annotation.name],{...e,annotationData:r,annotationError:a,annotationQuery:n}}};if(t.type===u.REMOVE_CHART)return n()(e,[t.key]);if(t.type===u.UPDATE_CHART_ID){const{newId:r,key:a}=t;return e[r]={...e[a],id:r},delete e[a],e}return t.type===s.n||t.type===c.W?{...t.data.charts}:t.type===i.p3.SetDatasources?Object.fromEntries(Object.entries(e).map((([e,t])=>[e,"failed"===t.chartStatus&&t.chartStackTrace?{...t,chartStatus:"",chartStackTrace:null,chartAlert:null}:t]))):t.type in r?{...e,[t.key]:r[t.type](e[t.key])}:e}},68921:(e,t,r)=>{"use strict";r.d(t,{MB:()=>E,_i:()=>g,kl:()=>T,ug:()=>y});var a=r(8209),n=r.n(a),o=r(89899),s=r.n(o),i=r(89143),l=r.n(i),c=r(62193),d=r.n(c),u=r(24647),m=r(49588),p=r(20824);let h={},_={},f={};function y(){return h}function E(e,t){if(!(e in _)){const r=Object.entries(t||h).filter((([,{scope:t}])=>t.includes(e)));_[e]=s()(n()((([e])=>(0,u.w)(e).column)),l()((([,{values:e}])=>e)))(r)}return _[e]}function g({filterScope:e}){function t(e=[],r={},a=[]){r&&(r.type===m.oT&&r.meta&&r.meta.chartId&&!a.includes(r.meta.chartId)?e.push(r.meta.chartId):r.children&&r.children.forEach((r=>t(e,f[r],a))))}const r=[],{scope:a,immune:n}=e||p.FC;return a.forEach((e=>t(r,f[e],n))),r}function T({dashboardFilters:e={},components:t={}}){d()(t)||(f=t),_={},h=Object.values(e).reduce(((e,t)=>{const{chartId:r,columns:a,scopes:n}=t,o={};return Object.keys(a).forEach((e=>{if(Array.isArray(a[e])?a[e].length:void 0!==a[e]){const t=g({filterScope:n[e]}).filter((e=>r!==e));o[(0,u.s)({chartId:r,column:e})]={values:a[e],scope:t}}})),{...e,...o}}),{})}},69070:(e,t,r)=>{"use strict";r.d(t,{sm:()=>Ce,vq:()=>Le,M_:()=>Ne});var a=r(60258),n=r(1265),o=r(43031),s=r(95272),i=r(68458),l=r(56091),c=r(90179),d=r.n(c),u=r(93491),m=r(48285),p=r(52123),h=r(72173),_=r(20824),f=r(45881),y=r(38970),E=r.n(y),g=r(34975),T=r(46074),A=r(84700),b=r(81151),S=r(92475),v=r(49588);function R(e){return[v.QP,v.oT,v.xY,v.rG].indexOf(e.type)>-1}var I=r(578),O=r(67054),C=r(54193),D=r(72619);const w={[v.$9]:{[v.oT]:!0,[v.QP]:!0,[v.xY]:!0},[v.B8]:{[v.oT]:!0,[v.QP]:!0,[v.xY]:!0}};function L({parentType:e,childType:t}){if(!e||!t)return!1;const r=w[e];return!!r&&Boolean(r[t])}function N({dropResult:e,layout:t}){const{dragging:r,destination:a}=e,n=r.type,o=t[a.id],s=o.type;let i=(0,D.A)(n,r.meta);i.parents=(o.parents||[]).concat(o.id),R(r)&&(i.meta.width=(0,O.A)({dropResult:e,layout:t})||void 0);const l=L({parentType:s,childType:n}),c={[i.id]:i};if(l){const e=(0,D.A)(v._8);e.children=[i.id],e.parents=(o.parents||[]).concat(o.id),c[e.id]=e,i.parents=e.parents.concat(e.id),i=e}else if(n===v.wc){const e=(0,D.A)(v.B8);e.parents=(o.parents||[]).concat(o.id),i.children=[e.id],c[e.id]=e}const d=[...o.children];return d.splice(a.index,0,i.id),c[a.id]={...o,children:d},c}var q=r(35043);function x(e,t,r){const a=null==r?void 0:r[e];if(a){delete r[e];const{children:n=[]}=a;null==n||null==n.forEach||n.forEach((t=>{x(t,e,r)}));const o=null==r?void 0:r[t];if(Array.isArray(null==o?void 0:o.children)){const a=o.children.indexOf(e);if(a>-1){const e=[...o.children];e.splice(a,1),r[t]={...o,children:e}}}}}const U={[p.n]:(e,t)=>({...t.data.dashboardLayout.present}),[S.NW](e,t){const{payload:{nextComponents:r}}=t;return{...e,...r}},[S.Cl](e,t){var r;const{payload:{id:a,parentId:n}}=t;if(!(n&&a&&e[a]&&e[n]))return e;const o={...e};x(a,n,o);const s=o[n];return(null==s?void 0:s.type)===v._8&&0===(null==s||null==(r=s.children)?void 0:r.length)&&x(n,(0,I.A)({childId:n,layout:o}),o),o},[S.PX](e,t){const{payload:{dropResult:r}}=t,a=N({dropResult:r,layout:e});return{...e,...a}},[S.Yd](e,t){const{payload:{dropResult:r}}=t,{source:a,destination:n,dragging:o,position:s}=r;if(!a||!n||!o)return e;const i=function({entitiesMap:e,source:t,destination:r,position:a}){const n=[...e[t.id].children],o=[...e[r.id].children],s=n[t.index],i=t.id===r.id,l=t.type&&r.type===v.wc;let c=r.index;if(i){if(l){a===q.S4?c=Math.max(c,0):a===q.Db&&(c+=1);const n=a===q.Db&&t.index===r.index+1,o=a===q.S4&&t.index===r.index-1;if(n||o)return e;c>t.index&&(c-=1)}const o=function(e,t,r){const a=[...e],[n]=a.splice(t,1);return a.splice(r,0,n),a}(n,t.index,c);return{...e,[t.id]:{...e[t.id],children:o}}}return l&&(a===q.S4?c=Math.max(c,0):a===q.Db&&(c=Math.min(c+1,n.length-1))),n.splice(t.index,1),o.splice(c,0,s),{...e,[t.id]:{...e[t.id],children:n},[r.id]:{...e[r.id],children:o}}}({entitiesMap:e,source:a,destination:n,position:s});if(R(i[o.id])){const t=(0,O.A)({dropResult:r,layout:e})||void 0;(i[o.id].meta||{}).width!==t&&(i[o.id]={...i[o.id],meta:{...i[o.id].meta,width:t}})}if(L({parentType:n.type,childType:o.type})){const e=i[n.id],t=e.children,r=(0,D.A)(v._8);r.children=[t[n.index]],r.parents=(e.parents||[]).concat(n.id),t[n.index]=r.id,i[r.id]=r}return{...e,...i}},[S.Rc](e,t){const{payload:{dropResult:r}}=t,{source:a,dragging:n}=r,o=e[b.wv],s=o.children[0],i=e[s];if(a.id!==b.k0){const t=e[n.id].children[0],r=e[t],a=[...i.children].filter((e=>e!==n.id));return{...e,[b.wv]:{...o,children:[n.id]},[s]:{...i,children:[]},[t]:{...r,children:[...r.children,...a]}}}const l=N({dropResult:r,layout:e}),c=Object.values(l),d=c.find((e=>e.type===v.B8)),u=c.find((e=>e.type===v.wc));return d.children=[...i.children],l[s]={...i,children:[]},l[b.wv]={...o,children:[u.id]},{...e,...l}},[S.cL](e){const t=e[b.wv],r=t.children[0],a=e[r];if(a.type!==v.wc)return e;let n=[];const o={...e};return a.children.forEach((t=>{const r=e[t];n=[...n,...r.children],delete o[t]})),delete o[r],o[b.wv]={...t,children:[b.mK]},o[b.mK]={...e[b.mK],children:n},o},[S.YX](e){const t={...e};return(0,C.A)({currentComponent:t[b.wv],layout:t}),{...t}},[S.D3]:(e,t)=>({...e,[b.XY]:{...e[b.XY],meta:{...e[b.XY].meta,text:t.text}}})},P=(0,A.Ay)((function(e={},t){return t.type in U?(0,U[t.type])(e,t):e}),{limit:b.nc+2,ignoreInitialState:!0,filter:(0,A.F0)([p.n,S.NW,S.Cl,S.PX,S.Rc,S.cL,S.jd,S.Yd,S.fD])});var M=r(43561),F=r(35742),k=r(12066),Y=r(7735),Q=r(35700),B=r(38221),H=r.n(B);const j=new class{constructor({callback:e=()=>{},sizeThreshold:t=1e3,delayThreshold:r=1e3}){this.queue=[],this.sizeThreshold=t,this.delayThreshold=r,this.trigger=H()(this.trigger.bind(this),this.delayThreshold),this.callback=e}append(e){this.queue.push(e),this.trigger()}trigger(){if(this.queue.length>0){const e=this.queue.splice(0,this.sizeThreshold);this.callback.call(null,e),this.queue.length>0&&this.trigger()}}}({callback:e=>{if(e.length<=0)return;let t="/superset/log/?explode=events";const{source:r,source_id:a}=e[0];if("dashboard"===r?t+=`&dashboard_id=${a}`:"slice"===r&&(t+=`&slice_id=${a}`),navigator.sendBeacon){const r=new FormData;r.append("events",(0,k.J)(e)),F.A.getGuestToken()&&r.append("guest_token",F.A.getGuestToken()),navigator.sendBeacon(t,r)}else F.A.post({endpoint:t,postPayload:{events:e},parseMethod:null})},sizeThreshold:1024,delayThreshold:1e3});let $=0;const G=e=>t=>r=>{var a,n,o;if(r.type!==Y.LOG_EVENT)return t(r);const{dashboardInfo:s,explore:i,impressionId:l,dashboardLayout:c,sqlLab:d}=e.getState();let u={impression_id:l,version:"v2"};const{eventName:m}=r.payload;let{eventData:p={}}=r.payload;const h=p.path||(null==(a=window)||null==(n=a.location)?void 0:n.href);if(null!=s&&s.id&&null!=h&&h.includes("/dashboard/"))u={source:"dashboard",source_id:s.id,dashboard_id:s.id,...u};else if(null!=i&&i.slice)u={source:"explore",source_id:i.slice?i.slice.slice_id:0,...i.slice.slice_id&&{slice_id:i.slice.slice_id},...u};else if(null!=h&&h.includes("/sqllab/")){const e=d.queryEditors.find((({id:e})=>e===d.tabHistory.slice(-1)[0]));u={source:"sqlLab",source_id:null==e?void 0:e.id,db_id:null==e?void 0:e.dbId,schema:null==e?void 0:e.schema}}if(p={...u,ts:(new Date).getTime(),event_name:m,...p},Q.YC.has(m)?p={...p,event_type:"timing",trigger_event:$}:($=(0,M.Ak)(),p={...p,event_type:"user",event_id:$,visibility:document.visibilityState}),p.target_id&&null!=c&&null!=(o=c.present)&&o[p.target_id]){const{meta:e}=c.present[p.target_id];p.target_name=e.chartId?e.sliceName:e.text}return j.append(p),p};var V=r(92037),z=r(91522),W=r(44383),K=r.n(W),X=r(62952),J=r(2514),Z=r(91715),ee=r(17596),te=r(60130),re=r(67295),ae=r(64349),ne=r(71086),oe=r.n(ne),se=r(97211),ie=r.n(se),le=r(27366),ce=r(94500),de=r(85278),ue=r(67553);const me={tables:de.ib,queries:de.eM,queryEditors:de.wX,unsavedQueryEditor:e=>(0,de.wX)([e])[0]},pe={paths:["sqlLab"],config:{slicer:e=>t=>{const r={};e.forEach((e=>{if((0,le.G7)(le.TO.SqllabBackendPersistence)){const{queryEditors:e,editorTabLastUpdatedAt:a,unsavedQueryEditor:n,tables:o,queries:s,tabHistory:i,lastUpdatedActiveTab:l,destroyedQueryEditors:c}=t.sqlLab,d=(0,ce.qM)(e,n,a),u=i.slice(-1)[0]!==l,m=Object.keys(c).length>0;if(d.length>0||u||m){const e=d.every((({inLocalStorage:e})=>!e));r.sqlLab={queryEditors:d,...!e&&{tabHistory:i,tables:o.filter((e=>e.inLocalStorage)),queries:oe()(s,(e=>e.inLocalStorage&&!e.isDataPreview))},...u&&{tabHistory:i},destroyedQueryEditors:c}}}else delete t[e].common,"sqlLab"===e&&(r[e]=Object.fromEntries(Object.entries(t[e]).map((([e,t])=>{var r,a;return[e,null!=(r=null==(a=me[e])?void 0:a.call(me,t))?r:t]}))))}));const a=JSON.stringify(r),n=Math.round(a.length*ue.pO/ue.wc*100)/100;return t.localStorageUsageInKilobytes!==n&&(t.localStorageUsageInKilobytes=n),r},merge:(e,t={})=>({...e,...t,sqlLab:{...(null==t?void 0:t.sqlLab)||{},...e.sqlLab}})}},he=ie()(pe.paths,pe.config);var _e=r(2404),fe=r.n(_e),ye=r(95579),Ee=r(69108),ge=r(81550),Te=r(61225),Ae=r(74680),be=r(7089),Se=r(35839);function ve(e,t,r,a=!1){if(e.tabHistory[e.tabHistory.length-1]!==r){const{queryEditors:a}=(0,Se.ZT)(e,"queryEditors",{id:r},t);return{queryEditors:a}}return{unsavedQueryEditor:{...e.unsavedQueryEditor.id===r&&e.unsavedQueryEditor,...r?{id:r,...t}:e.unsavedQueryEditor,...!a&&{updatedAt:(new Date).getTime()}}}}var Re=r(55045);const Ie=e=>(t=e)=>t,Oe=(0,r(38708).A)(),Ce="USER_LOADED",De=e=>[n.A,G,o.F.middleware],we={sqlLab:function e(t={},r){const a={[Ae.ADD_QUERY_EDITOR](){const e={...(0,Se.ZT)(t,"queryEditors",t.unsavedQueryEditor,{...t.unsavedQueryEditor}),tabHistory:[...t.tabHistory,r.queryEditor.id]};return(0,Se.CE)(e,"queryEditors",{...r.queryEditor,updatedAt:(new Date).getTime()})},[Ae.QUERY_EDITOR_SAVED](){const{query:e,result:a,clientId:n}=r,o=t.queryEditors.find((e=>e.id===n));return(0,Se.ZT)(t,"queryEditors",o,{remoteId:a.remoteId,name:e.name},"id")},[Ae.UPDATE_QUERY_EDITOR](){const e=r.alterations.remoteId,a=t.queryEditors.find((t=>t.remoteId===e));return null==a?t:(0,Se.ZT)(t,"queryEditors",a,r.alterations,"remoteId")},[Ae.CLONE_QUERY_TO_NEW_TAB](){const a=t.queryEditors.find((e=>e.id===t.tabHistory[t.tabHistory.length-1])),n={...a,...t.unsavedQueryEditor.id===a.id&&t.unsavedQueryEditor},o={remoteId:n.remoteId,name:(0,ye.t)("Copy of %s",n.name),dbId:r.query.dbId?r.query.dbId:null,catalog:r.query.catalog?r.query.catalog:null,schema:r.query.schema?r.query.schema:null,autorun:!0,sql:r.query.sql,queryLimit:r.query.queryLimit,maxRow:r.query.maxRow};return e({...t,unsavedQueryEditor:{}},Ae.addQueryEditor(o))},[Ae.REMOVE_QUERY_EDITOR](){const e={...r.queryEditor,...r.queryEditor.id===t.unsavedQueryEditor.id&&t.unsavedQueryEditor};let a=(0,Se.uI)(t,"queryEditors",e);const n=a.queryEditors.map((e=>e.id)),o={};Object.keys(t.queries).forEach((e=>{const r=t.queries[e];n.indexOf(r.sqlEditorId)>-1&&(o[e]=r)}));let s=t.tabHistory.slice();s=s.filter((e=>n.indexOf(e)>-1));const i=t.tables.filter((t=>t.queryEditorId!==e.id));return a={...a,tabHistory:0===s.length&&a.queryEditors.length>0?a.queryEditors.slice(-1).map((e=>e.id)):s,tables:i,queries:o,unsavedQueryEditor:{...r.queryEditor.id!==t.unsavedQueryEditor.id&&t.unsavedQueryEditor},destroyedQueryEditors:{...a.destroyedQueryEditors,[e.id]:Date.now()}},a},[Ae.CLEAR_DESTROYED_QUERY_EDITOR](){const e={...t.destroyedQueryEditors};return delete e[r.queryEditorId],{...t,destroyedQueryEditors:e}},[Ae.REMOVE_QUERY](){const e={...t.queries};return delete e[r.query.id],{...t,queries:e}},[Ae.RESET_STATE]:()=>({...r.sqlLabInitialState}),[Ae.MERGE_TABLE](){const e={...r.table},a=t.tables.findIndex((t=>t.dbId===e.dbId&&t.queryEditorId===e.queryEditorId&&t.catalog===e.catalog&&t.schema===e.schema&&t.name===e.name));if(a>=0)return r.query&&(e.dataPreviewQueryId=r.query.id),{...t,tables:[...t.tables.slice(0,a),{...t.tables[a],...e,...t.tables[a].initialized&&{id:t.tables[a].id}},...t.tables.slice(a+1)],...e.expanded&&{activeSouthPaneTab:e.id}};e.dataPreviewQueryId=null;let n=(0,Se.CE)(t,"tables",e,Boolean(r.prepend));return n.activeSouthPaneTab=e.id,r.query&&(n=(0,Se.ZT)(n,"tables",e,{dataPreviewQueryId:r.query.id})),n},[Ae.EXPAND_TABLE]:()=>(0,Se.ZT)(t,"tables",r.table,{expanded:!0}),[Ae.REMOVE_DATA_PREVIEW](){const e={...t.queries};return delete e[r.table.dataPreviewQueryId],{...(0,Se.ZT)(t,"tables",r.table,{dataPreviewQueryId:null}),queries:e}},[Ae.CHANGE_DATA_PREVIEW_ID](){const e={...t.queries};delete e[r.oldQueryId];const a=[];return t.tables.forEach((e=>{e.dataPreviewQueryId===r.oldQueryId?a.push({...e,dataPreviewQueryId:r.newQuery.id}):a.push(e)})),{...t,queries:e,tables:a}},[Ae.COLLAPSE_TABLE]:()=>(0,Se.ZT)(t,"tables",r.table,{expanded:!1}),[Ae.REMOVE_TABLES](){var e,a;const n=r.tables.map((e=>e.id)),o=t.tables.filter((e=>!n.includes(e.id)));return{...t,tables:o,...n.includes(t.activeSouthPaneTab)&&{activeSouthPaneTab:null!=(e=null==(a=o.find((({queryEditorId:e})=>e===r.tables[0].queryEditorId)))?void 0:a.id)?e:"Results"}}},[Ae.COST_ESTIMATE_STARTED]:()=>({...t,queryCostEstimates:{...t.queryCostEstimates,[r.query.id]:{completed:!1,cost:null,error:null}}}),[Ae.COST_ESTIMATE_RETURNED]:()=>({...t,queryCostEstimates:{...t.queryCostEstimates,[r.query.id]:{completed:!0,cost:r.json.result,error:null}}}),[Ae.COST_ESTIMATE_FAILED]:()=>({...t,queryCostEstimates:{...t.queryCostEstimates,[r.query.id]:{completed:!1,cost:null,error:r.error}}}),[Ae.START_QUERY](){let e={...t};if(r.query.sqlEditorId){const a={...(0,Se.OL)(t.queryEditors,r.query.sqlEditorId),...r.query.sqlEditorId===t.unsavedQueryEditor.id&&t.unsavedQueryEditor};if(a.latestQueryId&&t.queries[a.latestQueryId]){const r={...t.queries[a.latestQueryId].results,data:[],query:null},n={...t.queries[a.latestQueryId],results:r},o={...t.queries,[n.id]:n};e={...t,queries:o}}}return e=(0,Se.As)(e,"queries",r.query),{...e,...ve(t,{latestQueryId:r.query.id},r.query.sqlEditorId,r.query.isDataPreview)}},[Ae.STOP_QUERY]:()=>(0,Se.j2)(t,"queries",r.query,{state:Ee.kZ.Stopped,results:[]}),[Ae.CLEAR_QUERY_RESULTS](){const e={...r.query.results};return e.data=[],(0,Se.j2)(t,"queries",r.query,{results:e,cached:!0})},[Ae.REQUEST_QUERY_RESULTS]:()=>(0,Se.j2)(t,"queries",r.query,{state:Ee.kZ.Fetching}),[Ae.QUERY_SUCCESS](){var e,a,n,o,s,i,l,c,d,u;if(r.query.state===Ee.kZ.STOPPED||r.results.status!==Ee.kZ.Success)return t;const m={endDttm:(0,be.tB)(),progress:100,results:r.results,rows:(null==r||null==(e=r.results)||null==(a=e.query)?void 0:a.rows)||0,state:Ee.kZ.Success,limitingFactor:null==r||null==(n=r.results)||null==(o=n.query)?void 0:o.limitingFactor,tempSchema:null==r||null==(s=r.results)||null==(i=s.query)?void 0:i.tempSchema,tempTable:null==r||null==(l=r.results)||null==(c=l.query)?void 0:c.tempTable,errorMessage:null,cached:!1},p=null==r||null==(d=r.results)||null==(u=d.query)?void 0:u.resultsKey;return p&&(m.resultsKey=p),(0,Se.j2)(t,"queries",r.query,m)},[Ae.QUERY_FAILED](){if(r.query.state===Ee.kZ.Stopped)return t;const e={state:Ee.kZ.Failed,errors:r.errors,errorMessage:r.msg,endDttm:(0,be.tB)(),link:r.link};return(0,Se.j2)(t,"queries",r.query,e)},[Ae.SET_ACTIVE_QUERY_EDITOR](){var e;if(t.queryEditors.map((e=>e.id)).indexOf(null==(e=r.queryEditor)?void 0:e.id)>-1&&t.tabHistory[t.tabHistory.length-1]!==r.queryEditor.id){const e={...(0,Se.ZT)(t,"queryEditors",t.unsavedQueryEditor,{...t.unsavedQueryEditor}),unsavedQueryEditor:{}};return{...r.queryEditor.id===t.unsavedQueryEditor.id?(0,Se.ZT)(e,"queryEditors",r.queryEditor,{...r.queryEditor,...t.unsavedQueryEditor}):e,tabHistory:[...t.tabHistory,r.queryEditor.id]}}return t},[Ae.LOAD_QUERY_EDITOR](){const e=(0,Se.ZT)(t,"queryEditors",t.unsavedQueryEditor,{...t.unsavedQueryEditor});return(0,Se.ZT)(e,"queryEditors",r.queryEditor,{...r.queryEditor})},[Ae.SET_TABLES]:()=>(0,Se.sF)(t,"tables",r.tables),[Ae.SET_ACTIVE_SOUTHPANE_TAB]:()=>({...t,activeSouthPaneTab:r.tabId}),[Ae.MIGRATE_QUERY_EDITOR](){try{const{sqlLab:e}=JSON.parse(localStorage.getItem("redux"));e.queryEditors=e.queryEditors.filter((e=>e.id!==r.oldQueryEditor.id)),localStorage.setItem("redux",JSON.stringify({sqlLab:e}))}catch(e){}return(0,Se.ZT)(t,"queryEditors",r.oldQueryEditor,r.newQueryEditor)},[Ae.MIGRATE_TABLE](){try{const{sqlLab:e}=JSON.parse(localStorage.getItem("redux"));e.tables=e.tables.filter((e=>e.id!==r.oldTable.id)),localStorage.setItem("redux",JSON.stringify({sqlLab:e}))}catch(e){}return(0,Se.CE)((0,Se.uI)(t,"tables",r.oldTable),"tables",r.newTable)},[Ae.MIGRATE_TAB_HISTORY](){const e=t.tabHistory.map((e=>e===r.oldId?r.newId:e));return{...t,tabHistory:e}},[Ae.MIGRATE_QUERY](){const e={...t.queries[r.queryId],sqlEditorId:r.queryEditorId},a={...t.queries,[e.id]:e};return{...t,queries:a}},[Ae.QUERY_EDITOR_SETDB]:()=>({...t,...ve(t,{dbId:r.dbId},r.queryEditor.id)}),[Ae.QUERY_EDITOR_SET_CATALOG]:()=>({...t,...ve(t,{catalog:r.catalog},r.queryEditor.id)}),[Ae.QUERY_EDITOR_SET_SCHEMA]:()=>({...t,...ve(t,{schema:r.schema},r.queryEditor.id)}),[Ae.QUERY_EDITOR_SET_TITLE]:()=>({...t,...ve(t,{name:r.name},r.queryEditor.id)}),[Ae.QUERY_EDITOR_SET_SQL](){const{unsavedQueryEditor:e}=t;return(null==e?void 0:e.id)===r.queryEditor.id&&e.sql===r.sql?t:{...t,...ve(t,{sql:r.sql,...r.queryId&&{latestQueryId:r.queryId}},r.queryEditor.id)}},[Ae.QUERY_EDITOR_SET_CURSOR_POSITION]:()=>({...t,...ve(t,{cursorPosition:r.position},r.queryEditor.id)}),[Ae.QUERY_EDITOR_SET_QUERY_LIMIT]:()=>({...t,...ve(t,{queryLimit:r.queryLimit},r.queryEditor.id)}),[Ae.QUERY_EDITOR_SET_TEMPLATE_PARAMS]:()=>({...t,...ve(t,{templateParams:r.templateParams},r.queryEditor.id)}),[Ae.QUERY_EDITOR_SET_SELECTED_TEXT]:()=>({...t,...ve(t,{selectedText:r.sql},r.queryEditor.id,!0)}),[Ae.QUERY_EDITOR_SET_AUTORUN]:()=>({...t,...ve(t,{autorun:r.autorun},r.queryEditor.id)}),[Ae.QUERY_EDITOR_PERSIST_HEIGHT]:()=>({...t,...ve(t,{northPercent:r.northPercent,southPercent:r.southPercent},r.queryEditor.id)}),[Ae.QUERY_EDITOR_TOGGLE_LEFT_BAR]:()=>({...t,...ve(t,{hideLeftBar:r.hideLeftBar},r.queryEditor.id)}),[Ae.SET_DATABASES](){const e={};return r.databases.forEach((t=>{e[t.id]={...t,extra_json:JSON.parse(t.extra||"")}})),{...t,databases:e}},[Ae.REFRESH_QUERIES](){let e={...t.queries},a=!1,{queriesLastUpdate:n}=t;return Object.entries(r.alteredQueries).forEach((([r,o])=>{if(!t.queries.hasOwnProperty(r)||t.queries[r].state!==Ee.kZ.Stopped&&t.queries[r].state!==Ee.kZ.Failed){var s;const i=(0,ge.A)(o.changed_on),l=Date.parse(i);l>n&&(n=l);const c=null==(s=t.queries[r])?void 0:s.state,u=o.state;e[r]={...t.queries[r],...o,...o.startDttm&&{startDttm:Number(o.startDttm)},...o.endDttm&&{endDttm:Number(o.endDttm)},state:u===Ee.kZ.Success&&[Ee.kZ.Fetching,Ee.kZ.Success,Ee.kZ.Running].includes(c)?c:u},(0,Te.bN)(d()(e[r],["extra"]),d()(t.queries[r],["extra"]))&&fe()(e[r].extra,t.queries[r].extra)?e[r]=t.queries[r]:a=!0}})),a||(e=t.queries),{...t,queries:e,queriesLastUpdate:n}},[Ae.CLEAR_INACTIVE_QUERIES](){const{queries:e}=t,a=Object.fromEntries(Object.entries(e).filter((([,e])=>!(["running","pending"].includes(e.state)&&Date.now()-e.startDttm>r.interval&&0===e.progress))).map((([e,t])=>{var r;return[e,{...t,state:t.resultsKey&&null!=(r=t.results)&&r.status?t.results.status:t.state}]})));return{...t,queries:a}},[Ae.SET_USER_OFFLINE]:()=>({...t,offline:r.offline}),[Ae.CREATE_DATASOURCE_STARTED]:()=>({...t,isDatasourceLoading:!0,errorMessage:null}),[Ae.CREATE_DATASOURCE_SUCCESS]:()=>({...t,isDatasourceLoading:!1,errorMessage:null,datasource:r.datasource}),[Ae.CREATE_DATASOURCE_FAILED]:()=>({...t,isDatasourceLoading:!1,errorMessage:r.err}),[Ae.SET_EDITOR_TAB_LAST_UPDATE]:()=>({...t,editorTabLastUpdatedAt:r.timestamp}),[Ae.SET_LAST_UPDATED_ACTIVE_TAB]:()=>({...t,lastUpdatedActiveTab:r.queryEditorId})};return r.type in a?a[r.type]():t},localStorageUsageInKilobytes:Ie(0),messageToasts:function(e=[],t){switch(t.type){case s.Q$:{const{payload:r}=t,a=e.slice();return r.noDuplicate&&a.find((e=>e.text===r.text))?e:[r,...e]}case s.l4:{const{payload:{id:r}}=t;return[...e].filter((e=>e.id!==r))}default:return e}},common:Ie(Oe.common),user:(e=Oe.user||{},t)=>t.type===Ce?t.user:e,impressionId:Ie((0,M.Ak)()),charts:i.A,datasources:(e,t)=>t.type===g.p3.SetDatasources?function(e,t){return t.type===g.p3.SetDatasources?{...e,...E()(t.datasources,"uid")}:t.type===g.p3.SetDatasource?{...e,[t.key]:t.datasource}:e||{}}(e,t):function(e,t){return t.type===ae.ZS?{...e,[(0,re.S)(t.datasource)]:t.datasource}:t.type===z.W?{...t.data.datasources}:e||{}}(e,t),dashboardInfo:function(e={},t){switch(t.type){case m._M:return{...e,...t.newInfo,last_modified_time:Math.round((new Date).getTime()/1e3)};case m.Ff:return{...e,metadata:{...e.metadata,native_filter_configuration:t.newInfo},last_modified_time:Math.round((new Date).getTime()/1e3)};case p.n:return{...e,...t.data.dashboardInfo};case m.rP:return{...e,filterBarOrientation:t.filterBarOrientation};case m.KP:return{...e,crossFiltersEnabled:t.crossFiltersEnabled};default:return e}},dashboardFilters:_.Ay,dataMask:l.A,nativeFilters:f.A,dashboardState:function(e={},t){const r={[p.n]:()=>({...e,...t.data.dashboardState}),[h.eK]:()=>({...e,css:t.css}),[h.r9](){const r=new Set(e.sliceIds);return r.add(t.slice.slice_id),{...e,sliceIds:Array.from(r)}},[h.m4](){const{sliceId:r}=t,a=new Set(e.sliceIds);return a.delete(r),{...e,sliceIds:Array.from(a)}},[h.hL]:()=>({...e,isStarred:t.isStarred}),[h.gH]:()=>({...e,isPublished:t.isPublished}),[h.kw]:()=>({...e,editMode:t.editMode}),[h.eZ](){const{maxUndoHistoryExceeded:r=!0}=t.payload;return{...e,maxUndoHistoryExceeded:r}},[h.zU]:()=>({...e}),[h.n2]:()=>({...e,colorScheme:t.colorScheme,updatedColorScheme:!0}),[h.ww]:()=>({...e,labelsColorMapMustSync:!0}),[h.fs]:()=>({...e,labelsColorMapMustSync:!1}),[h.tz]:()=>({...e,sharedLabelsColorsMustSync:!0}),[h.G7]:()=>({...e,sharedLabelsColorsMustSync:!1}),[h.bY](){const r={...e.expandedSlices},{sliceId:a}=t;return r[a]?delete r[a]:r[a]=!0,{...e,expandedSlices:r}},[h.pO]:()=>({...e,hasUnsavedChanges:!0}),[h.ff]:()=>({...e,dashboardIsSaving:!0}),[h.Mm]:()=>({...e,dashboardIsSaving:!1}),[h.sn]:()=>({...e,hasUnsavedChanges:!1,maxUndoHistoryExceeded:!1,editMode:!1,updatedColorScheme:!1,lastModifiedTime:t.lastModifiedTime}),[h.Cw](){const{hasUnsavedChanges:r}=t.payload;return{...e,hasUnsavedChanges:r}},[h.EI]:()=>({...e,refreshFrequency:t.refreshFrequency,shouldPersistRefreshFrequency:t.isPersistent,hasUnsavedChanges:t.isPersistent}),[h._q]:()=>({...e,isRefreshing:!0}),[h.im]:()=>({...e,isFiltersRefreshing:!0}),[h.mk]:()=>({...e,isFiltersRefreshing:!1}),[h.u4]:()=>({...e,isRefreshing:!1}),[h.TF]:()=>({...e,directPathToChild:t.path,directPathLastUpdated:Date.now()}),[h.aj](){const r=new Set(e.activeTabs);return r.delete(t.prevTabId),r.add(t.tabId),{...e,activeTabs:Array.from(r)}},[h.Nl]:()=>({...e,activeTabs:t.activeTabs}),[h.dv]:()=>({...e,overwriteConfirmMetadata:t.overwriteConfirmMetadata}),[h.Zh]:()=>({...e,focusedFilterField:{chartId:t.chartId,column:t.column}}),[h.Yx]:()=>e.focusedFilterField&&t.chartId===e.focusedFilterField.chartId&&t.column===e.focusedFilterField.column?{...e,focusedFilterField:null}:e,[h.S4]:()=>({...e,fullSizeChartId:t.chartId}),[h.qO]:()=>({...e,datasetsStatus:t.status})};return t.type in r?r[t.type]():e},dashboardLayout:P,sliceEntities:T.A,reports:function(e={},t){const r={[u.qJ](){var r,a;const{report:n,resourceId:o,creationMethod:s,filterField:i}=t,l=null==(r=n.result)?void 0:r.find((e=>e[i]===o));if(l)return{...e,[s]:{...e[s],[o]:l}};if(null!=e&&null!=(a=e[s])&&a[o]){const t={...e};return delete t[s][o],t}return{...e}},[u.hH](){const{result:r,id:a}=t.json,n={...r,id:a},o=n.dashboard||n.chart;return{...e,[n.creation_method]:{...e[n.creation_method],[o]:n}}},[u.CM](){const r={...t.json.result,id:t.json.id},a=r.dashboard||r.chart;return{...e,[r.creation_method]:{...e[r.creation_method],[a]:r}}},[u.HR](){const{report:r}=t,a=r.dashboard||r.chart;return{...e,[r.creation_method]:{...d()(e[r.creation_method],a)}}}};return t.type in r?r[t.type]():e},saveModal:function(e={},t){const r={[V.SET_SAVE_CHART_MODAL_VISIBILITY]:()=>({...e,isVisible:t.isVisible}),[V.FETCH_DASHBOARDS_SUCCEEDED]:()=>({...e,dashboards:t.choices}),[V.FETCH_DASHBOARDS_FAILED]:()=>({...e,saveModalAlert:`fetching dashboards failed for ${t.userId}`}),[V.SAVE_SLICE_FAILED]:()=>({...e,saveModalAlert:"Failed to save slice"}),[V.SAVE_SLICE_SUCCESS]:t=>({...e,data:t}),[z.W]:()=>({...t.data.saveModal})};return t.type in r?r[t.type]():e},explore:function(e={},t){const r={[J.DYNAMIC_PLUGIN_CONTROLS_READY]:()=>({...e,controls:t.controlsState}),[te.TOGGLE_FAVE_STAR]:()=>({...e,isStarred:t.isStarred}),[te.POST_DATASOURCE_STARTED]:()=>({...e,isDatasourceMetaLoading:!0}),[te.START_METADATA_LOADING]:()=>({...e,isDatasourceMetaLoading:!0}),[te.STOP_METADATA_LOADING]:()=>({...e,isDatasourceMetaLoading:!1}),[te.SYNC_DATASOURCE_METADATA]:()=>({...e,datasource:t.datasource}),[te.UPDATE_FORM_DATA_BY_DATASOURCE](){const r={...e.form_data},{prevDatasource:a,newDatasource:n}=t,o={...e.controls},s=[];a.id===n.id&&a.type===n.type||(r.datasource=n.uid),Object.entries(o).forEach((([e,t])=>{("column_name"===t.valueKey||"savedMetrics"in t||"columns"in t||"options"in t&&!Array.isArray(t.options))&&(r[e]=(0,ee.dI)(n,t,t.value),(0,X.A)(r[e]).length>0&&r[e]!==o[e].default&&s.push(e))}));const i={...e,controls:o,datasource:t.newDatasource};return{...i,form_data:r,controls:(0,Z.Eu)(i,r),controlsTransferred:s}},[te.FETCH_DATASOURCES_STARTED]:()=>({...e,isDatasourcesLoading:!0}),[te.SET_FIELD_VALUE](){const{controlName:r,value:a,validationErrors:n}=t;let o={...e.form_data,[r]:a};const s=e.form_data.metrics,i=e.form_data.column_config,l=o.viz_type;"metrics"===r&&s&&i&&(a.forEach(((e,t)=>{var r,a;!s.some((t=>(null==t?void 0:t.label)===(null==e?void 0:e.label)))&&(null==e?void 0:e.label)!==(null==(r=s[t])?void 0:r.label)&&i[null==(a=s[t])?void 0:a.label]&&(i[e.label]=i[s[t].label],delete i[s[t].label])})),o.column_config=i);const c=e.controls[t.controlName]||(0,ee.QC)(t.controlName,l)||null,d={...(0,ee.GW)(c,e,t.value)},u={...e.controls.column_config,...i&&{value:i}},m={...e,controls:{...e.controls,...c&&{[r]:d},..."metrics"===r&&{column_config:u}}},p={};Array.isArray(d.rerender)&&d.rerender.forEach((e=>{p[e]={...(0,ee.GW)(m.controls[e],m,m.controls[e].value)}}));const h=d.validationErrors||[];(n||[]).forEach((e=>{h.includes(e)||h.push(e)}));const _=h&&h.length>0,f="viz_type"===t.controlName&&t.value!==e.controls.viz_type.value;let y=e.controls;if(f){const r=new ee.a6(e.form_data).transform(t.value,e);o=r.formData,y=r.controlsState}return{...e,form_data:o,triggerRender:d.renderTrigger&&!_,controls:{...y,...c&&{[t.controlName]:{...d,validationErrors:h}},...p}}},[te.SET_EXPLORE_CONTROLS]:()=>({...e,controls:(0,Z.Eu)(e,t.formData)}),[te.SET_FORM_DATA]:()=>({...e,form_data:t.formData}),[te.UPDATE_CHART_TITLE]:()=>({...e,sliceName:t.sliceName}),[te.SET_SAVE_ACTION]:()=>({...e,saveAction:t.saveAction}),[te.CREATE_NEW_SLICE]:()=>({...e,slice:t.slice,controls:(0,Z.Eu)(e,t.form_data),can_add:t.can_add,can_download:t.can_download,can_overwrite:t.can_overwrite}),[te.SET_STASH_FORM_DATA](){const{form_data:r,hiddenFormData:a}=e,{fieldNames:n,isHidden:o}=t;if(o)return{...e,hiddenFormData:{...a,...K()(r,n)},form_data:d()(r,n)};const s=K()(a,n);return 0===Object.keys(s).length?e:{...e,form_data:{...r,...s},hiddenFormData:d()(a,n)}},[te.SLICE_UPDATED](){var r;return{...e,slice:{...e.slice,...t.slice,owners:t.slice.owners?t.slice.owners.map((e=>e.value)):null},sliceName:null!=(r=t.slice.slice_name)?r:e.sliceName,metadata:{...e.metadata,owners:t.slice.owners?t.slice.owners.map((e=>e.label)):null}}},[te.SET_FORCE_QUERY]:()=>({...e,force:t.force}),[z.W]:()=>({...t.data.explore})};return t.type in r?r[t.type]():e}};function Le({disableDebugger:e=!1,initialState:t=(0,Re.A)(Oe),rootReducers:r=we,...n}={}){return(0,a.U1)({preloadedState:t,reducer:{[o.F.reducerPath]:o.F.reducer,...r},middleware:De,devTools:!1,enhancers:[he],...n})}const Ne=Le()},69108:(e,t,r)=>{"use strict";r.d(t,{Ay:()=>h,Hk:()=>s,P7:()=>l,PA:()=>p,X:()=>u,aW:()=>m,eK:()=>o,hd:()=>d,kZ:()=>i,tG:()=>c});var a=r(5795),n=r(87903);const o={FRONTEND_CSRF_ERROR:"FRONTEND_CSRF_ERROR",FRONTEND_NETWORK_ERROR:"FRONTEND_NETWORK_ERROR",FRONTEND_TIMEOUT_ERROR:"FRONTEND_TIMEOUT_ERROR",GENERIC_DB_ENGINE_ERROR:"GENERIC_DB_ENGINE_ERROR",COLUMN_DOES_NOT_EXIST_ERROR:"COLUMN_DOES_NOT_EXIST_ERROR",TABLE_DOES_NOT_EXIST_ERROR:"TABLE_DOES_NOT_EXIST_ERROR",SCHEMA_DOES_NOT_EXIST_ERROR:"SCHEMA_DOES_NOT_EXIST_ERROR",CONNECTION_INVALID_USERNAME_ERROR:"CONNECTION_INVALID_USERNAME_ERROR",CONNECTION_INVALID_PASSWORD_ERROR:"CONNECTION_INVALID_PASSWORD_ERROR",CONNECTION_INVALID_HOSTNAME_ERROR:"CONNECTION_INVALID_HOSTNAME_ERROR",CONNECTION_PORT_CLOSED_ERROR:"CONNECTION_PORT_CLOSED_ERROR",CONNECTION_INVALID_PORT_ERROR:"CONNECTION_INVALID_PORT_ERROR",CONNECTION_HOST_DOWN_ERROR:"CONNECTION_HOST_DOWN_ERROR",CONNECTION_ACCESS_DENIED_ERROR:"CONNECTION_ACCESS_DENIED_ERROR",CONNECTION_UNKNOWN_DATABASE_ERROR:"CONNECTION_UNKNOWN_DATABASE_ERROR",CONNECTION_DATABASE_PERMISSIONS_ERROR:"CONNECTION_DATABASE_PERMISSIONS_ERROR",CONNECTION_MISSING_PARAMETERS_ERROR:"CONNECTION_MISSING_PARAMETERS_ERROR",OBJECT_DOES_NOT_EXIST_ERROR:"OBJECT_DOES_NOT_EXIST_ERROR",SYNTAX_ERROR:"SYNTAX_ERROR",CONNECTION_DATABASE_TIMEOUT:"CONNECTION_DATABASE_TIMEOUT",VIZ_GET_DF_ERROR:"VIZ_GET_DF_ERROR",UNKNOWN_DATASOURCE_TYPE_ERROR:"UNKNOWN_DATASOURCE_TYPE_ERROR",FAILED_FETCHING_DATASOURCE_INFO_ERROR:"FAILED_FETCHING_DATASOURCE_INFO_ERROR",TABLE_SECURITY_ACCESS_ERROR:"TABLE_SECURITY_ACCESS_ERROR",DATASOURCE_SECURITY_ACCESS_ERROR:"DATASOURCE_SECURITY_ACCESS_ERROR",DATABASE_SECURITY_ACCESS_ERROR:"DATABASE_SECURITY_ACCESS_ERROR",QUERY_SECURITY_ACCESS_ERROR:"QUERY_SECURITY_ACCESS_ERROR",MISSING_OWNERSHIP_ERROR:"MISSING_OWNERSHIP_ERROR",USER_ACTIVITY_SECURITY_ACCESS_ERROR:"USER_ACTIVITY_SECURITY_ACCESS_ERROR",DASHBOARD_SECURITY_ACCESS_ERROR:"DASHBOARD_SECURITY_ACCESS_ERROR",CHART_SECURITY_ACCESS_ERROR:"CHART_SECURITY_ACCESS_ERROR",OAUTH2_REDIRECT:"OAUTH2_REDIRECT",OAUTH2_REDIRECT_ERROR:"OAUTH2_REDIRECT_ERROR",BACKEND_TIMEOUT_ERROR:"BACKEND_TIMEOUT_ERROR",DATABASE_NOT_FOUND_ERROR:"DATABASE_NOT_FOUND_ERROR",MISSING_TEMPLATE_PARAMS_ERROR:"MISSING_TEMPLATE_PARAMS_ERROR",INVALID_TEMPLATE_PARAMS_ERROR:"INVALID_TEMPLATE_PARAMS_ERROR",RESULTS_BACKEND_NOT_CONFIGURED_ERROR:"RESULTS_BACKEND_NOT_CONFIGURED_ERROR",DML_NOT_ALLOWED_ERROR:"DML_NOT_ALLOWED_ERROR",INVALID_CTAS_QUERY_ERROR:"INVALID_CTAS_QUERY_ERROR",INVALID_CVAS_QUERY_ERROR:"INVALID_CVAS_QUERY_ERROR",SQLLAB_TIMEOUT_ERROR:"SQLLAB_TIMEOUT_ERROR",RESULTS_BACKEND_ERROR:"RESULTS_BACKEND_ERROR",ASYNC_WORKERS_ERROR:"ASYNC_WORKERS_ERROR",ADHOC_SUBQUERY_NOT_ALLOWED_ERROR:"ADHOC_SUBQUERY_NOT_ALLOWED_ERROR",INVALID_SQL_ERROR:"INVALID_SQL_ERROR",RESULT_TOO_LARGE_ERROR:"RESULT_TOO_LARGE_ERROR",GENERIC_COMMAND_ERROR:"GENERIC_COMMAND_ERROR",GENERIC_BACKEND_ERROR:"GENERIC_BACKEND_ERROR",INVALID_PAYLOAD_FORMAT_ERROR:"INVALID_PAYLOAD_FORMAT_ERROR",INVALID_PAYLOAD_SCHEMA_ERROR:"INVALID_PAYLOAD_SCHEMA_ERROR",MARSHMALLOW_ERROR:"MARSHMALLOW_ERROR",REPORT_NOTIFICATION_ERROR:"REPORT_NOTIFICATION_ERROR"},s={TABLE:"TABLE",VIEW:"VIEW"};var i;!function(e){e.Started="started",e.Stopped="stopped",e.Failed="failed",e.Pending="pending",e.Running="running",e.Scheduled="scheduled",e.Success="success",e.Fetching="fetching",e.TimedOut="timed_out"}(i||(i={}));const l=[i.Running,i.Started,i.Pending,i.Fetching,i.Scheduled],c=[i.Stopped,i.Failed,i.Success,i.TimedOut],d={id:"clientId2353",dbId:1,sql:"SELECT * FROM something",sqlEditorId:"dfsadfs",tab:"unimportant",tempTable:"",ctas:!1,cached:!1,errorMessage:null,extra:{progress:null},isDataPreview:!1,progress:0,resultsKey:null,state:i.Success,tempSchema:null,trackingUrl:null,templateParams:null,rows:42,queryLimit:100,limitingFactor:"",endDttm:1476910579693,duration:"",startDttm:1476910566092.96,time:{},user:{},userId:1,db:{},started:"",querylink:{},queryId:1,executedSql:"",output:"",actions:{},type:a.cT.Query,columns:[{column_name:"Column 1",type:"STRING",is_dttm:!1,type_generic:n.s.String},{column_name:"Column 3",type:"STRING",is_dttm:!1,type_generic:n.s.String},{column_name:"Column 2",type:"TIMESTAMP",is_dttm:!0,type_generic:n.s.Temporal}]},u={results:{displayLimitReached:!1,columns:[{column_name:"Column 1",type:"STRING",type_generic:n.s.String,is_dttm:!1},{column_name:"Column 3",type:"STRING",type_generic:n.s.String,is_dttm:!1},{column_name:"Column 2",type:"TIMESTAMP",type_generic:n.s.Temporal,is_dttm:!0}],data:[{"Column 1":"a","Column 2":"b","Column 3":"2014-11-11T00:00:00"}],expanded_columns:[],selected_columns:[{column_name:"Column 1",type:"STRING",type_generic:n.s.String,is_dttm:!1},{column_name:"Column 3",type:"STRING",type_generic:n.s.String,is_dttm:!1},{column_name:"Column 2",type:"TIMESTAMP",type_generic:n.s.Temporal,is_dttm:!0}],query:{limit:6}}},m={...d,...u};var p;!function(e){e.Row="row",e.Column="column"}(p||(p={}));const h={}},70700:(e,t,r)=>{"use strict";function a(e){return"string"==typeof e}function n(e){return"string"!=typeof e&&void 0!==(null==e?void 0:e.sqlExpression)&&void 0!==(null==e?void 0:e.label)&&(void 0===(null==e?void 0:e.expressionType)||"SQL"===(null==e?void 0:e.expressionType))}function o(e){return a(e)||n(e)}r.d(t,{Ay:()=>s,eh:()=>a,q0:()=>n,x$:()=>o});const s={}},72173:(e,t,r)=>{"use strict";r.d(t,{r9:()=>F,pO:()=>J,im:()=>ge,mk:()=>Te,_q:()=>Se,u4:()=>be,sn:()=>ee,m4:()=>k,Mm:()=>le,ff:()=>ie,aj:()=>Ne,Nl:()=>xe,n2:()=>Ce,ww:()=>de,fs:()=>ue,tz:()=>me,G7:()=>pe,qO:()=>je,TF:()=>we,kw:()=>K,Zh:()=>Ue,S4:()=>ke,eZ:()=>Qe,dv:()=>oe,EI:()=>re,Cw:()=>P,zU:()=>Re,bY:()=>G,hL:()=>Y,gH:()=>j,Yx:()=>Me,eK:()=>z,ft:()=>Ie,eu:()=>Ve,Xz:()=>ze,zM:()=>We,a9:()=>ye,Xk:()=>B,yG:()=>He,k9:()=>Z,Xd:()=>Ae,d1:()=>ve,t_:()=>te,Zc:()=>Ge,Hg:()=>Oe,JA:()=>fe,cv:()=>H,sE:()=>$,YF:()=>qe,r7:()=>De,Qn:()=>_e,wh:()=>$e,I:()=>Le,op:()=>X,ib:()=>Pe,GM:()=>Ye,G5:()=>Be,zT:()=>se,qK:()=>ae,MR:()=>M,jX:()=>V,ZX:()=>Fe,Jr:()=>W,sC:()=>Ke});var a=r(2404),n=r.n(a),o=r(84700),s=r(58561),i=r.n(s),l=r(35742),c=r(95579),d=r(62952),u=r(27366),m=r(51436),p=r(7148),h=r(76968),_=r(56655),f=r(2514),y=r(68458),E=r(91715),g=r(81151),T=r(83255),A=r(95272),b=r(36878),S=r(68921),v=r(12066),R=r(7735),I=r(35700),O=r(92475),C=r(48285),D=r(34975),w=r(78130),L=r(26415),N=r(73212);const q=new Set(["json_metadata","position_json"]);function x(e,t){return t.split(".").reduce(((e,t)=>{const r=null==e?void 0:e[t];return q.has(t)&&r?JSON.parse(r):r}),e)}var U=r(55556);const P="SET_UNSAVED_CHANGES";function M(e){return{type:P,payload:{hasUnsavedChanges:e}}}const F="ADD_SLICE",k="REMOVE_SLICE",Y="TOGGLE_FAVE_STAR";function Q(e){return{type:Y,isStarred:e}}function B(e){return function(t){return l.A.get({endpoint:`/api/v1/dashboard/favorite_status/?q=${i().encode([e])}`}).then((({json:e})=>{var r,a;t(Q(!(null==e||null==(r=e.result)||null==(a=r[0])||!a.value)))})).catch((()=>t((0,A.iB)((0,c.t)("There was an issue fetching the favorite status of this dashboard.")))))}}function H(e,t){return function(r){const a=`/api/v1/dashboard/${e}/favorites/`;return(t?l.A.delete({endpoint:a}):l.A.post({endpoint:a})).then((()=>{r(Q(!t))})).catch((()=>r((0,A.iB)((0,c.t)("There was an issue favoriting this dashboard.")))))}}const j="TOGGLE_PUBLISHED";function $(e,t){return function(r){return l.A.put({endpoint:`/api/v1/dashboard/${e}`,headers:{"Content-Type":"application/json"},body:JSON.stringify({published:t})}).then((()=>{r((0,A.WR)(t?(0,c.t)("This dashboard is now published"):(0,c.t)("This dashboard is now hidden"))),r(function(e){return{type:j,isPublished:e}}(t))})).catch((()=>{r((0,A.iB)((0,c.t)("You do not have permissions to edit this dashboard.")))}))}}const G="TOGGLE_EXPAND_SLICE";function V(e){return{type:G,sliceId:e}}const z="UPDATE_CSS";function W(e){return{type:z,css:e}}const K="SET_EDIT_MODE";function X(e){return{type:K,editMode:e}}const J="ON_CHANGE";function Z(){return{type:J}}const ee="ON_SAVE";function te(e){return{type:ee,lastModifiedTime:e}}const re="SET_REFRESH_FREQUENCY";function ae(e,t=!1){return{type:re,refreshFrequency:e,isPersistent:t}}function ne(e){return t=>{t(te(e)),t(o.IE.clearHistory())}}const oe="SET_OVERRIDE_CONFIRM";function se(e){return{type:oe,overwriteConfirmMetadata:e}}const ie="SAVE_DASHBOARD_STARTED",le="SAVE_DASHBOARD_FINISHED";function ce(){return{type:le}}const de="SET_DASHBOARD_LABELS_COLORMAP_SYNCABLE",ue="SET_DASHBOARD_LABELS_COLORMAP_SYNCED",me="SET_DASHBOARD_SHARED_LABELS_COLORS_SYNCABLE",pe="SET_DASHBOARD_SHARED_LABELS_COLORS_SYNCED";function he(){return{type:de}}const _e=e=>async(t,r)=>{const{dashboardInfo:a}=r();t((0,C.PD)({metadata:{...(null==a?void 0:a.metadata)||{},...e}}))};function fe(e,t,r){return(a,n)=>{var o,s,i,p,h,_,f,y;a({type:O.YX}),a({type:ie});const{dashboardFilters:E,dashboardLayout:P}=n(),M=P.present;Object.values(E).forEach((e=>{var t;const{chartId:r}=e,n=e.directPathToFilter.slice().pop(),o=((null==(t=M[n])?void 0:t.parents)||[]).slice();o.push(n),a((0,w.Zg)(r,o))}));const F=(0,b.A)((0,S.ug)()),k=function(e){return Object.values(e).reduce(((e,{chartId:t,scopes:r})=>{const a=Object.keys(r).reduce(((e,t)=>({...e,[t]:r[t]})),{});return{...e,[t]:a}}),{})}(E),{certified_by:Y,certification_details:Q,css:B,dashboard_title:H,owners:j,roles:$,slug:G}=e,V=e=>void 0!==e.id,z=null==(o=e.metadata)?void 0:o.cross_filters_enabled,W=null==(s=e.metadata)?void 0:s.color_scheme,K=(null==(i=e.metadata)?void 0:i.label_colors)||{},X=(0,U.ik)(null==(p=e.metadata)?void 0:p.shared_label_colors),J={...e,certified_by:Y||"",certification_details:Y&&Q?Q:"",css:B||"",dashboard_title:H||(0,c.t)("[ untitled dashboard ]"),owners:(0,d.A)(j).map((e=>V(e)?e.id:e)),roles:(0,u.G7)(u.TO.DashboardRbac)?(0,d.A)($).map((e=>V(e)?e.id:e)):void 0,slug:G||null,metadata:{...e.metadata,color_namespace:(0,U.Z6)(null==(h=e.metadata)?void 0:h.color_namespace),color_scheme:W||"",color_scheme_domain:W?(0,U.bp)(W):[],expanded_slices:(null==(_=e.metadata)?void 0:_.expanded_slices)||{},label_colors:K,shared_label_colors:(0,U.t7)(X),map_label_colors:(0,U.xV)(K),refresh_frequency:(null==(f=e.metadata)?void 0:f.refresh_frequency)||0,timed_refresh_immune_slices:(null==(y=e.metadata)?void 0:y.timed_refresh_immune_slices)||[],cross_filters_enabled:(0,T.b)(z)}},Z=()=>{const{dashboardLayout:e,charts:t,dashboardInfo:{metadata:r}}=n();return(0,T.k)(e.present,r,t)},ee=async e=>{const{error:t,message:r}=await(0,m.h4)(e);let n=(0,c.t)("Sorry, an unknown error occurred");t&&(n=(0,c.t)("Sorry, there was an error saving this dashboard: %s",t)),"string"==typeof r&&"Forbidden"===r&&(n=(0,c.t)("You do not have permission to edit this dashboard")),a(ce()),a((0,A.iB)(n))};if([g.LA,g.Fq].includes(r)){const{chartConfiguration:n,globalChartConfiguration:o}=Z(),s=r===g.Fq?e:{certified_by:J.certified_by,certification_details:J.certification_details,css:J.css,dashboard_title:J.dashboard_title,slug:J.slug,owners:J.owners,roles:J.roles,json_metadata:(0,v.J)({...(null==J?void 0:J.metadata)||{},default_filters:(0,v.J)(F),filter_scopes:k,chart_configuration:n,global_chart_configuration:o})},i=()=>l.A.put({endpoint:`/api/v1/dashboard/${t}`,headers:{"Content-Type":"application/json"},body:JSON.stringify(s)}).then((e=>(e=>{const r=e.json.result,n=e.json.last_modified_time;if(r.json_metadata){const e=JSON.parse(r.json_metadata);a(_e(e)),e.chart_configuration&&a({type:C.iI,chartConfiguration:e.chart_configuration}),e.native_filter_configuration&&a({type:L.Xf,filterConfig:e.native_filter_configuration}),l.A.get({endpoint:`/api/v1/dashboard/${t}/datasets`,headers:{"Content-Type":"application/json"}}).then((({json:e})=>{var t;const r=null!=(t=null==e?void 0:e.result)?t:[];r.length&&a((0,D.nC)(r))}))}return n&&a(ne(n)),a(ce()),window.history.pushState({event:"dashboard_properties_changed"},"",`/superset/dashboard/${G||t}/`),a((0,A.WR)((0,c.t)("This dashboard was saved successfully."))),a(se(void 0)),e})(e))).catch((e=>ee(e)));return new Promise(((e,n)=>{(0,u.G7)(u.TO.ConfirmDashboardDiff)&&r!==g.Fq?l.A.get({endpoint:`/api/v1/dashboard/${t}`}).then((r=>{const o=r.json.result,i=(l=o,c=s,N.Zd.map((e=>({keyPath:e,...e.split(".").find((e=>q.has(e)))?{oldValue:JSON.stringify(x(l,e),null,2)||"{}",newValue:JSON.stringify(x(c,e),null,2)||"{}"}:{oldValue:x(l,e)||"",newValue:x(c,e)||""}}))).filter((({oldValue:e,newValue:t})=>e!==t)));var l,c;return i.length>0?(a(se({updatedAt:o.changed_on,updatedBy:o.changed_by_name,overwriteConfirmItems:i,dashboardId:t,data:s})),n(i)):e()})):e()})).then(i).catch((e=>{const r=(0,c.t)("Please confirm the overwrite values.");a((0,R.logEvent)(I.HH,{dashboard_id:t,items:e})),a((0,A.iB)(r))}))}"positions"in J&&!("positions"in J.metadata)&&(J.metadata.positions=J.positions),J.metadata.default_filters=(0,v.J)(F),J.metadata.filter_scopes=k;const te={dashboard_title:J.dashboard_title,css:J.css,duplicate_slices:J.duplicate_slices,json_metadata:JSON.stringify(J.metadata)};return l.A.post({endpoint:`/api/v1/dashboard/${t}/copy/`,jsonPayload:te}).then((e=>(e=>{const t=e.json.result.last_modified_time;t&&a(ne(t));const{chartConfiguration:r,globalChartConfiguration:n}=Z();return a((0,C.Iw)({chartConfiguration:r,globalChartConfiguration:n})),a(ce()),a((0,A.WR)((0,c.t)("This dashboard was saved successfully."))),e})(e))).catch((e=>ee(e)))}}function ye(e=[],t=!1,r=0,a){return(n,o)=>{if(!r)return void e.forEach((e=>n((0,f.refreshChart)(e,t,a))));const{metadata:s}=o().dashboardInfo,i=Math.max(r,s.stagger_time||5e3);"boolean"!=typeof s.stagger_refresh&&(s.stagger_refresh=void 0===s.stagger_refresh||"true"===s.stagger_refresh);const l=s.stagger_refresh?i/(e.length-1):0;e.forEach(((e,r)=>{setTimeout((()=>n((0,f.refreshChart)(e,t,a))),l*r)}))}}const Ee=(e,t,r,a,n)=>new Promise((o=>{n(ye(e,t,r,a)),o()})),ge="ON_FILTERS_REFRESH",Te="ON_FILTERS_REFRESH_SUCCESS";function Ae(){return{type:Te}}const be="ON_REFRESH_SUCCESS",Se="ON_REFRESH";function ve(e=[],t=!1,r=0,a){return n=>{n({type:Se}),Ee(e,t,r,a,n).then((()=>{n({type:be}),n({type:ge})}))}}const Re="SHOW_BUILDER_PANE";function Ie(e){return(t,r)=>{const{sliceEntities:a}=r(),n=a.slices[e];if(!n)return t((0,A.Zd)("Sorry, there is no chart definition associated with the chart trying to be added."));const o={...n.form_data,slice_id:n.slice_id},s={...y.b,id:e,form_data:(0,E.S7)(o)};return Promise.all([t((0,f.addChart)(s,e)),t((0,D.VZ)(o.datasource))]).then((()=>{t({type:F,slice:n})}))}}function Oe(e){return t=>{t({type:k,sliceId:e}),t((0,f.removeChart)(e)),(0,p.Ay)().removeSlice(e)}}const Ce="SET_COLOR_SCHEME";function De(e){return{type:Ce,colorScheme:e}}const we="SET_DIRECT_PATH";function Le(e){return{type:we,path:e}}const Ne="SET_ACTIVE_TAB";function qe(e,t){return{type:Ne,tabId:e,prevTabId:t}}const xe="SET_ACTIVE_TABS",Ue="SET_FOCUSED_FILTER_FIELD";function Pe(e,t){return{type:Ue,chartId:e,column:t}}const Me="UNSET_FOCUSED_FILTER_FIELD";function Fe(e,t){return{type:Me,chartId:e,column:t}}const ke="SET_FULL_SIZE_CHART_ID";function Ye(e){return{type:ke,chartId:e}}const Qe="SET_MAX_UNDO_HISTORY_EXCEEDED";function Be(e=!0){return{type:Qe,payload:{maxUndoHistoryExceeded:e}}}function He(){return(e,t)=>{const{dashboardLayout:r}=t(),a=r.past.length;return e((0,A.Zd)((0,c.t)("You have used all %(historyLength)s undo slots and will not be able to fully undo subsequent actions. You may save your current state to reset the history.",{historyLength:a})))}}const je="SET_DATASETS_STATUS";function $e(e){return{type:je,status:e}}const Ge=()=>async(e,t)=>{const{dashboardInfo:{id:r,metadata:a},dashboardState:{labelsColorMapMustSync:n,sharedLabelsColorsMustSync:o}}=t();(n||o)&&(e({type:ue}),e({type:pe}),(async(e,t)=>{l.A.put({endpoint:`/api/v1/dashboard/${e}/colors?mark_updated=false`,headers:{"Content-Type":"application/json"},body:JSON.stringify({color_namespace:t.color_namespace,color_scheme:t.color_scheme,color_scheme_domain:t.color_scheme_domain||[],shared_label_colors:t.shared_label_colors||[],map_label_colors:t.map_label_colors||{},label_colors:t.label_colors||{}})})})(r,a))},Ve=e=>async t=>{try{const r=e.label_colors||{};let a=!1;const o=e.shared_label_colors||[];!Array.isArray(o)&&Object.keys(o).length>0&&(a=!0,t(_e({shared_label_colors:[]})));const s=!!e.map_label_colors;let i=e.color_scheme;const l=(0,h.A)(),c=l.get(i,!0),d=!!i&&!c;if(d){const e=l.defaultKey,r=(null==e?void 0:e.toString())||"supersetColors";a=!0,i=r,t(De(i)),t(_e({color_scheme:i}))}const u=i?(0,U.bp)(i):[],m=e.color_scheme_domain||[];n()(u,m)||(a=!0,t(_e({color_scheme_domain:u})));const p=!s||d;(0,U.D2)(e,p),p&&(a=!0,t(_e({map_label_colors:(0,U.xV)(r)}))),a&&t(he())}catch(e){console.error("Failed to update dashboard color on load:",e)}},ze=e=>(t,r)=>{(0,_.A)((()=>{const{dashboardState:{labelsColorMapMustSync:a}}=r(),n=e.label_colors||{},o=(0,U.Hq)(e.map_label_colors||{},n),s=(0,U.xV)(n),i=(0,U.pb)(o,s,n);i||t(_e({map_label_colors:s})),i||a||t(he())}),500)},We=(e,t=!1)=>(r,a)=>{(0,_.A)((()=>{const{dashboardState:{sharedLabelsColorsMustSync:o}}=a(),s=(0,U.ik)(e.shared_label_colors),i=(0,U.t7)(t?[]:s),l=!n()(s.sort(),i.sort());l&&r(_e({shared_label_colors:i})),l&&!o&&r({type:me})}),500)},Ke=e=>(t,r)=>{try{const{dashboardInfo:{metadata:t},charts:a}=r(),n=t.color_scheme,o=(0,p.Ay)(),s=(0,U.ik)(t.shared_label_colors),i=t.label_colors||{},l=(0,U.Hq)(t.map_label_colors||{},i),c=[];if(e.length>0){const t=new Set(s);e.forEach((e=>{const r=a[e],s=r.form_data||r.latestQueryFormData;if(o.setOwnColorScheme(s.slice_id,s.color_scheme),n)return;const d=s.color_scheme,u=o.chartsLabelsMap.get(s.slice_id),m=((null==u?void 0:u.labels)||[]).filter((e=>!t.has(e)&&!i.hasOwnProperty(e))),p=new Set(m.map((e=>l[e])).filter(Boolean)),h=new Set((0,U.bp)(d));[...p].some((e=>!h.has(e)))&&c.push(...m)}))}const d=c.length>0&&c,u=!d;(0,U.D2)(t,d,u)}catch(e){console.error("Failed to update colors for new charts and labels:",e)}}},72239:(e,t,r)=>{"use strict";function a(e){return String(e).trim()}r.d(t,{A:()=>a})},72391:(e,t,r)=>{"use strict";r.d(t,{a:()=>s});var a=r(44711),n=r(70360);class o extends a.A{constructor(...e){super(...e),this.name="ExtensionsRegistry"}}const s=(0,n.A)(o,{})},72619:(e,t,r)=>{"use strict";r.d(t,{A:()=>c});var a=r(43561),n=r(95579),o=r(49588),s=r(81151);const i={[o.oT]:{width:s.nm,height:50},[o.QP]:{width:s.nm,background:s.kn},[o.n6]:null,[o.PP]:{text:(0,n.t)("New header"),headerSize:s.W9,background:s.kn},[o.xY]:{width:s.nm,height:50},[o._8]:{background:s.kn},[o.wc]:null,[o.B8]:{text:"",defaultText:(0,n.t)("Tab title"),placeholder:(0,n.t)("Tab title")},[o.rG]:{width:s.cV,background:s.kn}};function l(e){return`${e}-${(0,a.Ak)()}`}function c(e,t,r=[]){return{type:e,id:l(e),children:[],parents:r,meta:{...i[e],...t}}}},73212:(e,t,r)=>{"use strict";r.d(t,{As:()=>o,Xy:()=>u,Zd:()=>m,_3:()=>s,_s:()=>c,e2:()=>h,jO:()=>d,l6:()=>l,p_:()=>i,qe:()=>p});var a=r(5795),n=r(81151);const o={id:0,type:a.cT.Table,uid:"_placeholder_",datasource_name:"",table_name:"",columns:[],column_types:[],metrics:[],column_formats:{},currency_formats:{},verbose_map:{},main_dttm_col:"",description:""},s=53,i=32,l=260,c=550,d=80,u=374,m=["css","json_metadata.filter_scopes"],p=10,h={rootPath:[n.wv],excluded:[]}},73992:(e,t,r)=>{"use strict";var a,n;function o(e){return void 0===e.filterType&&e.hasOwnProperty("values")}function s(e){return"filter_select"===e.filterType&&e.hasOwnProperty("values")}function i(e){return e.type===a.NativeFilter}function l(e){var t,r;return i(e)&&(null==(t=e.dataMask)||null==(r=t.filterState)?void 0:r.value)}function c(e){return e.type===a.Divider}r.d(t,{Ay:()=>d,EH:()=>a,O2:()=>c,Ub:()=>o,ee:()=>l,p_:()=>n,qQ:()=>i,ve:()=>s}),function(e){e.NativeFilter="NATIVE_FILTER",e.Divider="DIVIDER"}(a||(a={})),function(e){e.NativeFilters="nativeFilters",e.CrossFilters="crossFilters"}(n||(n={}));const d={}},74680:(e,t,r)=>{"use strict";r.r(t),r.d(t,{ADD_QUERY_EDITOR:()=>I,CHANGE_DATA_PREVIEW_ID:()=>fe,CLEAR_DESTROYED_QUERY_EDITOR:()=>Re,CLEAR_INACTIVE_QUERIES:()=>pe,CLEAR_QUERY_RESULTS:()=>he,CLONE_QUERY_TO_NEW_TAB:()=>D,COLLAPSE_TABLE:()=>P,COST_ESTIMATE_FAILED:()=>ge,COST_ESTIMATE_RETURNED:()=>Ee,COST_ESTIMATE_STARTED:()=>ye,CREATE_DATASOURCE_FAILED:()=>be,CREATE_DATASOURCE_STARTED:()=>Te,CREATE_DATASOURCE_SUCCESS:()=>Ae,CtasEnum:()=>we,END_QUERY:()=>q,EXPAND_TABLE:()=>U,LOAD_QUERY_EDITOR:()=>re,MERGE_TABLE:()=>L,MIGRATE_QUERY:()=>Z,MIGRATE_QUERY_EDITOR:()=>K,MIGRATE_TABLE:()=>J,MIGRATE_TAB_HISTORY:()=>X,QUERY_EDITOR_PERSIST_HEIGHT:()=>z,QUERY_EDITOR_SAVED:()=>C,QUERY_EDITOR_SETDB:()=>M,QUERY_EDITOR_SET_AUTORUN:()=>Q,QUERY_EDITOR_SET_CATALOG:()=>F,QUERY_EDITOR_SET_CURSOR_POSITION:()=>H,QUERY_EDITOR_SET_FUNCTION_NAMES:()=>V,QUERY_EDITOR_SET_QUERY_LIMIT:()=>j,QUERY_EDITOR_SET_SCHEMA:()=>k,QUERY_EDITOR_SET_SELECTED_TEXT:()=>G,QUERY_EDITOR_SET_SQL:()=>B,QUERY_EDITOR_SET_TEMPLATE_PARAMS:()=>$,QUERY_EDITOR_SET_TITLE:()=>Y,QUERY_EDITOR_TOGGLE_LEFT_BAR:()=>W,QUERY_FAILED:()=>me,QUERY_SUCCESS:()=>ue,REFRESH_QUERIES:()=>oe,REMOVE_DATA_PREVIEW:()=>_e,REMOVE_QUERY:()=>x,REMOVE_QUERY_EDITOR:()=>w,REMOVE_TABLES:()=>N,REQUEST_QUERY_RESULTS:()=>de,RESET_STATE:()=>R,RUN_QUERY:()=>ie,SET_ACTIVE_QUERY_EDITOR:()=>te,SET_ACTIVE_SOUTHPANE_TAB:()=>ne,SET_DATABASES:()=>ee,SET_EDITOR_TAB_LAST_UPDATE:()=>Se,SET_LAST_UPDATED_ACTIVE_TAB:()=>ve,SET_TABLES:()=>ae,SET_USER_OFFLINE:()=>se,START_QUERY:()=>le,STOP_QUERY:()=>ce,UPDATE_QUERY_EDITOR:()=>O,addDangerToast:()=>Ce,addInfoToast:()=>Ie,addNewQueryEditor:()=>nt,addQueryEditor:()=>at,addSavedQueryToTabState:()=>vt,addSuccessToast:()=>Oe,addTable:()=>xt,addWarningToast:()=>De,changeDataPreviewId:()=>Mt,clearDestoryedQueryEditor:()=>ht,clearInactiveQueries:()=>Be,clearQueryResults:()=>Ve,cloneQueryToNewTab:()=>ot,collapseTable:()=>Yt,convertQueryToClient:()=>Ue,convertQueryToServer:()=>xe,createCtasDatasource:()=>er,createDatasource:()=>Zt,createDatasourceFailed:()=>Jt,createDatasourceStarted:()=>Kt,createDatasourceSuccess:()=>Xt,estimateQueryCost:()=>Qe,expandTable:()=>kt,fetchQueryEditor:()=>ut,fetchQueryResults:()=>Ke,formatQuery:()=>Dt,getUpToDateQuery:()=>Pe,loadQueryEditor:()=>ct,mergeTable:()=>qt,persistEditorHeight:()=>jt,popDatasourceQuery:()=>Wt,popPermalink:()=>$t,popQuery:()=>zt,popSavedQuery:()=>Vt,popStoredQuery:()=>Gt,postStopQuery:()=>et,queryEditorSetAndSaveSql:()=>Ct,queryEditorSetAutorun:()=>At,queryEditorSetCatalog:()=>gt,queryEditorSetCursorPosition:()=>Ot,queryEditorSetDb:()=>Et,queryEditorSetQueryLimit:()=>wt,queryEditorSetSchema:()=>Tt,queryEditorSetSelectedText:()=>Nt,queryEditorSetSql:()=>It,queryEditorSetTemplateParams:()=>Lt,queryEditorSetTitle:()=>bt,queryFailed:()=>$e,querySuccess:()=>je,reFetchQueryResults:()=>Ft,reRunQuery:()=>Ze,refreshQueries:()=>Bt,removeAllOtherQueryEditors:()=>ft,removeDataPreview:()=>ze,removeQuery:()=>yt,removeQueryEditor:()=>_t,removeTables:()=>Qt,requestQueryResults:()=>We,resetState:()=>Me,runQuery:()=>Xe,runQueryFromSqlEditor:()=>Je,runTablePreviewQuery:()=>Ut,saveQuery:()=>St,scheduleQuery:()=>Ye,setActiveQueryEditor:()=>it,setActiveSouthPaneTab:()=>mt,setDatabases:()=>tt,setEditorTabLastUpdate:()=>ke,setLastUpdatedActiveTab:()=>st,setTables:()=>dt,setUserOffline:()=>Ht,startQuery:()=>He,stopQuery:()=>Ge,switchQueryEditor:()=>lt,syncQueryEditor:()=>rt,syncTable:()=>Pt,toggleLeftBar:()=>pt,updateQueryEditor:()=>Fe,updateSavedQuery:()=>Rt});var a=r(79674),n=r.n(a),o=r(40866),s=r.n(o),i=r(43561),l=r(58561),c=r.n(l),d=r(95579),u=r(35742),m=r(51436),p=r(1639),h=r(27366),_=r(7089),f=r(95272),y=r(35700),E=r(38708),g=r(7735);const T=/^Untitled Query (\d+)$/,A="Untitled Query ",b=(e,t=`${A}1`)=>{const r=(0,d.t)(t);if(e.length>0){const t=e.filter((e=>{var t;return null==(t=e.name)?void 0:t.match(T)})).map((e=>+e.name.replace(A,"")));if(t.length>0){const e=Math.max(...t);return(0,d.t)("%s%s",A,e+1)}return r}return r};var S=r(55045),v=r(85278);const R="RESET_STATE",I="ADD_QUERY_EDITOR",O="UPDATE_QUERY_EDITOR",C="QUERY_EDITOR_SAVED",D="CLONE_QUERY_TO_NEW_TAB",w="REMOVE_QUERY_EDITOR",L="MERGE_TABLE",N="REMOVE_TABLES",q="END_QUERY",x="REMOVE_QUERY",U="EXPAND_TABLE",P="COLLAPSE_TABLE",M="QUERY_EDITOR_SETDB",F="QUERY_EDITOR_SET_CATALOG",k="QUERY_EDITOR_SET_SCHEMA",Y="QUERY_EDITOR_SET_TITLE",Q="QUERY_EDITOR_SET_AUTORUN",B="QUERY_EDITOR_SET_SQL",H="QUERY_EDITOR_SET_CURSOR_POSITION",j="QUERY_EDITOR_SET_QUERY_LIMIT",$="QUERY_EDITOR_SET_TEMPLATE_PARAMS",G="QUERY_EDITOR_SET_SELECTED_TEXT",V="QUERY_EDITOR_SET_FUNCTION_NAMES",z="QUERY_EDITOR_PERSIST_HEIGHT",W="QUERY_EDITOR_TOGGLE_LEFT_BAR",K="MIGRATE_QUERY_EDITOR",X="MIGRATE_TAB_HISTORY",J="MIGRATE_TABLE",Z="MIGRATE_QUERY",ee="SET_DATABASES",te="SET_ACTIVE_QUERY_EDITOR",re="LOAD_QUERY_EDITOR",ae="SET_TABLES",ne="SET_ACTIVE_SOUTHPANE_TAB",oe="REFRESH_QUERIES",se="SET_USER_OFFLINE",ie="RUN_QUERY",le="START_QUERY",ce="STOP_QUERY",de="REQUEST_QUERY_RESULTS",ue="QUERY_SUCCESS",me="QUERY_FAILED",pe="CLEAR_INACTIVE_QUERIES",he="CLEAR_QUERY_RESULTS",_e="REMOVE_DATA_PREVIEW",fe="CHANGE_DATA_PREVIEW_ID",ye="COST_ESTIMATE_STARTED",Ee="COST_ESTIMATE_RETURNED",ge="COST_ESTIMATE_FAILED",Te="CREATE_DATASOURCE_STARTED",Ae="CREATE_DATASOURCE_SUCCESS",be="CREATE_DATASOURCE_FAILED",Se="SET_EDITOR_TAB_LAST_UPDATE",ve="SET_LAST_UPDATED_ACTIVE_TAB",Re="CLEAR_DESTROYED_QUERY_EDITOR",Ie=f.Zt,Oe=f.WR,Ce=f.iB,De=f.Zd,we={Table:"TABLE",View:"VIEW"},Le=(0,d.t)("The query couldn't be loaded"),Ne={id:"remoteId",db_id:"dbId",label:"name",template_parameters:"templateParams"},qe=e=>t=>n()(t,((t,r)=>r in e?e[r]:r)),xe=qe(s()(Ne)),Ue=qe(Ne);function Pe(e,t,r){const{sqlLab:{unsavedQueryEditor:a,queryEditors:n}}=e,o=null!=r?r:t.id;return{id:o,...n.find((e=>e.id===o)),...o===a.id&&a}}function Me(e){return(t,r)=>{const{common:a}=r(),n=(0,S.A)({...(0,E.A)(),common:a,...e});t({type:R,sqlLabInitialState:n.sqlLab}),(0,v.Rm)(t,n)}}function Fe(e){return{type:O,alterations:e}}function ke(e){return{type:Se,timestamp:e}}function Ye(e){return t=>u.A.post({endpoint:"/api/v1/saved_query/",jsonPayload:e,stringify:!1}).then((()=>t(Oe((0,d.t)("Your query has been scheduled. To see details of your query, navigate to Saved queries"))))).catch((()=>t(Ce((0,d.t)("Your query could not be scheduled")))))}function Qe(e){return(t,r)=>{const{dbId:a,catalog:n,schema:o,sql:s,selectedText:i,templateParams:l}=Pe(r(),e),c={database_id:a,catalog:n,schema:o,sql:i||s,template_params:JSON.parse(l||"{}")};return Promise.all([t({type:ye,query:e}),u.A.post({endpoint:"/api/v1/sqllab/estimate/",body:JSON.stringify(c),headers:{"Content-Type":"application/json"}}).then((({json:r})=>t({type:Ee,query:e,json:r}))).catch((r=>(0,m.h4)(r).then((r=>{const a=r.error||r.statusText||(0,d.t)("Failed at retrieving results");return t({type:ge,query:e,error:a})}))))])}}function Be(e){return{type:pe,interval:e}}function He(e,t){return Object.assign(e,{id:e.id?e.id:(0,i.Ak)(11),progress:0,startDttm:(0,_.tB)(),state:e.runAsync?"pending":"running",cached:!1}),{type:le,query:e,runPreviewOnly:t}}function je(e,t){return{type:ue,query:e,results:t}}function $e(e,t,r,a){return function(n){const o={has_err:!0,start_offset:e.startDttm,ts:(new Date).getTime()};null==a||a.forEach((({error_type:e,extra:t})=>{var r;((null==t||null==(r=t.issue_codes)?void 0:r.map((({message:e})=>e)))||[e]).forEach((t=>{n((0,g.logEvent)(y.pi,{...o,error_type:e,error_details:t}))}))})),n({type:me,query:e,msg:t,link:r,errors:a})}}function Ge(e){return{type:ce,query:e}}function Ve(e){return{type:he,query:e}}function ze(e){return{type:_e,table:e}}function We(e){return{type:de,query:e}}function Ke(e,t,r){return function(a,n){var o,s;const{SQLLAB_QUERY_RESULT_TIMEOUT:i}=null!=(o=null==(s=n().common)?void 0:s.conf)?o:{};a(We(e));const l=c().encode({key:e.resultsKey,rows:t||null}),p=null!=r?r:i,h=new AbortController;return u.A.get({endpoint:`/api/v1/sqllab/results/?q=${l}`,parseMethod:"json-bigint",...p&&{timeout:p,signal:h.signal}}).then((({json:t})=>a(je(e,t)))).catch((t=>{h.abort(),(0,m.h4)(t).then((t=>{const r=t.error||t.statusText||(0,d.t)("Failed at retrieving results");return a($e(e,r,t.link,t.errors))}))}))}}function Xe(e,t){return function(r){r(He(e,t));const a={client_id:e.id,database_id:e.dbId,json:!0,runAsync:e.runAsync,catalog:e.catalog,schema:e.schema,sql:e.sql,sql_editor_id:e.sqlEditorId,tab:e.tab,tmp_table_name:e.tempTable,select_as_cta:e.ctas,ctas_method:e.ctas_method,templateParams:e.templateParams,queryLimit:e.queryLimit,expand_data:!0},n=window.location.search||"";return u.A.post({endpoint:`/api/v1/sqllab/execute/${n}`,body:JSON.stringify(a),headers:{"Content-Type":"application/json"},parseMethod:"json-bigint"}).then((({json:t})=>{e.runAsync||r(je(e,t))})).catch((t=>(0,m.h4)(t).then((t=>{let a=t.error||t.message||t.statusText||(0,d.t)("Unknown error");a.includes("CSRF token")&&(a=(0,d.t)(p.HL.SESSION_TIMED_OUT)),r($e(e,a,t.link,t.errors))}))))}}function Je(e,t,r,a,n,o){return function(s,i){const l=Pe(i(),t,t.id);s(Xe({dbId:l.dbId,sql:l.selectedText||l.sql,sqlEditorId:l.id,tab:l.name,catalog:l.catalog,schema:l.schema,tempTable:a,templateParams:l.templateParams,queryLimit:l.queryLimit||r,runAsync:!!e&&e.allow_run_async,ctas:n,ctas_method:o,updateTabState:!l.selectedText}))}}function Ze(e){return function(t){t(Xe({...e,id:(0,i.Ak)(11)}))}}function et(e){return function(t){return u.A.post({endpoint:"/api/v1/query/stop",body:JSON.stringify({client_id:e.id}),headers:{"Content-Type":"application/json"}}).then((()=>t(Ge(e)))).then((()=>t(Oe((0,d.t)("Query was stopped."))))).catch((()=>t(Ce((0,d.t)("Failed to stop query.")))))}}function tt(e){return{type:ee,databases:e}}function rt(e){return function(t,r){const{tables:a,queries:n}=r().sqlLab,o=a.filter((t=>t.inLocalStorage&&t.queryEditorId===e.id)),s=Object.values(n).filter((t=>t.inLocalStorage&&t.sqlEditorId===e.id));return u.A.post({endpoint:"/tabstateview/",postPayload:{queryEditor:e}}).then((({json:r})=>{const a={...e,id:r.id.toString(),inLocalStorage:!1,loaded:!0};return t({type:K,oldQueryEditor:e,newQueryEditor:a}),t({type:X,oldId:e.id,newId:a.id}),Promise.all([...o.map((e=>function(e,t,r){return u.A.post({endpoint:encodeURI("/tableschemaview/"),postPayload:{table:{...e,queryEditorId:t}}}).then((({json:a})=>{const n={...e,id:a.id,queryEditorId:t};return r({type:J,oldTable:e,newTable:n})})).catch((()=>r(De((0,d.t)("Unable to migrate table schema state to backend. Superset will retry later. Please contact your administrator if this problem persists.")))))}(e,a.id,t))),...s.map((e=>function(e,t,r){return u.A.post({endpoint:encodeURI(`/tabstateview/${t}/migrate_query`),postPayload:{queryId:e}}).then((()=>r({type:Z,queryId:e,queryEditorId:t}))).catch((()=>r(De((0,d.t)("Unable to migrate query state to backend. Superset will retry later. Please contact your administrator if this problem persists.")))))}(e.id,a.id,t)))])})).catch((()=>t(De((0,d.t)("Unable to migrate query editor state to backend. Superset will retry later. Please contact your administrator if this problem persists.")))))}}function at(e){const t={...e,id:(0,i.Ak)(11),loaded:!0,inLocalStorage:!0};return{type:I,queryEditor:t}}function nt(){return function(e,t){const{sqlLab:{queryEditors:r,tabHistory:a,unsavedQueryEditor:n,databases:o},common:s}=t(),i=s.conf.SQLLAB_DEFAULT_DBID,l=r.find((e=>e.id===a[a.length-1])),c=Object.values(o).map((e=>e.id)),u=c.length>0?Math.min(...c):void 0,{dbId:m,catalog:p,schema:_,queryLimit:f,autorun:y}={...r[0],...l,...n.id===(null==l?void 0:l.id)&&n},E=(0,h.G7)(h.TO.SqllabBackendPersistence)?"":(0,d.t)("-- Note: Unless you save your query, these tabs will NOT persist if you clear your cookies or change browsers.\n\n"),g=b((null==r?void 0:r.map((e=>({...e,...e.id===n.id&&n}))))||[]);return e(at({dbId:m||i||u,catalog:null!=p?p:null,schema:null!=_?_:null,autorun:null!=y&&y,sql:`${E}SELECT ...`,queryLimit:f||s.conf.DEFAULT_SQLLAB_LIMIT,name:g}))}}function ot(e,t){return function(r,a){const n=a(),{queryEditors:o,unsavedQueryEditor:s,tabHistory:i}=n.sqlLab,l={...o.find((e=>e.id===i[i.length-1])),...i[i.length-1]===s.id&&s};return r(at({name:(0,d.t)("Copy of %s",l.name),dbId:e.dbId?e.dbId:null,catalog:e.catalog?e.catalog:null,schema:e.schema?e.schema:null,autorun:t,sql:e.sql,queryLimit:l.queryLimit,maxRow:l.maxRow,templateParams:l.templateParams}))}}function st(e){return{type:ve,queryEditorId:e}}function it(e){return{type:te,queryEditor:e}}function lt(e=!1){return function(t,r){const{sqlLab:a}=r(),{queryEditors:n,tabHistory:o}=a,s=o[o.length-1],i=n.findIndex((e=>e.id===s));t(it(n[(e?i-1+n.length:i+1)%n.length]))}}function ct(e){return{type:re,queryEditor:e}}function dt(e){const t=e.filter((e=>null!==e.description)).map((e=>{const{columns:t,selectStar:r,primaryKey:a,foreignKeys:n,indexes:o,dataPreviewQueryId:s}=e.description;return{dbId:e.database_id,queryEditorId:e.tab_state_id.toString(),catalog:e.catalog,schema:e.schema,name:e.table,expanded:e.expanded,id:e.id,dataPreviewQueryId:s,columns:t,selectStar:r,primaryKey:a,foreignKeys:n,indexes:o,isMetadataLoading:!1,isExtraMetadataLoading:!1}}));return{type:ae,tables:t}}function ut(e,t){return function(r){u.A.get({endpoint:encodeURI(`/tabstateview/${e.id}`)}).then((({json:e})=>{var a,n;const o={id:e.id.toString(),loaded:!0,name:e.label,sql:e.sql,selectedText:null,latestQueryId:null==(a=e.latest_query)?void 0:a.id,autorun:e.autorun,dbId:e.database_id,templateParams:e.template_params,catalog:e.catalog,schema:e.schema,queryLimit:e.query_limit,remoteId:null==(n=e.saved_query)?void 0:n.id,hideLeftBar:e.hide_left_bar};r(ct(o)),r(dt(e.table_schemas||[])),e.latest_query&&e.latest_query.resultsKey&&r(Ke(e.latest_query,t))})).catch((t=>404!==t.status?r(Ce((0,d.t)("An error occurred while fetching tab state"))):r({type:w,queryEditor:e})))}}function mt(e){return{type:ne,tabId:e}}function pt(e){const t=!e.hideLeftBar;return{type:W,queryEditor:e,hideLeftBar:t}}function ht(e){return{type:Re,queryEditorId:e}}function _t(e){return{type:w,queryEditor:e}}function ft(e){return function(t,r){var a;const{sqlLab:n}=r();null==(a=n.queryEditors)||a.forEach((r=>{r.id!==e.id&&t(_t(r))}))}}function yt(e){return function(t){return((0,h.G7)(h.TO.SqllabBackendPersistence)?u.A.delete({endpoint:encodeURI(`/tabstateview/${e.sqlEditorId}/query/${e.id}`)}):Promise.resolve()).then((()=>t({type:x,query:e}))).catch((()=>t(Ce((0,d.t)("An error occurred while removing query. Please contact your administrator.")))))}}function Et(e,t){return{type:M,queryEditor:e,dbId:t}}function gt(e,t){return{type:F,queryEditor:e||{},catalog:t}}function Tt(e,t){return{type:k,queryEditor:e||{},schema:t}}function At(e,t){return{type:Q,queryEditor:e,autorun:t}}function bt(e,t,r){return{type:Y,queryEditor:{...e,id:r},name:t}}function St(e,t){const{id:r,...a}=xe(e);return r=>u.A.post({endpoint:"/api/v1/saved_query/",jsonPayload:xe(a)}).then((a=>{const n=Ue({id:a.json.id,...a.json.result});return r({type:C,query:e,clientId:t,result:n}),r(bt(e,e.name,t)),n})).catch((()=>r(Ce((0,d.t)("Your query could not be saved")))))}const vt=(e,t)=>r=>((0,h.G7)(h.TO.SqllabBackendPersistence)?u.A.put({endpoint:`/tabstateview/${e.id}`,postPayload:{saved_query_id:t.remoteId}}):Promise.resolve()).catch((()=>{r(Ce((0,d.t)("Your query was not properly saved")))})).then((()=>{r(Oe((0,d.t)("Your query was saved")))}));function Rt(e,t){const{id:r,...a}=xe(e);return r=>u.A.put({endpoint:`/api/v1/saved_query/${e.remoteId}`,jsonPayload:xe(a)}).then((()=>{r(Oe((0,d.t)("Your query was updated"))),r(bt(e,e.name,t))})).catch((e=>{const t=(0,d.t)("Your query could not be updated");console.error(t,e),r(Ce(t))})).then((()=>r(Fe(e))))}function It(e,t,r){return{type:B,queryEditor:e,sql:t,queryId:r}}function Ot(e,t){return{type:H,queryEditor:e,position:t}}function Ct(e,t,r){return function(a,n){const o=Pe(n(),e);return a(It(o,t,r)),(0,h.G7)(h.TO.SqllabBackendPersistence)?u.A.put({endpoint:encodeURI(`/tabstateview/${o.id}`),postPayload:{sql:t,latest_query_id:r}}).catch((()=>a(Ce((0,d.t)('An error occurred while storing your query in the backend. To avoid losing your changes, please save your query using the "Save Query" button.'))))):Promise.resolve()}}function Dt(e){return function(t,r){const{sql:a}=Pe(r(),e);return u.A.post({endpoint:"/api/v1/sqllab/format_sql/",body:JSON.stringify({sql:a}),headers:{"Content-Type":"application/json"}}).then((({json:r})=>{t(It(e,r.result))}))}}function wt(e,t){return{type:j,queryEditor:e,queryLimit:t}}function Lt(e,t){return{type:$,queryEditor:e,templateParams:t}}function Nt(e,t){return{type:G,queryEditor:e,sql:t}}function qt(e,t,r){return{type:L,table:e,query:t,prepend:r}}function xt(e,t,r,a){return function(n,o){const{dbId:s}=Pe(o(),e,e.id);n(qt({dbId:s,queryEditorId:e.id,catalog:r,schema:a,name:t,id:(0,i.Ak)(11),expanded:!0}))}}function Ut(e,t){return function(r,a){const{sqlLab:{databases:n}}=a(),o=n[e.dbId],{dbId:s,catalog:l,schema:c}=e;if(o&&!o.disable_data_preview){var d;const a={id:null!=(d=e.previewQueryId)?d:(0,i.Ak)(11),dbId:s,catalog:l,schema:c,sql:e.selectStar,tableName:e.name,sqlEditorId:null,tab:"",runAsync:o.allow_run_async,ctas:!1,isDataPreview:!0};return t?r(Xe(a,t)):Promise.all([r(qt({id:e.id,dbId:e.dbId,catalog:e.catalog,schema:e.schema,name:e.name,queryEditorId:e.queryEditorId,dataPreviewQueryId:a.id},a)),r(Xe(a))])}return Promise.resolve()}}function Pt(e,t){return function(r){return((0,h.G7)(h.TO.SqllabBackendPersistence)?u.A.post({endpoint:encodeURI("/tableschemaview/"),postPayload:{table:{...t,...e}}}):Promise.resolve({json:{id:e.id}})).then((({json:t})=>{const a={...e,id:`${t.id}`};r(qt({...a,expanded:!0,initialized:!0}))})).catch((()=>r(Ce((0,d.t)("An error occurred while fetching table metadata. Please contact your administrator.")))))}}function Mt(e,t){return{type:fe,oldQueryId:e,newQuery:t}}function Ft(e){return function(t){const r={id:(0,i.Ak)(),dbId:e.dbId,sql:e.sql,tableName:e.tableName,sqlEditorId:null,tab:"",runAsync:!1,ctas:!1,queryLimit:e.queryLimit,isDataPreview:e.isDataPreview};t(Xe(r)),t(Mt(e.id,r))}}function kt(e){return function(t){return((0,h.G7)(h.TO.SqllabBackendPersistence)?u.A.post({endpoint:encodeURI(`/tableschemaview/${e.id}/expanded`),postPayload:{expanded:!0}}):Promise.resolve()).then((()=>t({type:U,table:e}))).catch((()=>t(Ce((0,d.t)("An error occurred while expanding the table schema. Please contact your administrator.")))))}}function Yt(e){return function(t){return((0,h.G7)(h.TO.SqllabBackendPersistence)?u.A.post({endpoint:encodeURI(`/tableschemaview/${e.id}/expanded`),postPayload:{expanded:!1}}):Promise.resolve()).then((()=>t({type:P,table:e}))).catch((()=>t(Ce((0,d.t)("An error occurred while collapsing the table schema. Please contact your administrator.")))))}}function Qt(e){return function(t){var r;const a=null!=(r=null==e?void 0:e.filter(Boolean))?r:[];return((0,h.G7)(h.TO.SqllabBackendPersistence)?Promise.all(a.map((e=>e.initialized?u.A.delete({endpoint:encodeURI(`/tableschemaview/${e.id}`)}):Promise.resolve()))):Promise.resolve()).then((()=>t({type:N,tables:a}))).catch((()=>t(Ce((0,d.t)("An error occurred while removing the table schema. Please contact your administrator.")))))}}function Bt(e){return{type:oe,alteredQueries:e}}function Ht(e){return{type:se,offline:e}}function jt(e,t,r){return{type:z,queryEditor:e,northPercent:t,southPercent:r}}function $t(e){return function(t){return u.A.get({endpoint:`/api/v1/sqllab/permalink/${e}`}).then((({json:e})=>t(at({name:e.name?e.name:(0,d.t)("Shared query"),dbId:e.dbId?parseInt(e.dbId,10):null,catalog:e.catalog?e.catalog:null,schema:e.schema?e.schema:null,autorun:!!e.autorun&&e.autorun,sql:e.sql?e.sql:"SELECT ...",templateParams:e.templateParams})))).catch((()=>t(Ce(Le))))}}function Gt(e){return function(t){return u.A.get({endpoint:`/api/v1/sqllab/permalink/kv:${e}`}).then((({json:e})=>t(at({name:e.name?e.name:(0,d.t)("Shared query"),dbId:e.dbId?parseInt(e.dbId,10):null,catalog:e.catalog?e.catalog:null,schema:e.schema?e.schema:null,autorun:!!e.autorun&&e.autorun,sql:e.sql?e.sql:"SELECT ...",templateParams:e.templateParams})))).catch((()=>t(Ce(Le))))}}function Vt(e){return function(t){return u.A.get({endpoint:`/api/v1/saved_query/${e}`}).then((({json:e})=>{const r={...Ue(e.result),loaded:!0,autorun:!1},a={name:r.name,dbId:r.database.id,catalog:r.catalog,schema:r.schema,sql:r.sql,templateParams:r.templateParams,remoteId:r.remoteId};return t(at(a))})).catch((()=>t(Ce(Le))))}}function zt(e){return function(t){return u.A.get({endpoint:`/api/v1/query/${e}`}).then((({json:e})=>{const r=e.result,a={dbId:r.database.id,catalog:r.catalog,schema:r.schema,sql:r.sql,name:(0,d.t)("Copy of %s",r.tab_name),autorun:!1};return t(at(a))})).catch((()=>t(Ce(Le))))}}function Wt(e,t){return function(r){const a=(0,d.t)("Query"),n=e.split("__")[0],o=c().encode({keys:["none"],columns:["name","schema","database.id","select_star"]});return u.A.get({endpoint:`/api/v1/dataset/${n}?q=${o}`}).then((({json:e})=>r(at({name:`${a} ${e.result.name}`,dbId:e.result.database.id,schema:e.result.schema,autorun:void 0!==t,sql:t||e.result.select_star})))).catch((()=>r(Ce((0,d.t)("The datasource couldn't be loaded")))))}}function Kt(){return{type:Te}}function Xt(e){const t=`${e.id}__table`;return{type:Ae,datasource:t}}function Jt(e){return{type:be,err:e}}function Zt(e){return t=>{t(Kt());const{dbId:r,catalog:a,schema:n,datasourceName:o,sql:s}=e;return u.A.post({endpoint:"/api/v1/dataset/",headers:{"Content-Type":"application/json"},body:JSON.stringify({database:r,catalog:a,schema:n,sql:s,table_name:o,is_managed_externally:!1,external_url:null})}).then((({json:e})=>(t(Xt(e)),Promise.resolve(e)))).catch((e=>((0,m.h4)(e).then((e=>{t(Ce(e.error))})),t(Jt((0,d.t)("An error occurred while creating the data source"))),Promise.reject())))}}function er(e){return t=>(t(Kt()),u.A.post({endpoint:"/api/v1/dataset/get_or_create/",jsonPayload:e}).then((({json:e})=>(t(Xt(e.result)),e.result))).catch((()=>{const e=(0,d.t)("An error occurred while creating the data source");return t(Jt(e)),Promise.reject(new Error(e))})))}},75827:(e,t,r)=>{"use strict";r.d(t,{K:()=>_});var a=r(96540),n=r(96453),o=r(17437),s=r(16784),i=r(97689),l=r(13573),c=r(62787),d=r(66903),u=r(57337),m=r(66537),p=r(2445);const h=n.I4.span`
  display: flex;
  align-items: center;
  svg {
    margin-right: ${({theme:e})=>e.gridUnit}px;
  }
`;function _({column:e,labelRef:t,showType:r=!1}){const{expression:n,column_name:_,type_generic:f}=e,y=n&&n!==_,E=e.warning_markdown||e.warning_text||e.error_text,g=y?"expression":f,[T,A]=(0,a.useState)(e.column_name),[b,S]=(0,a.useState)(e.type);return(0,a.useLayoutEffect)((()=>{A((0,d.Gw)(e,t)),S((0,d.EL)(e))}),[t,e]),(0,p.FD)(h,{children:[r&&void 0!==g&&(0,p.Y)(i.m,{id:"metric-type-tooltip",title:b,placement:"bottomRight",align:{offset:[8,-2]},children:(0,p.Y)("span",{children:(0,p.Y)(l.P,{type:g})})}),(0,p.Y)(i.m,{id:"metric-name-tooltip",title:T,children:(0,p.Y)("span",{className:"option-label column-option-label",css:e=>o.AH`
            margin-right: ${e.gridUnit}px;
          `,ref:t,children:(0,d.MQ)(e)})}),y&&(0,p.Y)(u.i,{sqlExpression:n}),e.is_certified&&(0,p.Y)(c.A,{metricName:e.metric_name,certifiedBy:e.certified_by,details:e.certification_details}),E&&(0,p.Y)(m.A,{className:"text-warning",icon:"warning",tooltip:(0,p.Y)(s.A,{source:E}),label:`warn-${e.column_name}`,iconsStyle:{marginLeft:0},...e.error_text&&{className:"text-danger",icon:"exclamation-circle"}})]})}},78130:(e,t,r)=>{"use strict";function a(e,t){return e().dashboardState.sliceIds.includes(t)}r.d(t,{$u:()=>o,B8:()=>u,C1:()=>c,GK:()=>l,GS:()=>d,J2:()=>s,Zg:()=>i,mg:()=>n});const n="CHANGE_FILTER";function o(e,t,r){return(o,s)=>{if(a(s,e)){const a=s().dashboardLayout.present;return o({type:n,chartId:e,newSelectedValues:t,merge:r,components:a})}return s().dashboardFilters}}const s="UPDATE_DIRECT_PATH_TO_FILTER";function i(e,t){return(r,n)=>a(n,e)?r({type:s,chartId:e,path:t}):n().dashboardFilters}const l="UPDATE_LAYOUT_COMPONENTS";function c(e){return t=>{t({type:l,components:e})}}const d="UPDATE_DASHBOARD_FILTERS_SCOPE";function u(e){return t=>{t({type:d,scopes:e})}}},79758:(e,t,r)=>{"use strict";var a;r.d(t,{A:()=>n,g:()=>a}),function(e){e.Aggregate="aggregate",e.Raw="raw"}(a||(a={}));const n={}},80145:(e,t,r)=>{"use strict";r.d(t,{A:()=>s});var a=r(25373),n=r(70360);class o extends a.A{constructor(){super({name:"ChartMetadata",overwritePolicy:a.m.Warn})}}const s=(0,n.A)(o)},80464:(e,t,r)=>{"use strict";r.d(t,{$G:()=>u,Lj:()=>p,Nv:()=>_,T1:()=>m,sH:()=>f,ut:()=>d});var a=r(58561),n=r.n(a),o=r(35742),s=r(51436),i=r(95579),l=r(95272);const c=200,d="ADD_SLICES",u="SET_SLICES",m="FETCH_ALL_SLICES_STARTED",p="FETCH_ALL_SLICES_FAILED",h=e=>e.reduce(((e,t)=>{let r=JSON.parse(t.params);var a,n;return r={...r,datasource:(a=t.datasource_id,n=t.datasource_type,`${a}__${n}`||r.datasource)},{...e,[t.id]:{slice_id:t.id,slice_url:t.url,slice_name:t.slice_name,form_data:r,datasource_name:t.datasource_name_text,datasource_url:t.datasource_url,datasource_id:t.datasource_id,datasource_type:t.datasource_type,changed_on:new Date(t.changed_on_utc).getTime(),description:t.description,description_markdown:t.description_markeddown,viz_type:t.viz_type,modified:t.changed_on_delta_humanized,changed_on_humanized:t.changed_on_delta_humanized,thumbnail_url:t.thumbnail_url,owners:t.owners,created_by:t.created_by}}}),{});function _(e){return t=>{t(function(e){return{type:u,payload:{slices:e}}}(e))}}function f(e,t,r="changed_on"){return a=>{a({type:m});const u=t?[{col:"slice_name",opr:"chart_all_text",value:t}]:[];return e&&u.push({col:"owners",opr:"rel_m_m",value:e}),o.A.get({endpoint:`/api/v1/chart/?q=${n().encode({columns:["changed_on_delta_humanized","changed_on_utc","datasource_id","datasource_type","datasource_url","datasource_name_text","description_markeddown","description","id","params","slice_name","thumbnail_url","url","viz_type","owners.id","created_by.id"],filters:u,page_size:c,order_column:"changed_on"===r?"changed_on_delta_humanized":r,order_direction:"changed_on"===r?"desc":"asc"})}`}).then((({json:e})=>{const{result:t}=e,r=h(t);return a(function(e){return{type:d,payload:{slices:e}}}(r))})).catch((e=>(0,s.h4)(e).then((({error:e})=>{a(function(e){return{type:p,payload:{error:e}}}(e||(0,i.t)("Could not fetch all saved charts"))),a((0,l.iB)((0,i.t)("Sorry there was an error fetching saved charts: ")+e))}))))}}},81151:(e,t,r)=>{"use strict";r.d(t,{BD:()=>g,B_:()=>b,CW:()=>s,Fq:()=>L,GY:()=>I,Gc:()=>q,IS:()=>_,Ie:()=>l,It:()=>v,KD:()=>p,LA:()=>w,LH:()=>u,RY:()=>m,W3:()=>y,W9:()=>R,X0:()=>O,XY:()=>n,cV:()=>T,fB:()=>d,gb:()=>N,hL:()=>P,iF:()=>E,k0:()=>i,kn:()=>C,mK:()=>a,nO:()=>h,nS:()=>f,nc:()=>D,nm:()=>S,pX:()=>x,tK:()=>A,wN:()=>c,wv:()=>o,zf:()=>U});const a="GRID_ID",n="HEADER_ID",o="ROOT_ID",s="DASHBOARD_VERSION_KEY",i="NEW_COMPONENTS_SOURCE_ID",l="NEW_CHART_ID",c="NEW_COLUMN_ID",d="NEW_DIVIDER_ID",u="NEW_HEADER_ID",m="NEW_MARKDOWN_ID",p="NEW_ROW_ID",h="NEW_TAB_ID",_="NEW_TABS_ID",f="NEW_DYNAMIC_COMPONENT",y=0,E=8,g=2*E,T=12,A=1,b=5,S=4,v="SMALL_HEADER",R="MEDIUM_HEADER",I="LARGE_HEADER",O="BACKGROUND_WHITE",C="BACKGROUND_TRANSPARENT",D=50,w="overwrite",L="overwriteConfirmed",N="newDashboard",q=65535,x=["LABEL"],U="ALL_FILTERS_ROOT";var P;!function(e){e[e.None=0]="None",e[e.HideNav=1]="HideNav",e[e.HideNavAndTitle=2]="HideNavAndTitle",e[e.Report=3]="Report"}(P||(P={}))},81550:(e,t,r)=>{"use strict";r.d(t,{A:()=>n,W:()=>a});const a=/(\d{4}-\d{2}-\d{2})[\sT](\d{2}:\d{2}:\d{2}\.?\d*).*/;function n(e){const t=e.match(a);return t?`${t[1]}T${t[2]}Z`:e}},81998:(e,t,r)=>{"use strict";r.d(t,{A:()=>s});var a=r(25373),n=r(70360);class o extends a.A{constructor(){super({name:"ChartBuildQuery",overwritePolicy:a.m.Warn})}}const s=(0,n.A)(o)},82097:(e,t,r)=>{"use strict";r.d(t,{S:()=>_});var a=r(96540),n=r(96453),o=r(17437),s=r(16784),i=r(66537),l=r(13573),c=r(62787),d=r(97689),u=r(66903),m=r(57337),p=r(2445);const h=n.I4.div`
  align-items: center;
  display: flex;

  > svg {
    margin-right: ${({theme:e})=>e.gridUnit}px;
  }
`;function _({metric:e,labelRef:t,openInNewWindow:r=!1,showFormula:n=!0,showType:_=!1,shouldShowTooltip:f=!0,url:y=""}){const E=e.verbose_name||e.metric_name||e.label,g=y?(0,p.Y)("a",{href:y,target:r?"_blank":"",rel:"noreferrer",children:E}):E,T=(0,p.Y)("span",{className:"option-label metric-option-label",css:e=>o.AH`
        margin-right: ${e.gridUnit}px;
      `,ref:t,children:g}),A=e.warning_markdown||e.warning_text||e.error_text,[b,S]=(0,a.useState)(e.metric_name);return(0,a.useLayoutEffect)((()=>{S((0,u.I4)(e,t))}),[t,e]),(0,p.FD)(h,{className:"metric-option",children:[_&&(0,p.Y)(l.P,{type:"expression"}),f?(0,p.Y)(d.A,{id:"metric-name-tooltip",title:b,children:T}):T,n&&e.expression&&(0,p.Y)(m.i,{sqlExpression:e.expression}),e.is_certified&&(0,p.Y)(c.A,{metricName:e.metric_name,certifiedBy:e.certified_by,details:e.certification_details}),A&&(0,p.Y)(i.A,{className:"text-warning",icon:"warning",tooltip:(0,p.Y)(s.A,{source:A}),label:`warn-${e.metric_name}`,iconsStyle:{marginLeft:0},...e.error_text&&{className:"text-danger",icon:"exclamation-circle"}})]})}},82920:(e,t,r)=>{"use strict";r.d(t,{A:()=>n});var a=r(95579);function n(e){return!!(null==e||""===e||Array.isArray(e)&&0===e.length)&&(0,a.t)("cannot be empty")}},83255:(e,t,r)=>{"use strict";r.d(t,{b:()=>m,k:()=>p});var a=r(88055),n=r.n(a),o=r(13270),s=r(80145),i=r(58863),l=r(12817),c=r(10504),d=r(73212),u=r(49588);const m=e=>void 0===e||e,p=(e,t,r)=>{var a;const m=Object.values(e).filter((e=>(null==e?void 0:e.type)===u.oT)),p=null!=(a=t.global_chart_configuration)&&a.scope?{scope:t.global_chart_configuration.scope,chartsInScope:(0,l._)(t.global_chart_configuration.scope,Object.values(r).map((e=>e.id)),m)}:{scope:d.e2,chartsInScope:Object.values(r).map((e=>e.id))},h={};return m.forEach((e=>{var a,d,u,_,f,y;const E=null==(a=e.meta)?void 0:a.chartId;var g;(0,o.A)(E)&&((null!=(d=null==(u=null!=(_=(0,s.A)().get(null==(f=r[E])||null==(y=f.form_data)?void 0:y.viz_type))?_:{})?void 0:u.behaviors)?d:[]).includes(i.nS.InteractiveChart)&&(null!=(g=t.chart_configuration)&&g[E]&&(h[E]=n()(t.chart_configuration[E])),h[E]||(h[E]={id:E,crossFilters:{scope:c.TY,chartsInScope:[]}}),h[E].crossFilters.chartsInScope=(0,c.YD)(h[E].crossFilters.scope)?p.chartsInScope.filter((e=>e!==Number(E))):(0,l._)(h[E].crossFilters.scope,Object.values(r).map((e=>e.id)),m)))})),{chartConfiguration:h,globalChartConfiguration:p}}},83942:(e,t,r)=>{"use strict";r.d(t,{A:()=>n});var a=r(5795);class n{constructor(e){this.id=void 0,this.type=void 0;const[t,r]=e.split("__");this.id=parseInt(t,10),this.type=a.cT.Table,this.type="query"===r?a.cT.Query:this.type}toString(){return`${this.id}__${this.type}`}toObject(){return{id:this.id,type:this.type}}}},84080:(e,t,r)=>{"use strict";r.d(t,{V:()=>c,b:()=>l});var a=r(96453),n=r(82097),o=r(75827),s=r(2445);const i=a.I4.div`
  width: 100%;
  > span {
    display: flex;
    align-items: center;
  }

  .option-label {
    display: inline-block;
    overflow: hidden;
    text-overflow: ellipsis;
    white-space: nowrap;
    & ~ i {
      margin-left: ${({theme:e})=>e.gridUnit}px;
    }
  }
  .type-label {
    margin-right: ${({theme:e})=>3*e.gridUnit}px;
    width: ${({theme:e})=>7*e.gridUnit}px;
    display: inline-block;
    text-align: center;
    font-weight: ${({theme:e})=>e.typography.weights.bold};
  }
`,l=e=>(0,s.Y)(i,{children:(0,s.Y)(n.S,{...e})}),c=e=>(0,s.Y)(i,{children:(0,s.Y)(o.K,{...e})})},84248:(e,t,r)=>{"use strict";r.d(t,{Q:()=>o});var a=r(96540),n=r(27023);function o(e,t=n.jW){const[r,o]=(0,a.useState)(e);return(0,a.useEffect)((()=>{const r=setTimeout((()=>{o(e)}),t);return()=>{clearTimeout(r)}}),[e,t]),r}},84666:(e,t,r)=>{"use strict";r.d(t,{L:()=>a});const a=(0,r(41811).A)(((e,t,r)=>!!r&&Object.values(r).some((r=>r.some((([r,a])=>r===e&&a===t))))))},85183:(e,t,r)=>{"use strict";r.d(t,{Cq:()=>D,Hh:()=>S,Mp:()=>R,RY:()=>C,TL:()=>O,Xe:()=>v,Ze:()=>T,eX:()=>b,kD:()=>y,sv:()=>w,sx:()=>I,u8:()=>N,zJ:()=>L});var a=r(96540),n=r(84193),o=r.n(n),s=r(80145),i=r(81998),l=r(1889),c=r(35742),d=r(62952),u=r(93376),m=r(12066),p=r(15151),h=r(27023),_=r(95483),f=r(81151);function y(e){var t,r;const{slice:a,form_data:n}=e;return null!=(t=null!=(r=null==a?void 0:a.slice_id)?r:null==n?void 0:n.slice_id)?t:_.sO}let E=0;function g(e=!1){let t=0;return e&&(t=E%u.N.length,E+=1,0===t&&(t+=1,E+=1)),u.N[t]}function T(e,t){return null==e?null:o()(window.location.search).pathname("/api/v1/chart/data").search({form_data:(0,m.J)({slice_id:e}),force:t}).toString()}function A(e="base"){return["full","json","csv","query","results","samples"].includes(e)?"/superset/explore_json/":"/explore/"}function b(e,t={},r=!1){const a=new(o())("/"),n=A(e),s=a.search(!0);return Object.keys(t).forEach((e=>{s[e]=t[e]})),e===h.vX.standalone.name&&(r&&(s.force="1"),s.standalone=f.hL.HideNav),a.directory(n).search(s).toString()}function S({path:e,qs:t,allowDomainSharding:r=!1}){let a=new(o())({protocol:window.location.protocol.slice(0,-1),hostname:g(r),port:window.location.port?window.location.port:"",path:e});return t&&(a=a.search(t)),a}function v({formData:e,endpointType:t="base",force:r=!1,curUrl:a=null,requestParams:n={},allowDomainSharding:s=!1,method:i="POST"}){if(!e.datasource)return null;delete e.label_colors;let l=S({path:"/",allowDomainSharding:s});a&&(l=o()(o()(a).search()));const c=A(t),d=l.search(!0),{slice_id:u,extra_filters:p,adhoc_filters:_,viz_type:f}=e;if(u){const e={slice_id:u};"GET"===i&&(e.viz_type=f,p&&p.length&&(e.extra_filters=p),_&&_.length&&(e.adhoc_filters=_)),d.form_data=(0,m.J)(e)}r&&(d.force="true"),"csv"===t&&(d.csv="true"),t===h.vX.standalone.name&&(d.standalone="1"),"query"===t&&(d.query="true"),"results"===t&&(d.results="true"),"samples"===t&&(d.samples="true");const y=Object.keys(n);return y.length&&y.forEach((e=>{n.hasOwnProperty(e)&&(d[e]=n[e])})),l.search(d).directory(c).toString()}const R=e=>{var t,r;const a=(0,s.A)().get(e.viz_type);return[null!=(t=null==a?void 0:a.useLegacyApi)&&t,null!=(r=null==a?void 0:a.parseMethod)?r:"json-bigint"]},I=({formData:e,force:t,resultFormat:r,resultType:a,setDataMask:n,ownState:o})=>{var s;return(null!=(s=(0,i.A)().get(e.viz_type))?s:e=>(0,l.A)(e,(e=>[{...e}])))({...e,force:t,result_format:r,result_type:a},{ownState:o,hooks:{setDataMask:n}})},O=({resultType:e,resultFormat:t})=>"csv"===t?t:e,C=({formData:e,resultFormat:t="json",resultType:r="full",force:a=!1,ownState:n={}})=>{let o,s;const[i,l]=R(e);i?(o=v({formData:e,endpointType:O({resultFormat:t,resultType:r}),allowDomainSharding:!1}),s=e):(o="/api/v1/chart/data",s=I({formData:e,force:a,resultFormat:t,resultType:r,ownState:n,parseMethod:l})),c.A.postForm(o,{form_data:(0,m.J)(s)})},D=(e,t)=>{const r=v({formData:e,endpointType:"base",allowDomainSharding:!1,requestParams:t});c.A.postForm(r,{form_data:(0,m.J)(e)})},w=(e,t,r)=>{const n=(0,a.useCallback)(e,r);(0,a.useEffect)((()=>{const e=setTimeout((()=>{n()}),t);return()=>{clearTimeout(e)}}),[n,t])},L=(e,t,r)=>{var a;const n=[..._.sJ].map((e=>_.nS[e].operation)).indexOf(t)>=0,o=-1===_.Sd.map((e=>_.nS[e].operation)).indexOf(t);let s="object"==typeof e?null!=(a=null==e?void 0:e.column_name)?a:"":null!=e?e:"";if(e&&t){s+=` ${t}`;const e=n&&Array.isArray(r)?r[0]:r,a=(0,d.A)(r),i=void 0!==e&&Number.isNaN(Number(e)),l=i?"'":"",[c,u]=n?["(",")"]:["",""];a.length>0&&o&&(s+=` ${c}${a.map((e=>(0,p.ed)(e))).map((e=>`${l}${i?String(e).replace(/'/g,"''"):e}${l}`)).join(", ")}${u}`)}return s};function N(e){return e.map((e=>[e,e.toString()]))}},85278:(e,t,r)=>{"use strict";r.d(t,{Rm:()=>m,eM:()=>d,ib:()=>c,wX:()=>u});var a=r(44383),n=r.n(a),o=r(42242),s=r(67553);const i=new Set(["version","remoteId","autorun","dbId","height","id","latestQueryId","northPercent","queryLimit","schema","selectedText","southPercent","sql","templateParams","name","hideLeftBar"]);function l(e){var t;const{startDttm:r,results:a}=e;return Date.now()-r>s.Ml||((null==(t=JSON.stringify(a))?void 0:t.length)||0)*s.pO/s.wc>s.GJ}function c(e){return e.map((e=>n()(e,["id","name","dbId","schema","dataPreviewQueryId","queryEditorId"]))).filter((({queryEditorId:e})=>Boolean(e)))}function d(e){return Object.keys(e).reduce(((t,r)=>{const{results:a}=e[r],n={...e[r],results:l(e[r])?{}:a};return{...t,[r]:n}}),{})}function u(e){return e.map((e=>Object.keys(e).filter((e=>i.has(e))).reduce(((t,r)=>({...t,[r]:e[r]})),{})))}function m(e,t){t.sqlLab.tables.forEach((({name:t,catalog:r,schema:a,dbId:n,persistData:s})=>{n&&a&&t&&null!=s&&s.columns&&(e(o.z7.upsertQueryData("tableMetadata",{dbId:n,catalog:r,schema:a,table:t},s)),e(o.z7.upsertQueryData("tableExtendedMetadata",{dbId:n,catalog:r,schema:a,table:t},{})))}))}},85861:(e,t,r)=>{"use strict";r.d(t,{vq:()=>_,Ay:()=>E});var a=r(69843),n=r.n(a),o=r(96540),s=r(96453),i=r(17437),l=r(95579),c=r(59753),d=r(46920),u=r(33149),m=r(55794),p=r.n(m),h=r(2445);const _=(0,s.I4)((e=>(0,h.Y)(c.A,{...e,maskTransitionName:""})))`
  ${({theme:e,responsive:t,maxWidth:r})=>t&&i.AH`
      max-width: ${null!=r?r:"900px"};
      padding-left: ${3*e.gridUnit}px;
      padding-right: ${3*e.gridUnit}px;
      padding-bottom: 0;
      top: 0;
    `}

  .antd5-modal-content {
    display: flex;
    flex-direction: column;
    max-height: ${({theme:e})=>`calc(100vh - ${8*e.gridUnit}px)`};
    margin-bottom: ${({theme:e})=>4*e.gridUnit}px;
    margin-top: ${({theme:e})=>4*e.gridUnit}px;
    padding: 0;
  }

  .antd5-modal-header {
    flex: 0 0 auto;
    border-radius: ${({theme:e})=>e.borderRadius}px
      ${({theme:e})=>e.borderRadius}px 0 0;
    padding: ${({theme:e})=>4*e.gridUnit}px
      ${({theme:e})=>6*e.gridUnit}px;

    .antd5-modal-title {
      font-weight: ${({theme:e})=>e.typography.weights.medium};
    }

    .antd5-modal-title h4 {
      display: flex;
      margin: 0;
      align-items: center;
    }
  }

  .antd5-modal-close {
    width: ${({theme:e})=>14*e.gridUnit}px;
    height: ${({theme:e})=>14*e.gridUnit}px;
    top: 0;
    right: 0;
  }

  .antd5-modal-close:hover {
    background: transparent;
  }

  .antd5-modal-close-x {
    display: flex;
    align-items: center;

    .close {
      flex: 1 1 auto;
      margin-bottom: ${({theme:e})=>e.gridUnit}px;
      color: ${({theme:e})=>e.colors.secondary.dark1};
      font-size: 32px;
      font-weight: ${({theme:e})=>e.typography.weights.light};
    }
  }

  .antd5-modal-body {
    flex: 0 1 auto;
    padding: ${({theme:e})=>4*e.gridUnit}px;
    overflow: auto;
    ${({resizable:e,height:t})=>!e&&t&&`height: ${t};`}
  }
  .antd5-modal-footer {
    flex: 0 0 1;
    border-top: ${({theme:e})=>e.gridUnit/4}px solid
      ${({theme:e})=>e.colors.grayscale.light2};
    padding: ${({theme:e})=>4*e.gridUnit}px;
    margin-top: 0;

    .btn {
      font-size: 12px;
    }

    .btn + .btn {
      margin-left: ${({theme:e})=>2*e.gridUnit}px;
    }
  }

  // styling for Tabs component
  // Aaron note 20-11-19: this seems to be exclusively here for the Edit Database modal.
  // TODO: remove this as it is a special case.
  .ant-tabs-top {
    margin-top: -${({theme:e})=>4*e.gridUnit}px;
  }

  &.no-content-padding .antd5-modal-body {
    padding: 0;
  }

  ${({draggable:e,theme:t})=>e&&`\n    .antd5-modal-header {\n      padding: 0;\n      .draggable-trigger {\n          cursor: move;\n          padding: ${4*t.gridUnit}px;\n          width: 100%;\n        }\n    }\n  `};

  ${({resizable:e,hideFooter:t})=>e&&`\n    .resizable {\n      pointer-events: all;\n\n      .resizable-wrapper {\n        height: 100%;\n      }\n\n      .antd5-modal-content {\n        height: 100%;\n\n        .antd5-modal-body {\n          /* 100% - header height - footer height */\n          height: ${t?"calc(100% - 55px);":"calc(100% - 55px - 65px);"}\n        }\n      }\n    }\n  `}
`,f=e=>({maxHeight:"100vh",maxWidth:"100vw",minHeight:e?109:174,minWidth:"380px",enable:{bottom:!0,bottomLeft:!1,bottomRight:!0,left:!1,top:!1,topLeft:!1,topRight:!1,right:!0}}),y=({children:e,disablePrimaryButton:t=!1,primaryTooltipMessage:r,primaryButtonLoading:a=!1,onHide:s,onHandledPrimaryAction:i,primaryButtonName:c=(0,l.t)("OK"),primaryButtonType:m="primary",show:y,name:E,title:g,width:T,maxWidth:A,responsive:b=!1,centered:S,footer:v,hideFooter:R,wrapProps:I,draggable:O=!1,resizable:C=!1,resizableConfig:D=f(R),draggableConfig:w,destroyOnClose:L,...N})=>{const q=(0,o.useRef)(null),[x,U]=(0,o.useState)(),[P,M]=(0,o.useState)(!0);let F;(0,o.isValidElement)(v)&&(F=(0,o.cloneElement)(v,{closeModal:s}));const k=n()(F)?[(0,h.Y)(d.A,{onClick:s,cta:!0,children:(0,l.t)("Cancel")},"back"),(0,h.Y)(d.A,{buttonStyle:m,disabled:t,tooltip:r,loading:a,onClick:i,cta:!0,children:c},"submit")]:F,Y=T||(b?"100vw":"600px"),Q=!(C||O),B=(0,o.useMemo)((()=>0===Object.keys(D).length?f(R):D),[R,D]);return(0,h.Y)(_,{centered:!!S,onOk:i,onCancel:s,width:Y,maxWidth:A,responsive:b,open:y,title:(0,h.Y)((()=>O?(0,h.Y)("div",{className:"draggable-trigger",onMouseOver:()=>P&&M(!1),onMouseOut:()=>!P&&M(!0),children:g}):(0,h.Y)(h.FK,{children:g})),{}),closeIcon:(0,h.Y)("span",{className:"close","aria-hidden":"true",children:"×"}),footer:R?null:k,hideFooter:R,wrapProps:{...I},modalRender:e=>C||O?(0,h.Y)(p(),{disabled:!O||P,bounds:x,onStart:(e,t)=>((e,t)=>{var r,a,n;const{clientWidth:o,clientHeight:s}=null==(r=window)||null==(a=r.document)?void 0:a.documentElement,i=null==q||null==(n=q.current)?void 0:n.getBoundingClientRect();i&&U({left:-(null==i?void 0:i.left)+(null==t?void 0:t.x),right:o-((null==i?void 0:i.right)-(null==t?void 0:t.x)),top:-(null==i?void 0:i.top)+(null==t?void 0:t.y),bottom:s-((null==i?void 0:i.bottom)-(null==t?void 0:t.y))})})(0,t),...w,children:C?(0,h.Y)(u.c,{className:"resizable",...B,children:(0,h.Y)("div",{className:"resizable-wrapper",ref:q,children:e})}):(0,h.Y)("div",{ref:q,children:e})}):e,mask:Q,draggable:O,resizable:C,destroyOnClose:L,...N,children:e})};y.displayName="Modal";const E=Object.assign(y,{error:c.A.error,warning:c.A.warning,confirm:c.A.confirm,useModal:c.A.useModal})},86274:(e,t,r)=>{"use strict";r.d(t,{b5:()=>c,bk:()=>a,vL:()=>i});var a,n=r(93505),o=r(96540);!function(e){e.Loading="loading",e.Complete="complete",e.Error="error"}(a||(a={}));const s={status:a.Loading,result:null,error:null};function i(e,t){return(0,o.useMemo)((()=>{if(e.status!==a.Complete)return e;try{return{...e,result:t(e.result)}}catch(e){return{status:a.Error,result:null,error:e}}}),[e,t])}const l=e=>e.result;function c(e){return i(function(e){const[t,r]=(0,o.useState)(s),i=(0,o.useRef)((()=>{}));return(0,o.useEffect)((()=>{r(s),i.current();let t=!1;return i.current=()=>{t=!0},(0,n.A)({method:"GET",endpoint:e})({}).then((e=>{t||r({status:a.Complete,result:e,error:null})})).catch((e=>{t||r({status:a.Error,result:null,error:e})})),()=>{t=!0}}),[e]),t}(e),l)}},86444:(e,t,r)=>{"use strict";r.d(t,{A:()=>n});var a=r(70700);function n(e){return(0,a.eh)(e)?e:null!=e&&e.label?e.label:null==e?void 0:e.sqlExpression}},86963:(e,t,r)=>{"use strict";r.d(t,{A:()=>n});var a=r(14811);function n(e){return(0,a.A)(e)}},87903:(e,t,r)=>{"use strict";var a;r.d(t,{A:()=>n,s:()=>a}),function(e){e[e.Numeric=0]="Numeric",e[e.String=1]="String",e[e.Temporal=2]="Temporal",e[e.Boolean=3]="Boolean"}(a||(a={}));const n={}},88488:(e,t,r)=>{"use strict";r.d(t,{A:()=>o});var a=r(86663);const n=new Set(["standalone","edit"]);function o(e){const t=a.parse(window.location.search);return Object.entries(t).reduce(((t,[r,a])=>"regular"===e&&n.has(r)||"reserved"===e&&!n.has(r)?t:Array.isArray(a)?{...t,[r]:a[0]}:{...t,[r]:a}),{})}},88631:(e,t,r)=>{"use strict";function a(e){return e.map((e=>Array.isArray(e)?e:[e,e.toString()]))}function n(e,t,r=1){const a=[];for(let n=e;n<=t;n+=r)a.push([n,n.toString()]);return a}r.d(t,{i:()=>n,u:()=>a})},91522:(e,t,r)=>{"use strict";r.d(t,{B:()=>E,W:()=>y});var a,n=r(85183),o=r(91715),s=r(93641),i=r(96627),l=r(86444),c=r(62952),d=r(76968),u=r(69161),m=r(17596),p=r(67295),h=r(32132),_=r(27023),f=r(84666);!function(e){e.CATEGORICAL="CATEGORICAL",e.SEQUENTIAL="SEQUENTIAL"}(a||(a={}));const y="HYDRATE_EXPLORE",E=({form_data:e,slice:t,dataset:r,metadata:E,saveAction:g=null})=>(T,A)=>{var b,S;const{user:v,datasources:R,charts:I,sliceEntities:O,common:C,explore:D}=A(),w=(0,h.P3)(_.vX.sliceId),L=(0,h.P3)(_.vX.dashboardId),N=w?null==O||null==(b=O.slices)?void 0:b[w]:null,q=null!=t?t:N,x=null!=e?e:null==q?void 0:q.form_data;if(!x.viz_type){const e=(null==C?void 0:C.conf.DEFAULT_VIZ_TYPE)||s.Y.Table;x.viz_type=(0,h.P3)(_.vX.vizType)||e}var U;x.time_range||(x.time_range=(null==C||null==(U=C.conf)?void 0:U.DEFAULT_TIME_FILTER)||i.WC),!x.include_time||!x.granularity_sqla||null!=(S=x.groupby)&&S.some((e=>(0,l.A)(e)===(0,l.A)(x.granularity_sqla)))||(x.groupby=[x.granularity_sqla,...(0,c.A)(x.groupby)],x.granularity_sqla=void 0),L&&(x.dashboardId=L);const P=r,M={form_data:x,slice:q,datasource:P},F=(0,o.Eu)(M,x),k=F.color_scheme&&"color_scheme",Y=F.linear_color_scheme&&"linear_color_scheme",Q=e=>{const t="CATEGORICAL"===e?(0,d.A)():(0,u.A)(),r="CATEGORICAL"===e?k:Y,a=t.defaultKey,n="CATEGORICAL"===e?"supersetColors":"superset_seq_1",o=x[r],s=!!t.get(o,!0);o&&!s&&(F[r].value=a||n)};k&&Q(a.CATEGORICAL),Y&&Q(a.SEQUENTIAL);const B={can_add:(0,f.L)("can_write","Chart",null==v?void 0:v.roles),can_download:(0,f.L)("can_csv","Superset",null==v?void 0:v.roles),can_overwrite:(0,c.A)(null==t?void 0:t.owners).includes(null==v?void 0:v.userId),isDatasourceMetaLoading:!1,isStarred:!1,triggerRender:!1,datasource:P,controls:F,form_data:x,slice:q,controlsTransferred:D.controlsTransferred,standalone:(0,h.P3)(_.vX.standalone),force:(0,h.P3)(_.vX.force),metadata:E,saveAction:g,common:C};Object.entries(B.controls).forEach((([e,t])=>{B.controls[e]=(0,m.jX)(t,B)}));const H=q?(0,m.LK)(F):null,j=(0,n.kD)(M),$={id:j,chartAlert:null,chartStatus:null,chartStackTrace:null,chartUpdateEndTime:null,chartUpdateStartTime:0,latestQueryFormData:(0,m.LK)(B.controls),sliceFormData:H,queryController:null,queriesResponse:null,triggerQuery:!1,lastRendered:0};return T({type:y,data:{charts:{...I,[j]:$},datasources:{...R,[(0,p.S)(P)]:P},saveModal:{dashboards:[],saveModalAlert:null,isVisible:!1},explore:B}})}},91715:(e,t,r)=>{"use strict";r.d(t,{Eu:()=>i,S7:()=>l});var a=r(93641),n=r(18253),o=r(17596),s=r(58962);function i(e,t){var r;const s={...t},i=s.viz_type||(null==(r=e.common)?void 0:r.conf.DEFAULT_VIZ_TYPE)||a.Y.Table;!function(e){e.y_axis_zero&&(e.y_axis_bounds=[0,null])}(s);const l=(0,o.Tb)(i,e.datasource.type,e,s),c=(0,n.A)().get(i)||{};return c.onInit?c.onInit(l):l}function l(e){const t=e.datasource.split("__")[1],r=e.viz_type,a=(0,o.Tb)(r,t,null,e),n=(0,o.LK)(a),s={};return Object.keys(a).concat(Object.keys(e)).forEach((t=>{void 0===e[t]?s[t]=n[t]:s[t]=e[t]})),s}const c={...s.ne};Object.keys(s.ne).forEach((e=>{c[e].value=s.ne[e].default})),(0,o.LK)(c)},91778:(e,t,r)=>{"use strict";function a(e){return"string"==typeof e}function n(e){return"string"!=typeof e&&"SIMPLE"===(null==e?void 0:e.expressionType)}function o(e){return"string"!=typeof e&&"SQL"===(null==e?void 0:e.expressionType)}function s(e){return a(e)||n(e)||o(e)}r.d(t,{Ay:()=>i,IN:()=>n,Pr:()=>s,S_:()=>a,WL:()=>o});const i={}},92037:(e,t,r)=>{"use strict";r.r(t),r.d(t,{FETCH_DASHBOARDS_FAILED:()=>f,FETCH_DASHBOARDS_SUCCEEDED:()=>h,SAVE_SLICE_FAILED:()=>T,SAVE_SLICE_SUCCESS:()=>b,SET_SAVE_CHART_MODAL_VISIBILITY:()=>E,createDashboard:()=>C,createSlice:()=>O,fetchDashboardsFailed:()=>y,fetchDashboardsSucceeded:()=>_,getSliceDashboards:()=>D,getSlicePayload:()=>v,saveSliceFailed:()=>A,saveSliceSuccess:()=>S,setSaveChartModalVisibility:()=>g,updateSlice:()=>I});var a=r(62193),n=r.n(a),o=r(58561),s=r.n(o),i=r(5795),l=r(95579),c=r(35742),d=r(95272),u=r(95483),m=r(85183);const p=/^adhoc_filters/,h="FETCH_DASHBOARDS_SUCCEEDED";function _(e){return{type:h,choices:e}}const f="FETCH_DASHBOARDS_FAILED";function y(e){return{type:f,userId:e}}const E="SET_SAVE_CHART_MODAL_VISIBILITY";function g(e){return{type:E,isVisible:e}}const T="SAVE_SLICE_FAILED";function A(){return{type:T}}const b="SAVE_SLICE_SUCCESS";function S(e){return{type:b,data:e}}const v=(e,t={},r,a,o={})=>{const s=function(e){const t={};return Object.entries(e).forEach((([e,r])=>{p.test(e)&&Array.isArray(r)&&(t[e]=r.filter((e=>!e.isExtra)))})),t}(t);if(!n()(o)&&t.adhoc_filters&&t.adhoc_filters.length>0&&Object.keys(s).forEach((e=>{if(n()(s[e])){const t=o[e];if(Array.isArray(t)){const r=s[e]||[];t.forEach((e=>{e.operator===u.ux.TemporalRange&&r.push({...e,comparator:e.comparator||"No filter"})})),s[e]=r}}})),!(e=>((null==e?void 0:e.adhoc_filters)||[]).some((e=>e.operator===u.ux.TemporalRange)))(s)){const e=Object.keys(t).filter((e=>p.test(e)));null==e||e.forEach((e=>{var r;null==(r=t[e])||r.forEach((t=>{t.operator===u.ux.TemporalRange&&t.isExtra&&(s[e]||(s[e]=[]),s[e].push({...t,comparator:"No filter"}))}))}))}const l={...t,...s,dashboards:r};let c=0,d=i.cT.Table;if(l.datasource){const[e,t]=l.datasource.split("__");c=parseInt(e,10);const r=t.charAt(0).toUpperCase()+t.slice(1);r in i.cT&&(d=i.cT[r])}return{params:JSON.stringify(l),slice_name:e,viz_type:l.viz_type,datasource_id:c,datasource_type:d,dashboards:r,owners:a,query_context:JSON.stringify((0,m.sx)({formData:l,force:!1,resultFormat:"json",resultType:"full",setDataMask:null,ownState:null}))}},R=(e,t,r)=>{const a=[];return e?a.push((0,d.WR)((0,l.t)("Chart [%s] has been saved",t))):a.push((0,d.WR)((0,l.t)("Chart [%s] has been overwritten",t))),r&&(r.new?a.push((0,d.WR)((0,l.t)("Dashboard [%s] just got created and chart [%s] was added to it",r.title,t))):a.push((0,d.WR)((0,l.t)("Chart [%s] was added to dashboard [%s]",t,r.title)))),a},I=(e,t,r,a)=>async(n,o)=>{var s;const{slice_id:i,owners:l,form_data:d}=e,u=null==(s=o().explore)?void 0:s.form_data;try{const e=await c.A.put({endpoint:`/api/v1/chart/${i}`,jsonPayload:v(t,u,r,l,d)});return n(S(e.json)),R(!1,t,a).map(n),e.json}catch(e){throw n(A()),e}},O=(e,t,r)=>async(a,n)=>{var o;const s=null==(o=n().explore)?void 0:o.form_data;try{const n=await c.A.post({endpoint:"/api/v1/chart/",jsonPayload:v(e,s,t,[],{})});return a(S(n.json)),R(!0,e,r).map(a),n.json}catch(e){throw a(A()),e}},C=e=>async t=>{try{return(await c.A.post({endpoint:"/api/v1/dashboard/",jsonPayload:{dashboard_title:e}})).json}catch(e){throw t(A()),e}},D=e=>async t=>{try{return(await c.A.get({endpoint:`/api/v1/chart/${e.slice_id}?q=${s().encode({columns:["dashboards.id"]})}`})).json.result.dashboards.map((({id:e})=>e))}catch(e){throw t(A()),e}}},92475:(e,t,r)=>{"use strict";r.d(t,{PX:()=>T,Rc:()=>b,D3:()=>f,Cl:()=>E,cL:()=>v,fD:()=>w,Yd:()=>C,jd:()=>I,NW:()=>m,YX:()=>U,Qk:()=>N,a0:()=>A,zp:()=>y,$5:()=>g,zT:()=>R,lL:()=>L,nH:()=>x,gn:()=>O,$K:()=>q,m2:()=>h,qp:()=>_});var a=r(84700),n=r(95579),o=r(95272),s=r(49588),i=r(81151),l=r(67054),c=r(578),d=r(78130),u=r(72173);const m="UPDATE_COMPONENTS";function p(e){return(...t)=>(r,a)=>{const n=e(...t);r("function"==typeof n?n(r,a):n);const{dashboardLayout:o,dashboardState:s}=a();if(n.type!==m||!n.payload||!n.payload.nextComponents){const e=o.present;r((0,d.C1)(e))}s.hasUnsavedChanges||r((0,u.MR)(!0))}}const h=p((e=>({type:m,payload:{nextComponents:e}})));function _(e){return(t,r)=>{const{dashboardLayout:a}=r();t(h({[i.XY]:{...a.present[i.XY],meta:{text:e}}}))}}const f="DASHBOARD_TITLE_CHANGED";function y(e){return{type:f,text:e}}const E="DELETE_COMPONENT",g=p(((e,t)=>({type:E,payload:{id:e,parentId:t}}))),T="CREATE_COMPONENT",A=p((e=>({type:T,payload:{dropResult:e}}))),b="CREATE_TOP_LEVEL_TABS",S=p((e=>({type:b,payload:{dropResult:e}}))),v="DELETE_TOP_LEVEL_TABS",R=p((()=>({type:v,payload:{}}))),I="RESIZE_COMPONENT";function O({id:e,width:t,height:r}){return(a,n)=>{const{dashboardLayout:o}=n(),{present:s}=o,i=s[e],l=t&&i.meta.width!==t,c=r&&i.meta.height!==r;if(i&&(l||c)){const n={[e]:{...i,meta:{...i.meta,width:t||i.meta.width,height:r||i.meta.height}}};a(h(n))}}}const C="MOVE_COMPONENT",D=p((e=>({type:C,payload:{dropResult:e}}))),w="HANDLE_COMPONENT_DROP";function L(e){return(t,r)=>{const a=function(e,t){const r=(0,l.A)({dropResult:e,layout:t});return"number"==typeof r&&r<0}(e,r().dashboardLayout.present);if(a)return t((0,o.Zd)((0,n.t)("There is not enough space for this component. Try decreasing its width, or increasing the destination width.")));const{source:d,destination:u}=e,m=u&&u.id===i.wv,p=d.id===i.k0,h=r().dashboardLayout.present[i.wv],_=h&&h.children?h.children[0]:"";if(m)t(S(e));else if(u&&p)t(A(e));else{if(d.type===s.wc&&u.type===s.wc&&d.id===_&&u.id!==_)return t((0,o.Zd)((0,n.t)("Can not move top level tab into nested tabs")));u&&d&&(u.id!==d.id||u.index!==d.index)&&t(D(e))}const{dashboardFilters:f,dashboardLayout:y}=r();if(!p){const{present:e}=y,r=e[d.id]||{},a=e[u.id]||{};if((r.type===s.wc||r.type===s._8)&&r.children&&0===r.children.length){const r=(0,c.A)({childId:d.id,layout:e});t(g(d.id,r))}(function({dashboardFilters:e={},source:t=[],destination:r=[]}){const a=new Set(t),n=new Set(r);return[].concat(...Object.values(e).map((({scopes:e})=>[].concat(...Object.values(e).map((({scope:e})=>e)))))).some((e=>n.has(e)!==a.has(e)))})({dashboardFilters:f,source:(r.parents||[]).concat(d.id),destination:(a.parents||[]).concat(u.id)})&&t((0,o.Zd)((0,n.t)("This chart has been moved to a different filter scope.")))}return null}}const N=()=>a.IE.clearHistory();function q(){return(e,t)=>{e(a.IE.undo());const{dashboardLayout:r,dashboardState:n}=t();0!==r.past.length||n.maxUndoHistoryExceeded||n.updatedColorScheme||e((0,u.MR)(!1))}}const x=p(a.IE.redo),U="UPDATE_COMPONENTS_PARENTS_LIST"},93327:(e,t,r)=>{"use strict";r.d(t,{y:()=>o});var a=r(96453),n=r(17437);const o=a.I4.div`
  ${({theme:e})=>n.AH`
    font-weight: ${e.typography.weights.bold};
    font-size: ${e.typography.sizes.s};
    margin-bottom: ${e.gridUnit}px;
  `}
`},93376:(e,t,r)=>{"use strict";r.d(t,{N:()=>o,m:()=>s});var a=r(27366),n=r(38708);const o=function(){var e,t;if(!document.getElementById("app"))return[];const r=new Set([window.location.hostname]);if("1"===new URLSearchParams(window.location.search).get("disableDomainSharding"))return Array.from(r);const o=(0,n.A)();return(0,a.Aq)(o.common.feature_flags),null!=o&&null!=(e=o.common)&&null!=(t=e.conf)&&t.SUPERSET_WEBSERVER_DOMAINS&&o.common.conf.SUPERSET_WEBSERVER_DOMAINS.forEach((e=>{r.add(e)})),Array.from(r)}(),s=o.length>1},93491:(e,t,r)=>{"use strict";r.d(t,{CM:()=>_,HR:()=>E,LQ:()=>u,PM:()=>y,Zp:()=>f,ef:()=>h,hH:()=>p,i7:()=>g,qJ:()=>d});var a=r(62193),n=r.n(a),o=r(35742),s=r(95579),i=r(58561),l=r.n(i),c=r(95272);const d="SET_REPORT";function u({userId:e,filterField:t,creationMethod:r,resourceId:a}){const n=l().encode({filters:[{col:t,opr:"eq",value:a},{col:"creation_method",opr:"eq",value:r},{col:"created_by",opr:"rel_o_m",value:e}]});return function(e){return o.A.get({endpoint:`/api/v1/report/?q=${n}`}).then((({json:n})=>{e(function(e,t,r,a){return{type:d,report:e,resourceId:t,creationMethod:r,filterField:a}}(n,a,r,t))})).catch((()=>e((0,c.iB)((0,s.t)("There was an issue fetching reports attached to this dashboard.")))))}}const m=(e,t)=>{const r=t(),{user:a,dashboardInfo:o,charts:s,explore:i}=r;if(n()(o)){var l;const[t]=Object.keys(s);e(u({userId:(null==(l=i.user)?void 0:l.userId)||(null==a?void 0:a.userId),filterField:"chart_id",creationMethod:"charts",resourceId:s[t].id}))}else e(u({userId:a.userId,filterField:"dashboard_id",creationMethod:"dashboards",resourceId:o.id}))},p="ADD_REPORT",h=e=>t=>o.A.post({endpoint:"/api/v1/report/",jsonPayload:e}).then((({json:e})=>{t({type:p,json:e}),t((0,c.WR)((0,s.t)("The report has been created")))})),_="EDIT_REPORT",f=(e,t)=>r=>o.A.put({endpoint:`/api/v1/report/${e}`,jsonPayload:t}).then((({json:e})=>{r({type:_,json:e}),r((0,c.WR)((0,s.t)("Report updated")))}));function y(e,t){return function(r){return o.A.put({endpoint:encodeURI(`/api/v1/report/${e.id}`),headers:{"Content-Type":"application/json"},body:JSON.stringify({active:t})}).catch((()=>{r((0,c.iB)((0,s.t)("We were unable to active or deactivate this report.")))})).finally((()=>{r(m)}))}}const E="DELETE_REPORT";function g(e){return function(t){return o.A.delete({endpoint:encodeURI(`/api/v1/report/${e.id}`)}).catch((()=>{t((0,c.iB)((0,s.t)("Your report could not be deleted")))})).finally((()=>{t({type:E,report:e}),t((0,c.WR)((0,s.t)("Deleted: %s",e.name)))}))}}},93641:(e,t,r)=>{"use strict";var a;r.d(t,{Y:()=>a}),function(e){e.Area="echarts_area",e.Bar="echarts_timeseries_bar",e.BigNumber="big_number",e.BigNumberTotal="big_number_total",e.BigNumberPeriodOverPeriod="pop_kpi",e.BoxPlot="box_plot",e.Bubble="bubble_v2",e.Bullet="bullet",e.Calendar="cal_heatmap",e.Cartodiagram="cartodiagram",e.Chord="chord",e.Compare="compare",e.CountryMap="country_map",e.Funnel="funnel",e.Gauge="gauge_chart",e.Graph="graph_chart",e.Handlebars="handlebars",e.Heatmap="heatmap_v2",e.Histogram="histogram_v2",e.Horizon="horizon",e.LegacyBubble="bubble",e.Line="echarts_timeseries_line",e.MapBox="mapbox",e.MixedTimeseries="mixed_timeseries",e.PairedTTest="paired_ttest",e.ParallelCoordinates="para",e.Partition="partition",e.Pie="pie",e.PivotTable="pivot_table_v2",e.Radar="radar",e.Rose="rose",e.Sankey="sankey_v2",e.Scatter="echarts_timeseries_scatter",e.SmoothLine="echarts_timeseries_smooth",e.Step="echarts_timeseries_step",e.Sunburst="sunburst_v2",e.Table="table",e.TimePivot="time_pivot",e.TimeTable="time_table",e.Timeseries="echarts_timeseries",e.Tree="tree_chart",e.Treemap="treemap_v2",e.Waterfall="waterfall",e.WordCloud="word_cloud",e.WorldMap="world_map"}(a||(a={}))},93698:(e,t,r)=>{"use strict";r.d(t,{_:()=>n});var a=r(5795);const n=e=>null!=e&&e.hasOwnProperty("metrics")?(null==e?void 0:e.metrics)||[]:a.Cq},94071:(e,t,r)=>{"use strict";r.d(t,{Bb:()=>u,EN:()=>_,KY:()=>h,Q_:()=>c,YH:()=>i,gb:()=>m,lR:()=>p,s1:()=>l});var a=r(95579),n=r(32142),o=r(53682),s=r(47952);const i=(0,a.t)("D3 format syntax: https://github.com/d3/d3-format"),l=(0,a.t)('Only applies when "Label Type" is set to show values.'),c=(0,a.t)('Only applies when "Label Type" is not set to a percentage.'),d=[",d",".1s",".3s",",.1%",".2%",".3%",".4r",",.1f",",.2f",",.3f","+,","$,.2f"].map((e=>[e,`${e} (${(0,n.gV)(e).preview()})`])),u=[[o.A.SMART_NUMBER,(0,a.t)("Adaptive formatting")],["~g",(0,a.t)("Original value")],...d,["DURATION",(0,a.t)("Duration in ms (66000 => 1m 6s)")],["DURATION_SUB",(0,a.t)("Duration in ms (1.40008 => 1ms 400µs 80ns)")],["DURATION_COL",(0,a.t)("Duration in ms (10500 => 0:10.5)")],["MEMORY_DECIMAL",(0,a.t)("Memory in bytes - decimal (1024B => 1.024kB)")],["MEMORY_BINARY",(0,a.t)("Memory in bytes - binary (1024B => 1KiB)")],["MEMORY_TRANSFER_RATE_DECIMAL",(0,a.t)("Memory transfer rate in bytes - decimal (1024B => 1.024kB/s)")],["MEMORY_TRANSFER_RATE_BINARY",(0,a.t)("Memory transfer rate in bytes - binary (1024B => 1KiB/s)")]],m=(0,a.t)("D3 time format syntax: https://github.com/d3/d3-time-format"),p=[[s.f,(0,a.t)("Adaptive formatting")],["%d/%m/%Y","%d/%m/%Y | 14/01/2019"],["%m/%d/%Y","%m/%d/%Y | 01/14/2019"],["%Y-%m-%d","%Y-%m-%d | 2019-01-14"],["%Y-%m-%d %H:%M:%S","%Y-%m-%d %H:%M:%S | 2019-01-14 01:32:10"],["%d-%m-%Y %H:%M:%S","%d-%m-%Y %H:%M:%S | 14-01-2019 01:32:10"],["%H:%M:%S","%H:%M:%S | 01:32:10"]],h=u[0][0],_=p[0][0]},94500:(e,t,r)=>{"use strict";r.d(t,{Ay:()=>E,qM:()=>y});var a=r(96540),n=r(61225),o=r(5362),s=r(71086),i=r.n(s),l=r(39829);const c=r(43031).F.injectEndpoints({endpoints:e=>({updateSqlEditorTab:e.mutation({query:({queryEditor:{version:e=l.N0,id:t,dbId:r,catalog:a,schema:n,queryLimit:o,sql:s,name:c,latestQueryId:d,hideLeftBar:u,templateParams:m,autorun:p,updatedAt:h},extra:_})=>({method:"PUT",endpoint:encodeURI(`/tabstateview/${t}`),postPayload:i()({database_id:r,catalog:a,schema:n,sql:s,label:c,query_limit:o,latest_query_id:d,template_params:m,hide_left_bar:u,autorun:p,extra_json:JSON.stringify({updatedAt:h,version:e,..._})},(e=>void 0!==e))})}),updateCurrentSqlEditorTab:e.mutation({query:e=>({method:"POST",endpoint:encodeURI(`/tabstateview/${e}/activate`),transformResponse:()=>e})}),deleteSqlEditorTab:e.mutation({query:e=>({method:"DELETE",endpoint:encodeURI(`/tabstateview/${e}`),transformResponse:()=>e})})})}),{useUpdateSqlEditorTabMutation:d,useUpdateCurrentSqlEditorTabMutation:u,useDeleteSqlEditorTabMutation:m}=c;var p=r(84248),h=r(74680),_=r(86963);const f=5e3;function y(e,t,r){return e.map((e=>({...e,...t.id===e.id&&t}))).filter((e=>function(e,t){return e.inLocalStorage||e.updatedAt&&e.updatedAt>t}(e,r)))}const E=()=>{const e=(0,n.d4)((e=>e.sqlLab.queryEditors)),t=(0,n.d4)((e=>e.sqlLab.unsavedQueryEditor)),r=(0,n.d4)((e=>e.sqlLab.editorTabLastUpdatedAt)),s=(0,n.wA)(),i=(0,a.useRef)(r),l=(0,n.d4)((({sqlLab:e})=>e.tabHistory.slice(-1)[0]||"")),c=(0,n.d4)((({sqlLab:e})=>e.lastUpdatedActiveTab)),E=(0,n.d4)((({sqlLab:e})=>e.destroyedQueryEditors)),[g,{error:T}]=d(),[A]=u(),[b]=m(),S=(0,p.Q)(t,f),v=(0,_.A)((t=>y(e,t,i.current))),R=(0,_.A)((()=>y(e,t,i.current).find((({inLocalStorage:e})=>Boolean(e))))),I=(0,_.A)((()=>{var t;!l||l===c||null!=(t=e.find((({id:e})=>e===l)))&&t.inLocalStorage||A(l).then((()=>{s((0,h.setLastUpdatedActiveTab)(l))}))})),O=(0,_.A)((()=>{Object.keys(E).length>0&&Object.keys(E).forEach((e=>{b(e).then((()=>{s((0,h.clearDestoryedQueryEditor)(e))})).catch((({status:t})=>{404===t&&s((0,h.clearDestoryedQueryEditor)(e))}))}))}));return(0,a.useEffect)((()=>{let e;const t=setInterval(I,f);e=setTimeout((function t(){const r=R();r&&s((0,h.syncQueryEditor)(r)),e=setTimeout(t,f)}),f);const r=setInterval(O,f);return()=>{clearTimeout(e),clearInterval(t),clearInterval(r)}}),[R,I,O,s]),(0,a.useEffect)((()=>{const e=v(S);Promise.all(e.filter((({inLocalStorage:e})=>!e)).map((e=>g({queryEditor:e})))).then((e=>{e.some((e=>"error"in e))||(i.current=Date.now(),s((0,h.setEditorTabLastUpdate)(i.current)))}))}),[S,v,s,g]),(0,a.useEffect)((()=>{T&&o.A.warn("An error occurred while saving your editor state.",T)}),[s,T]),null}},94963:(e,t,r)=>{"use strict";r.r(t),r.d(t,{DEFAULT_NAMESPACE:()=>d,default:()=>l,getColor:()=>m,getNamespace:()=>u,getScale:()=>p});var a=r(88055),n=r.n(a),o=r(10526),s=r(76968),i=r(72239);class l{constructor(e){this.name=void 0,this.forcedItems=void 0,this.scales=void 0,this.name=e,this.scales={},this.forcedItems={}}getScale(e){var t,r;const a=null!=(t=null!=e?e:(0,s.A)().getDefaultKey())?t:"",n=(0,s.A)().get(a);return new o.A(null!=(r=null==n?void 0:n.colors)?r:[],this.forcedItems,e)}setColor(e,t){return this.forcedItems[(0,i.A)(e)]=t,this}resetColors(){this.forcedItems={}}resetColorsForLabels(e=[]){const t=n()(this.forcedItems);e.forEach((e=>{t.hasOwnProperty(e)&&delete t[e]})),this.forcedItems={...t}}}const c={},d="GLOBAL";function u(e=d){const t=c[e];if(t)return t;const r=new l(e);return c[e]=r,r}function m(e,t,r){return u(r).getScale(t).getColor(e)}function p(e,t){return u(t).getScale(e)}},95004:(e,t,r)=>{"use strict";r.d(t,{Ak:()=>o,Gb:()=>i,Mv:()=>l,V9:()=>d,aJ:()=>n,ml:()=>c,sB:()=>s});var a=r(56091);const n="CLEAR_DATA_MASK_STATE",o="UPDATE_DATA_MASK",s="SET_DATA_MASK_FOR_FILTER_CHANGES_COMPLETE";function i(e,t){return{type:s,filterChanges:e,filters:t}}function l(e,t){return{type:o,filterId:e,dataMask:t}}function c(e){return l(e,(0,a.Z)(e))}function d(){return{type:n}}},95272:(e,t,r)=>{"use strict";r.d(t,{Q$:()=>o,WR:()=>d,Zd:()=>u,Zt:()=>c,h$:()=>p,iB:()=>m,l4:()=>i,uU:()=>l});var a=r(43561),n=r(60274);const o="ADD_TOAST";function s({toastType:e,text:t,duration:r=8e3,noDuplicate:n=!1}){return{type:o,payload:{id:(s=e,`${s}-${(0,a.Ak)()}`),toastType:e,text:t,duration:r,noDuplicate:n}};var s}const i="REMOVE_TOAST";function l(e){return{type:i,payload:{id:e}}}function c(e,t){return s({text:e,toastType:n.C.Info,duration:4e3,...t})}function d(e,t){return s({text:e,toastType:n.C.Success,duration:4e3,...t})}function u(e,t){return s({text:e,toastType:n.C.Warning,duration:6e3,...t})}function m(e,t){return s({text:e,toastType:n.C.Danger,duration:8e3,...t})}const p={addInfoToast:c,addSuccessToast:d,addWarningToast:u,addDangerToast:m}},95483:(e,t,r)=>{"use strict";r.d(t,{Fp:()=>h,II:()=>_,K8:()=>o,RX:()=>l,Sd:()=>m,Vw:()=>p,Wy:()=>u,Z_:()=>f,_R:()=>y,_T:()=>c,dq:()=>n,nS:()=>i,sJ:()=>d,sO:()=>E,ux:()=>s,y3:()=>g});var a=r(95579);const n={AVG:"AVG",COUNT:"COUNT",COUNT_DISTINCT:"COUNT_DISTINCT",MAX:"MAX",MIN:"MIN",SUM:"SUM"},o=Object.values(n);var s;!function(e){e.Equals="EQUALS",e.NotEquals="NOT_EQUALS",e.LessThan="LESS_THAN",e.LessThanOrEqual="LESS_THAN_OR_EQUAL",e.GreaterThan="GREATER_THAN",e.GreaterThanOrEqual="GREATER_THAN_OR_EQUAL",e.In="IN",e.NotIn="NOT_IN",e.Like="LIKE",e.CaseInsensitiveLike="ILIKE",e.IsNotNull="IS_NOT_NULL",e.IsNull="IS_NULL",e.LatestPartition="LATEST_PARTITION",e.IsTrue="IS_TRUE",e.IsFalse="IS_FALSE",e.TemporalRange="TEMPORAL_RANGE"}(s||(s={}));const i={[s.Equals]:{display:(0,a.t)("Equal to (=)"),operation:"=="},[s.NotEquals]:{display:(0,a.t)("Not equal to (≠)"),operation:"!="},[s.LessThan]:{display:(0,a.t)("Less than (<)"),operation:"<"},[s.LessThanOrEqual]:{display:(0,a.t)("Less or equal (<=)"),operation:"<="},[s.GreaterThan]:{display:(0,a.t)("Greater than (>)"),operation:">"},[s.GreaterThanOrEqual]:{display:(0,a.t)("Greater or equal (>=)"),operation:">="},[s.In]:{display:(0,a.t)("In"),operation:"IN"},[s.NotIn]:{display:(0,a.t)("Not in"),operation:"NOT IN"},[s.Like]:{display:(0,a.t)("Like"),operation:"LIKE"},[s.CaseInsensitiveLike]:{display:(0,a.t)("Like (case insensitive)"),operation:"ILIKE"},[s.IsNotNull]:{display:(0,a.t)("Is not null"),operation:"IS NOT NULL"},[s.IsNull]:{display:(0,a.t)("Is null"),operation:"IS NULL"},[s.LatestPartition]:{display:(0,a.t)("use latest_partition template"),operation:"LATEST PARTITION"},[s.IsTrue]:{display:(0,a.t)("Is true"),operation:"IS TRUE"},[s.IsFalse]:{display:(0,a.t)("Is false"),operation:"IS FALSE"},[s.TemporalRange]:{display:(0,a.t)("TEMPORAL_RANGE"),operation:"TEMPORAL_RANGE"}},l=Object.values(s),c=(s.Like,s.CaseInsensitiveLike,[s.Equals,s.NotEquals,s.LessThan,s.LessThanOrEqual,s.GreaterThan,s.GreaterThanOrEqual]),d=new Set([s.In,s.NotIn]),u=new Set([s.LatestPartition,s.TemporalRange]),m=[s.IsNotNull,s.IsNull,s.LatestPartition,s.IsTrue,s.IsFalse],p=/^(LONG|DOUBLE|FLOAT)?(SUM|AVG|MAX|MIN|COUNT)\([A-Z0-9_."]*\)$/i,h={time_range:(0,a.t)("Time range"),granularity_sqla:(0,a.t)("Time column"),time_grain_sqla:(0,a.t)("Time grain"),granularity:(0,a.t)("Time granularity")},_={time_range:"__time_range",granularity_sqla:"__time_col",time_grain_sqla:"__time_grain",granularity:"__granularity"},f=240,y=320,E=0,g=new Set(["all_columns","groupby","metrics","percent_metrics","order_by_cols"])},96590:(e,t,r)=>{"use strict";r.d(t,{j:()=>i});var a=r(90179),n=r.n(a),o=r(70700),s=r(38677);function i(e,t){if(!(0,s.aj)(e))return t;const{columns:r,extras:a}=t,i=[...r||[]],l=null==r?void 0:r.findIndex((t=>(0,o.eh)(t)&&(0,o.eh)(e.x_axis)&&t===e.x_axis||(0,o.q0)(t)&&(0,o.q0)(e.x_axis)&&t.sqlExpression===e.x_axis.sqlExpression));if(void 0!==l&&l>-1&&e.x_axis&&Array.isArray(r)){(0,o.q0)(r[l])?i[l]={timeGrain:null==a?void 0:a.time_grain_sqla,columnType:"BASE_AXIS",...r[l]}:i[l]={timeGrain:null==a?void 0:a.time_grain_sqla,columnType:"BASE_AXIS",sqlExpression:e.x_axis,label:e.x_axis,expressionType:"SQL"};const s=n()(t,["is_timeseries"]);return s.columns=i,s}return t}},96627:(e,t,r)=>{"use strict";r.d(t,{DV:()=>i,E_:()=>l,KE:()=>o,Tf:()=>a,WC:()=>n,t1:()=>s,zk:()=>c});const a="__timestamp",n="No filter",o=["relative_start","relative_end","time_grain_sqla"],s=["adhoc_filters","filters","interactive_groupby","interactive_highlight","interactive_drilldown","custom_form_data"],i={granularity:"granularity",granularity_sqla:"granularity",time_column:"time_column",time_grain:"time_grain",time_range:"time_range"},l=Object.keys(i),c=[...l,...o]},97689:(e,t,r)=>{"use strict";r.d(t,{A:()=>i,m:()=>s});var a=r(96453),n=r(27583),o=r(2445);const s=({overlayStyle:e={},color:t,...r})=>{const s=(0,a.DP)(),i=`${s.colors.grayscale.dark2}e6`;return(0,o.Y)(n.A,{styles:{root:{fontSize:s.typography.sizes.s,lineHeight:"1.6",maxWidth:62*s.gridUnit,minWidth:30*s.gridUnit,...e}},align:{offset:[0,1]},color:i||t,trigger:"hover",placement:"bottom",mouseLeaveDelay:0,...r})},i=s},98229:(e,t,r)=>{"use strict";r.d(t,{z:()=>n});var a=r(70700);function n({controls:e}){if(null==e||!e.x_axis)return!0;const t=null==e?void 0:e.x_axis,r=null==t?void 0:t.value;return!!(0,a.q0)(r)||!!(0,a.eh)(r)&&!(null==(n=(null!=(o=null==t?void 0:t.options)?o:[]).find((e=>(null==e?void 0:e.column_name)===r)))||!n.is_dttm);var n,o}},99947:(e,t,r)=>{"use strict";r.d(t,{A:()=>n});var a=r(95579);function n(e,t){return Number(e)>+t&&(0,a.t)("Value cannot exceed %s",t)}}}]);